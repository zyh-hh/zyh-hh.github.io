<?xml version="1.0" encoding="utf-8"?>






<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>å°é’è›™deè‰ä¸›</title>
        <link>https://example.com/</link>
        <description>zyhhhçš„ä¸ªäººåšå®¢ã€‚</description>
        <generator>Hugo 0.64.1 https://gohugo.io/</generator>
        
            <language>zh-CN</language>
        
        
            <managingEditor>1612291475@qq.com (å°é’è›™)</managingEditor>
        
        
            <webMaster>1612291475@qq.com (å°é’è›™)</webMaster>
        
        
            <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
        
        <lastBuildDate>Wed, 29 Apr 2020 10:21:53 +0800</lastBuildDate>
        
            <atom:link rel="self" type="application/rss+xml" href="https://example.com/rss.xml" />
        
        
            <item>
                <title>å…³äºå¼‚åº¦ä¾µå…¥</title>
                <link>https://example.com/posts/%E5%85%B3%E4%BA%8E%E5%BC%82%E5%BA%A6%E4%BE%B5%E5%85%A5/</link>
                <guid isPermaLink="true">https://example.com/posts/%E5%85%B3%E4%BA%8E%E5%BC%82%E5%BA%A6%E4%BE%B5%E5%85%A5/</guid>
                <pubDate>Mon, 23 Mar 2020 01:37:56 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200416164748.png" alt=""></p>
<p>å¼‚åº¦ä¾µå…¥æ€»ç®—å®Œç»“äº†ï¼Œå¯¹äºè¿™éƒ¨ç•ªåªèƒ½è¯´é¢‡ä¸ºé—æ†¾å§</p>
<p>è¿™éƒ¨ç•ªä½œä¸ºä¸€éƒ¨åŸåˆ›ç•ªæ¥è®²ï¼Œå‰æœŸåšçš„ç¡®å®å¾ˆä¸é”™ï¼Œå‰§æƒ…å¤Ÿç¡¬ï¼ŒèŠ‚å¥æä½³ï¼Œä¸–ç•Œè§‚å’Œè®¾å®šéƒ½å¾ˆæœ‰æ„æ€ï¼Œä¼ç¬”æå¤šï¼Œå‰§æƒ…åˆ›æ–°ï¼Œå£°ä¼˜çš„è¡¨ç°å’ŒBGMéƒ½æå…¶å‡ºå½©</p>
<p>ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œå°±æ˜¯ä¸–ç•Œè§‚å¸ƒç½®çš„å¤ªå¤§äº†ï¼Œæ²¡åŠæ³•å°†å…¶åœ¨13é›†å†…è®²å®Œï¼Œä¼ç¬”çº¿ç´¢è™½ç„¶å¤šï¼Œä½†æ˜¯å¾ˆå¤šå´æ ¹æœ¬æ²¡ç”¨åˆ°ï¼Œå¯¹æ¨åŠ¨å‰§æƒ…æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚</p>
<p>å¯¹äºåä¸‰é›†æ¥è¯´ï¼Œå¯èƒ½ç¡®å®ä¸ç®—çƒ‚å°¾ï¼Œä½†çœ‹å®Œåè¿˜æ˜¯ååˆ†å¤±æœ›ï¼Œå†³æˆ˜å¾ˆè‰ç‡ï¼Œå…³äºå±€é•¿æ˜¯JWè¿™ä¸ªç»“å±€ï¼Œåªèƒ½è¯´å¾ˆä¸€èˆ¬ï¼Œé¦–å…ˆå¯¹äºå±€é•¿è¿™ä¸ªäººç‰©é“ºå«å¤ªå°‘ï¼Œè€Œä¸”æˆä¸ºJWçš„åŠ¨æœºæ„Ÿè§‰ä¹Ÿå¾ˆéš¾è¯´æœäººï¼Œè¿˜æœ‰é£é¸Ÿäº•è¿™ä¸ªè«åå…¶å¦™çš„å‡ºç°ï¼Œè«åå¥‡å¦™çš„â€œè¶…èƒ½åŠ›â€</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200416171454.png" alt=""></p>
<p>æ•´ä½“æ¥è¯´ï¼Œç®—è¿˜ä¸é”™çš„åŸåˆ›ç•ªï¼Œ10åˆ†çš„è¯æˆ‘è¿˜æ˜¯æ„¿æ„ç»™7åˆ†çš„ã€‚</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/%E9%9A%8F%E7%AC%94/">éšç¬”</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/%E9%9A%8F%E7%AC%94/">éšç¬”</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>2020å¼€å§‹</title>
                <link>https://example.com/posts/2020%E5%BC%80%E5%A7%8B/</link>
                <guid isPermaLink="true">https://example.com/posts/2020%E5%BC%80%E5%A7%8B/</guid>
                <pubDate>Wed, 01 Jan 2020 06:07:00 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200413001816.png" alt=""></p>
<blockquote>
<p>2019å°±è¿™æ ·è¿‡å»äº†ï¼Œ2020å¼€å§‹äº†</p>
</blockquote>
<p>2019å¹´æ˜¯åšå®¢å¼€å§‹çš„ç¬¬ä¸€å¹´ï¼Œæ—¶é—´è¿‡å¾—çœŸçš„æ˜¯å¤ªå¿«äº†ï¼Œåœ¨è¿™ä¸€å¹´é‡Œï¼Œæœ‰äº›ç›®æ ‡å®Œæˆäº†ï¼Œæœ‰äº›å´è¿˜æ²¡å¼€å§‹ï¼Œç”Ÿæ´»æ€»æ˜¯å·®å¼ºäººæ„ï¼Œæ„Ÿè§‰æˆ‘ä¹Ÿåšå¾—ä¸å¤Ÿå¥½ï¼Œä¸æƒ³å¤ªè¿‡æ„Ÿä¼¤ï¼Œå¸Œæœ›æ–°çš„ä¸€å¹´èƒ½ç»™æˆ‘å¸¦æ¥å¥½è¿å§ï¼</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/tokio1.jpg" alt=""></p>
<p>æœ€åï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/%E9%9A%8F%E7%AC%94/">éšç¬”</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/%E9%9A%8F%E7%AC%94/">éšç¬”</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>ç»™åšå®¢æ·»åŠ è¯„è®ºValine</title>
                <link>https://example.com/posts/%E7%BB%99%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9Fvaline/</link>
                <guid isPermaLink="true">https://example.com/posts/%E7%BB%99%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9Fvaline/</guid>
                <pubDate>Mon, 02 Dec 2019 01:37:56 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<blockquote>
<p>Valine - ä¸€æ¬¾å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿã€‚</p>
<p>Valine è¯ç”Ÿäº2017å¹´8æœˆ7æ—¥ï¼Œæ˜¯ä¸€æ¬¾åŸºäºLeancloudçš„å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿã€‚</p>
</blockquote>
<p>ç†è®ºä¸Šæ”¯æŒä½†ä¸é™äºé™æ€åšå®¢ï¼Œç›®å‰å·²æœ‰Hexoã€Hugoã€Typechoç­‰åšå®¢ç¨‹åºåœ¨ä½¿ç”¨Valineã€‚</p>
<p>ç‰¹æ€§ï¼š</p>
<ul>
<li>å¿«é€Ÿ</li>
<li>å®‰å…¨</li>
<li>Emoji ğŸ˜‰</li>
<li>æ— åç«¯å®ç°</li>
<li>MarkDown å…¨è¯­æ³•æ”¯æŒ</li>
<li>è½»é‡æ˜“ç”¨(~15kb gzipped)</li>
</ul>
<p><strong>Tips:</strong></p>
<ul>
<li>æ•´ä¸ªè¿‡ç¨‹ï¼Œæ˜¯ä»¥Memeä¸»é¢˜ä¸ºä¾‹çš„ï¼Œå…¶å®ƒä¸»é¢˜æ“ä½œå¤§åŒå°å¼‚ã€‚</li>
<li>é…ç½®ä¹‹å‰åº”è¯¥å…ˆé˜…è¯»<a href="https://valine.js.org/quickstart.html">Valineå¿«é€Ÿå¼€å§‹</a></li>
</ul>
<h2 id="leancloudç›¸å…³é…ç½®">Leancloudç›¸å…³é…ç½®</h2>
<p>è¯„è®ºç³»ç»Ÿä¾èµ–äºleancloudï¼Œæ‰€ä»¥éœ€è¦å…ˆåœ¨leancloudä¸­è¿›è¡Œç›¸å…³çš„å‡†å¤‡å·¥ä½œã€‚</p>
<ul>
<li>
<p><a href="https://leancloud.cn/dashboard/login.html#/signin">ç™»å½•</a> æˆ– <a href="https://leancloud.cn/dashboard/login.html#/signup">æ³¨å†Œ</a> LeanCloud</p>
</li>
<li>
<p>ç™»å½•æˆåŠŸåï¼Œè¿›å…¥åå°ç‚¹å‡»å·¦ä¸Šè§’çš„åˆ›å»ºåº”ç”¨ï¼š</p>
<p><img src="https://pichome-1254392422.cos.ap-chengdu.myqcloud.com/20180708153104380829479.png" alt="img"></p>
</li>
<li>
<p>åˆ›å»ºå¥½åº”ç”¨ï¼Œè¿›å…¥åº”ç”¨ï¼Œå·¦è¾¹æ æ‰¾åˆ°è®¾ç½®ï¼Œç„¶åç‚¹å‡»åº”ç”¨Keyï¼Œæ­¤æ—¶è®°å½•å‡ºç°çš„App IDå’ŒApp Keyï¼Œåé¢é…ç½®æ–‡ä»¶ä¸­ä¼šç”¨åˆ°ï¼š</p>
<p><img src="https://pichome-1254392422.cos.ap-chengdu.myqcloud.com/20180708153104457148134.png" alt="img"></p>
</li>
<li>
<p>å› ä¸ºè¯„è®ºå’Œæ–‡ç« é˜…è¯»æ•°ç»Ÿè®¡ä¾èµ–äºå­˜å‚¨ï¼Œæ‰€ä»¥è¿˜éœ€è¦å»ºç«‹ä¸¤ä¸ªæ–°çš„å­˜å‚¨</p>
<pre><code>Class
</code></pre><p>å·¦è¾¹æ æ‰¾åˆ°å¹¶ç‚¹å‡»å­˜å‚¨ï¼Œç‚¹å‡»åˆ›å»ºClass:</p>
<p><img src="https://pichome-1254392422.cos.ap-chengdu.myqcloud.com/20180708153104475972323.png" alt="img"></p>
</li>
<li>
<p>åˆ›å»ºä¸¤ä¸ªå­˜å‚¨Classï¼Œåˆ†åˆ«å‘½åä¸º: <code>Counter</code> å’Œ <code>Comment</code>;</p>
</li>
<li>
<p>è¿˜éœ€è¦ä¸ºåº”ç”¨æ·»åŠ å®‰å…¨åŸŸåï¼Œå·¦è¾¹æ ç‚¹å‡»è®¾ç½®ï¼Œæ‰¾åˆ°å®‰å…¨ä¸­å¿ƒï¼Œç‚¹å‡»åä¼šçœ‹åˆ°å®‰å…¨åŸŸåè®¾ç½®æ¡†ï¼Œè¾“å…¥åšå®¢ä½¿ç”¨çš„åŸŸåï¼Œç‚¹å‡»ä¿å­˜å³å¯ï¼š</p>
<p><img src="https://pichome-1254392422.cos.ap-chengdu.myqcloud.com/20180708153104592457270.png" alt="img"></p>
</li>
</ul>
<h2 id="configtomlæ·»åŠ å‚æ•°">config.tomlæ·»åŠ å‚æ•°</h2>
<p>ä¸ºäº†ä½¿é…ç½®æ›´çµæ´»ï¼Œå°† <strong>Valine</strong> ä¸­å¤§éƒ¨åˆ†åˆå§‹åŒ–å‚æ•°é¡¹å‡è®¾ç½®ä¸ºé…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°é¡¹ï¼Œåœ¨ <strong>config.toml</strong> çš„é€‚å½“ä½ç½®ï¼Œæ¯”å¦‚æˆ‘çš„æ–‡ä»¶ä¸­ <strong>[params.gitment]</strong> çš„ä¸‹é¢ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-toml" data-lang="toml">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">gitment</span><span class="p">]</span>          <span class="c"># Gitment is a comment system based on GitHub issues. see https://github.com/imsun/gitment</span>
    <span class="nx">owner</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>              <span class="c"># Your GitHub ID</span>
    <span class="nx">repo</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>               <span class="c"># The repo to store comments</span>
    <span class="nx">clientId</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>           <span class="c"># Your client ID</span>
    <span class="nx">clientSecret</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>       <span class="c"># Your client secret</span>

  <span class="c"># è¿™é‡Œæ·»åŠ Valineçš„ç›¸å…³å‚æ•°</span>
</code></pre></td></tr></table>
</div>
</div><p>æ·»åŠ  <strong>Valine</strong> å‚æ•°é¡¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-toml" data-lang="toml">  <span class="c"># Valine.</span>
  <span class="c"># You can get your appid and appkey from https://leancloud.cn</span>
  <span class="c"># more info please open https://valine.js.org</span>
  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">valine</span><span class="p">]</span>
    <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
    <span class="nx">appId</span> <span class="p">=</span> <span class="s1">&#39;ä½ çš„appId&#39;</span>
    <span class="nx">appKey</span> <span class="p">=</span> <span class="s1">&#39;ä½ çš„appKey&#39;</span>
    <span class="nx">notify</span> <span class="p">=</span> <span class="kc">false</span>  <span class="c"># mail notifier , https://github.com/xCss/Valine/wiki</span>
    <span class="nx">verify</span> <span class="p">=</span> <span class="kc">false</span> <span class="c"># Verification code</span>
    <span class="nx">avatar</span> <span class="p">=</span> <span class="s1">&#39;mm&#39;</span> 
    <span class="nx">placeholder</span> <span class="p">=</span> <span class="s1">&#39;è¯´ç‚¹ä»€ä¹ˆå§...&#39;</span>
    <span class="nx">visitor</span> <span class="p">=</span> <span class="kc">true</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢å‡ é¡¹å†…å®¹çš„å«ä¹‰ï¼Œè¿™é‡Œç®€å•ä¸€è¯´ï¼Œå…·ä½“è¿˜æ˜¯è¦çœ‹ <a href="https://valine.js.org/configuration.html">Valineå®˜ç½‘ä¸­é…ç½®ç›¸å…³çš„å†…å®¹</a>ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>è¿™æ˜¯ç”¨äºä¸»é¢˜ä¸­é…ç½®çš„ï¼Œä¸æ˜¯å®˜æ–¹Valineçš„å‚æ•°ï¼Œ<strong>true</strong>æ—¶æ§åˆ¶å¼€å¯æ­¤è¯„è®ºç³»ç»Ÿ</td>
</tr>
<tr>
<td>appId</td>
<td>è¿™æ˜¯åœ¨ <a href="https://leancloud.cn/">leancloud</a> åå°åº”ç”¨ä¸­è·å–çš„ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æåˆ°çš„ <strong>App ID</strong></td>
</tr>
<tr>
<td>appKey</td>
<td>è¿™æ˜¯åœ¨ <a href="https://leancloud.cn/">leancloud</a> åå°åº”ç”¨ä¸­è·å–çš„ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æåˆ°çš„ <strong>App Key</strong></td>
</tr>
<tr>
<td>notify</td>
<td>ç”¨äºæ§åˆ¶æ˜¯å¦å¼€å¯é‚®ä»¶é€šçŸ¥åŠŸèƒ½ï¼Œå…·ä½“å‚è€ƒ<a href="https://github.com/xCss/Valine/wiki/Valine-%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92%E8%AE%BE%E7%BD%AE">é‚®ä»¶æé†’é…ç½®</a></td>
</tr>
<tr>
<td>verify</td>
<td>ç”¨äºæ§åˆ¶æ˜¯å¦å¼€å¯è¯„è®ºéªŒè¯ç åŠŸèƒ½</td>
</tr>
<tr>
<td>avatar</td>
<td>ç”¨äºé…ç½®è¯„è®ºé¡¹ä¸­ç”¨æˆ·å¤´åƒæ ·å¼ï¼Œæœ‰å¤šç§é€‰æ‹©ï¼šmm, identicon, monsterid, wavatar, retro, hideã€‚è¯¦ç»†å‚è€ƒï¼š<a href="https://valine.js.org/avatar.html">å¤´åƒé…ç½®</a></td>
</tr>
<tr>
<td>placehoder</td>
<td>è¯„è®ºæ¡†çš„æç¤ºç¬¦</td>
</tr>
<tr>
<td>visitor</td>
<td>æ§åˆ¶æ˜¯å¦å¼€å¯æ–‡ç« é˜…è¯»æ•°çš„ç»Ÿè®¡åŠŸèƒ½i, è¯¦æƒ…é˜…è¯»<a href="https://valine.js.org/visitor.html">æ–‡ç« é˜…è¯»æ•°ç»Ÿè®¡</a></td>
</tr>
</tbody>
</table>
<h2 id="ä¿®æ”¹ä¸»é¢˜æ–‡ä»¶">ä¿®æ”¹ä¸»é¢˜æ–‡ä»¶</h2>
<p>ä¸»è¦æ˜¯ä¿®æ”¹ä¸»é¢˜ä¸­è¯„è®ºç›¸å…³çš„å¸ƒå±€æ–‡ä»¶ <code>themes/even/layouts/partials/comments.html</code>ï¼ŒæŒ‰ç…§ <a href="https://valine.js.org/quickstart.html">Valineå¿«é€Ÿå¼€å§‹</a> æ·»åŠ  <strong>Valine</strong> ç›¸å…³ä»£ç ï¼Œæ‰¾åˆ°ä»¥ä¸‹ä½ç½®ï¼Œå¤§æ¦‚55ï½81è¡Œçš„ä½ç½®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">  <span class="c">&lt;!--</span><span class="c"> gitment </span><span class="c">--&gt;</span>
  {{- if .Site.Params.gitment.enable -}}
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;comments-gitment&#34;</span><span class="p"></span><span class="p">&gt;</span><span class="p">&lt;</span><span class="p">/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="c">&lt;!--</span><span class="c">è¿™é‡Œçœç•¥äº†éƒ¨åˆ†ä»£ç </span><span class="c">--&gt;</span>
  <span class="p">&lt;</span><span class="nt">noscript</span><span class="p"></span><span class="p">&gt;</span>Please enable JavaScript to view the <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://github.com/imsun/gitment&#34;</span><span class="p"></span><span class="p">&gt;</span>comments powered by gitment.<span class="p">&lt;</span><span class="p">/</span><span class="nt">a</span><span class="p">&gt;</span><span class="p">&lt;</span><span class="p">/</span><span class="nt">noscript</span><span class="p">&gt;</span>
  {{- end }}

  <span class="c">&lt;!--</span><span class="c">è¿™ä¸ªä½ç½®æ·»åŠ Valineç›¸å…³ä»£ç </span><span class="c">--&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>æ·»åŠ çš„ <strong>Valine</strong> è¯„è®ºçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">  <span class="c">&lt;!--</span><span class="c"> valine </span><span class="c">--&gt;</span>
  {{- if .Site.Params.valine.enable -}}
  <span class="c">&lt;!--</span><span class="c"> id å°†ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ </span><span class="c">--&gt;</span>
  <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;{{ .URL | relURL }}&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;leancloud_visitors&#34;</span> <span class="na">data-flag-title</span><span class="o">=</span><span class="s">&#34;{{ .Title }}&#34;</span><span class="p"></span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;post-meta-item-text&#34;</span><span class="p"></span><span class="p">&gt;</span>æ–‡ç« é˜…è¯»é‡ <span class="p">&lt;</span><span class="p">/</span><span class="nt">span</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;leancloud-visitors-count&#34;</span><span class="p"></span><span class="p">&gt;</span>1000000<span class="p">&lt;</span><span class="p">/</span><span class="nt">span</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p"></span><span class="p">&gt;</span><span class="p">&lt;</span><span class="p">/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="p">/</span><span class="nt">span</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;vcomments&#34;</span><span class="p"></span><span class="p">&gt;</span><span class="p">&lt;</span><span class="p">/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;//cdn1.lncld.net/static/js/3.0.4/av-min.js&#34;</span><span class="p"></span><span class="p">&gt;</span><span class="p">&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;//unpkg.com/valine/dist/Valine.min.js&#39;</span><span class="p"></span><span class="p">&gt;</span><span class="p">&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p"></span><span class="p">&gt;</span>
    <span class="k">new</span> <span class="nx">Valine</span><span class="p">(</span><span class="p">{</span>
        <span class="nx">el</span><span class="o">:</span> <span class="s1">&#39;#vcomments&#39;</span> <span class="p">,</span>
        <span class="nx">appId</span><span class="o">:</span> <span class="s1">&#39;{{ .Site.Params.valine.appId }}&#39;</span><span class="p">,</span>
        <span class="nx">appKey</span><span class="o">:</span> <span class="s1">&#39;{{ .Site.Params.valine.appKey }}&#39;</span><span class="p">,</span>
        <span class="nx">notify</span><span class="o">:</span> <span class="p">{</span><span class="p">{</span> <span class="p">.</span><span class="nx">Site</span><span class="p">.</span><span class="nx">Params</span><span class="p">.</span><span class="nx">valine</span><span class="p">.</span><span class="nx">notify</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span> 
        <span class="nx">verify</span><span class="o">:</span> <span class="p">{</span><span class="p">{</span> <span class="p">.</span><span class="nx">Site</span><span class="p">.</span><span class="nx">Params</span><span class="p">.</span><span class="nx">valine</span><span class="p">.</span><span class="nx">verify</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span> 
        <span class="nx">avatar</span><span class="o">:</span><span class="s1">&#39;{{ .Site.Params.valine.avatar }}&#39;</span><span class="p">,</span> 
        <span class="nx">placeholder</span><span class="o">:</span> <span class="s1">&#39;{{ .Site.Params.valine.placeholder }}&#39;</span><span class="p">,</span>
        <span class="nx">visitor</span><span class="o">:</span> <span class="p">{</span><span class="p">{</span> <span class="p">.</span><span class="nx">Site</span><span class="p">.</span><span class="nx">Params</span><span class="p">.</span><span class="nx">valine</span><span class="p">.</span><span class="nx">visitor</span> <span class="p">}</span><span class="p">}</span>
    <span class="p">}</span><span class="p">)</span><span class="p">;</span>
  <span class="p">&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
  {{- end }}
</code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ä¸Šè¿°ä»£ç ä¸­å¼•ç”¨äº†é…ç½®æ–‡ä»¶ä¸­çš„ç›¸å…³å‚æ•°ï¼Œè¿™æ ·ä»¥åä¿®æ”¹é…ç½®å°±ä¸ç”¨ä¿®æ”¹ä»£ç äº†ï¼Œåªéœ€è¦æ”¹é…ç½®æ–‡ä»¶ <code>config.toml</code>ï¼Œå¦å¤–æ³¨æ„åˆ°çš„æ˜¯ï¼Œæˆ‘ä¹Ÿæ·»åŠ äº†æ–‡ç« é˜…è¯»æ•°ç»Ÿè®¡çš„æ˜¾ç¤ºå†…å®¹ã€‚å°†é…ç½®æ–‡ä»¶ä¸­ <strong>valine</strong> é…ç½®çš„ <code>eanble</code> è®¾ç½®ä¸º <code>true</code> ï¼Œæœ¬åœ°æµ‹è¯•ä¸€ä¸‹ï¼Œæ­£å¸¸çš„è¯ï¼Œæ‰“å¼€ä¸€ç¯‡æ–‡ç« ä¼šçœ‹åˆ°ï¼š</p>
<p><img src="https://pichome-1254392422.cos.ap-chengdu.myqcloud.com/20180708153104555886981.png" alt="img"></p>
<p>æ­¤æ—¶ï¼Œç”Ÿæˆé™æ€åšå®¢æ–‡ä»¶ï¼Œéƒ¨ç½²åˆ°è‡ªå·±çš„æ‰˜ç®¡å¹³å°ï¼Œæ­£å¸¸çš„è¯æ‰“å¼€åšå®¢ä¸­çš„ä¸€ç¯‡æ–‡ç« ï¼Œå°±å¯ä»¥çœ‹åˆ°æ­£å¸¸çš„æ–‡ç« è®¡æ•°å’Œè¯„è®ºæ¡†äº†ï¼Œæ­¤æ—¶éšä¾¿è¯„è®ºä¸€æ¡ï¼ŒéªŒè¯ä¸€ä¸‹ï¼Œè¯„è®ºå¦‚æœæˆåŠŸï¼Œå¯ä»¥å»leancloudåå°çœ‹ä¸€ä¸‹ <code>Comment</code> å’Œ <code>Counter</code>å­˜å‚¨ä¸­æ–°åŠ äº†ç›¸åº”ç½‘å€çš„æ¡ç›®ã€‚</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/%E5%8D%9A%E5%AE%A2/">åšå®¢</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/%E5%8D%9A%E5%AE%A2/">åšå®¢</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>githubåœ¨çº¿é˜…è¯»ç¥å™¨sourcegraphæµ‹è¯„</title>
                <link>https://example.com/posts/sourcegraph%E4%BD%BF%E7%94%A8/</link>
                <guid isPermaLink="true">https://example.com/posts/sourcegraph%E4%BD%BF%E7%94%A8/</guid>
                <pubDate>Sun, 14 Apr 2019 16:01:23 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<p>GitHub åœ¨çš„ä½¿ç”¨ä½“éªŒå¹¶ä¸ç®—å¤ªå¥½ï¼ŒGitHub è®¿é—®èµ·æ¥æ¯”è¾ƒå¡ï¼Œåœ¨ç½‘ç»œæ¯”è¾ƒå¡çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨çº¿æŸ¥çœ‹ GitHub ä¸Šé¡¹ç›®çš„æºç ï¼Œæ˜¯éå¸¸çš„ä¸æ–¹ä¾¿ï¼Œæˆ‘ä»¬éœ€è¦ä¸æ–­çš„è¿›å…¥åˆ°æŸä¸ªç›®å½•ä¸­ï¼Œç„¶åå†é€€å‡ºæ¥ï¼Œå†è¿›å…¥åˆ°å…¶ä»–ç›®å½•ä¸­ï¼Œè¿™æ ·æ¯ä¸€æ¬¡éƒ½è¦åŠ è½½é¡µé¢ï¼ŒæŸ¥çœ‹èµ·æ¥éå¸¸ä¸ä¾¿ã€‚</p>
<p>é€šè¿‡æœ‹å‹äº†è§£äº†sourcegraphè¿™æ¬¾åœ¨çº¿é˜…è¯»githubçš„æ’ä»¶ç¥å™¨</p>
<p><strong>è¿™é‡Œæˆ‘å°±æ¥å’Œå¤§å®¶æ¼”ç¤ºä¸‹æ­£å¸¸å®‰è£…ï¼Œåœ¨ Chrome çš„ Store ä¸­æœç´¢ SourceGraph ï¼Œå¦‚ä¸‹</strong></p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424182718.png" alt=""></p>
<p>æœåˆ°ä¹‹åç‚¹å‡»å³è¾¹çš„ <strong>æ·»åŠ è‡³ Chrome</strong> æŒ‰é’®å³å¯ï¼Œæˆ‘è¿™è¾¹å› ä¸ºå·²ç»è£…è¿‡äº†ï¼Œæ‰€ä»¥æŒ‰é’®æ˜¯è¯„åˆ†ï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œæµè§ˆå™¨ä¸Šä¼šå¤šå‡ºä¸€ä¸ª SourceGraph å›¾æ ‡ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424215135.png" alt=""></p>
<p>è¿™æ · SourceGraph å°±å®‰è£…å¥½äº†ã€‚</p>
<h3 id="ä½¿ç”¨">ä½¿ç”¨</h3>
<p>æ­¤æ—¶æˆ‘ä»¬åœ¨ GitHub ä¸Šæ‰“å¼€ä»»æ„ä¸€ä¸ªé¡¹ç›®ï¼Œä»¥mybatisä¸ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424182650.png" alt=""></p>
<p><strong>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨é¡¹ç›®çš„ Watch æ—è¾¹å¤šäº†ä¸€ä¸ªæŒ‰é’®ï¼Œè¿™ä¸ªæŒ‰é’®å°±æ˜¯ SourceGraph</strong></p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424182743.png" alt=""></p>
<p><strong>æˆ‘ä»¬ç‚¹å‡»ä¸€ä¸‹ï¼Œå°±å¯ä»¥è¿›å…¥åˆ° SourceGraph é¡µé¢ï¼š</strong></p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424213835.png" alt=""></p>
<p>ç›®å½•ç»“æ„æ¸…æ™°</p>
<p><strong>ç‚¹è¿›ä¸€ä¸ªç±»çœ‹çœ‹ï¼Œå¯ä»¥å‘ç°é¡µé¢åšäº†æ ·å¼æ¸²æŸ“ï¼Œç±»ä¼¼idea</strong></p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424213916.png" alt=""></p>
<p><strong>å®ƒä¹Ÿå¯ä»¥é€šè¿‡ç‚¹å‡»æŸ¥çœ‹å˜é‡è¢«å®šä¹‰æˆ–è€…è¢«å¼•ç”¨çš„ä½ç½®(è¿™ä¸ªåŠŸèƒ½è¦ç™»å½• SourceGraph åæ‰å¯ä»¥ä½¿ç”¨)ï¼š</strong></p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424214642.png" alt=""></p>
<p>ä½“éªŒç¡®å®æŒºä¸é”™çš„ï¼Œæœ‰äº†è¿™äº›åŠŸèƒ½ï¼Œæˆ‘ä»¬å†åœ¨ GitHub ä¸Šæµè§ˆé¡¹ç›®å°±æ–¹ä¾¿å¤šäº†ã€‚</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/github/">github</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/github/">github</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>å•ä¾‹æ¨¡å¼</title>
                <link>https://example.com/posts/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</link>
                <guid isPermaLink="true">https://example.com/posts/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</guid>
                <pubDate>Tue, 02 Apr 2019 01:37:56 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<h2 id="ä¸€å•ä¾‹æ¨¡å¼">ä¸€ã€å•ä¾‹æ¨¡å¼</h2>
<p>åœ¨æ ‡å‡†çš„23ç§è®¾è®¡æ¨¡å¼ç§ï¼Œå•ä¾‹è®¾è®¡æ¨¡å¼åœ¨åº”ç”¨ä¸­æ˜¯éå¸¸å¸¸è§çš„ï¼Œè€Œæˆ‘ä»¬åœ¨å­¦ä¹ å•ä¾‹æ¨¡å¼ä¸­ï¼Œä¸€å®šè¦è€ƒè™‘åˆ°å’Œå¤šçº¿ç¨‹ç»“åˆèµ·æ¥æ—¶å¯èƒ½å­˜åœ¨çš„å„ç§é—®é¢˜ä»¥åŠå…¶è§£å†³åŠæ³•ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å†™å‡ºä¸€ä¸ªåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å®‰å…¨ã€æ­£ç¡®çš„å•ä¾‹æ¨¡å¼ã€‚</p>
<p>å•ä¾‹æ¨¡å¼å¸¸è§çš„æœ‰å…«ç§å†™æ³•(æ›´å¤šæ—¶å€™åˆ†ä¸ºå…­ç§ï¼Œæ­¤å¤„æ›´åŠ ç»†åˆ†äº†)ï¼š</p>
<ul>
<li>é¥¿æ±‰å¼ï¼ˆé™æ€å¸¸é‡ï¼‰</li>
<li>é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰</li>
<li>æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</li>
<li>æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•ï¼‰</li>
<li>æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—ï¼‰</li>
<li>åŒé‡æ£€æŸ¥é”</li>
<li>é™æ€å†…éƒ¨ç±»</li>
<li>æšä¸¾</li>
</ul>
<hr>
<h2 id="äºŒå•ä¾‹æ¨¡å¼çš„åŸºæœ¬å®ç°æ€è·¯">äºŒã€å•ä¾‹æ¨¡å¼çš„åŸºæœ¬å®ç°æ€è·¯ï¼š</h2>
<p>å•ä¾‹æ¨¡å¼è¦æ±‚ç±»èƒ½å¤Ÿæœ‰è¿”å›å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨ï¼ˆå¹¶ä¸”æ°¸è¿œæ˜¯åŒä¸€ä¸ªï¼‰å’Œä¸€ä¸ªè·å¾—è¯¥å®ä¾‹çš„æ–¹æ³•ï¼ˆå¿…é¡»æ˜¯é™æ€æ–¹æ³•ï¼Œå¾€å¾€ä½¿ç”¨<code>getInstance()</code>è¿™ä¸ªæ–¹æ³•ï¼‰</p>
<p>å•ä¾‹æ¨¡å¼çš„å®ç°ä¸»è¦é€šè¿‡ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<p>ï¼ˆ1ï¼‰å°†è¯¥ç±»çš„æ„é€ æ–¹æ³•å®šä¹‰ä¸º<strong>ç§æœ‰æ–¹æ³•</strong>ï¼Œè¿™æ ·å…¶å®ƒçš„ä»£ç å°±æ— æ³•é€šè¿‡è°ƒç”¨è¯¥ç±»çš„æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ï¼Œåªæœ‰é€šè¿‡è¯¥ç±»æä¾›çš„é™æ€æ–¹æ³•æ¥å¾—åˆ°è¯¥ç±»çš„å”¯ä¸€å®ä¾‹ï¼›</p>
<p>ï¼ˆ2ï¼‰åœ¨è¯¥ç±»ç§æä¾›ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå½“æˆ‘ä»¬è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå¦‚æœç±»æŒæœ‰çš„å¼•ç”¨ä¸ä¸ºç©ºå°±è¿”å›è¿™ä¸ªå¼•ç”¨ï¼Œå¦‚æœç±»ä¿æŒçš„å¼•ç”¨ä¸ºç©ºå°±åˆ›å»ºè¯¥ç±»çš„å®ä¾‹å¹¶å°†å®ä¾‹çš„å¼•ç”¨èµ‹å€¼ç»™è¯¥ç±»ä¿æŒçš„å¼•ç”¨ã€‚</p>
<p>æ³¨æ„äº‹é¡¹ï¼šå•ä¾‹æ¨¡å¼åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹å¿…é¡»å°å¿ƒä½¿ç”¨ï¼Œå¦‚æœå½“å”¯ä¸€å®ä¾‹å°šæœªåˆ›å»ºæ—¶ï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨åˆ›å»ºæ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä»¬åŒæ—¶æ²¡æœ‰æ£€æµ‹åˆ°å”¯ä¸€å®ä¾‹çš„å­˜åœ¨ï¼Œä»è€ŒåŒæ—¶å„è‡ªåˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹ï¼Œè¿™æ ·å°±æœ‰ä¸¤ä¸ªå®ä¾‹è¢«åˆ›å»ºäº†å‡ºæ¥ï¼Œä»è€Œè¿åäº†å•ä¾‹æ¨¡å¼ç§å®ä¾‹å”¯ä¸€çš„åŸåˆ™ï¼Œè§£å†³çš„åŠæ³•æ˜¾è€Œæ˜“è§æ˜¯åŠ é”ã€‚</p>
<h2 id="ä¸‰å•ä¾‹æ¨¡å¼çš„å…«ç§å†™æ³•">ä¸‰ã€å•ä¾‹æ¨¡å¼çš„å…«ç§å†™æ³•</h2>
<h3 id="1é¥¿æ±‰å¼é™æ€å¸¸é‡">1ã€é¥¿æ±‰å¼ï¼ˆé™æ€å¸¸é‡ï¼‰</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nf">singleton</span><span class="o">(</span><span class="o">)</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="n">INSTANCE</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    
    <span class="c1">//æ³¨æ„æ„é€ æ–¹æ³•å¿…é¡»ç§æœ‰
</span><span class="c1"></span>    <span class="kd">private</span> <span class="nf">Singleton</span><span class="o">(</span><span class="o">)</span><span class="o">{</span><span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="nf">getInstance</span><span class="o">(</span><span class="o">)</span><span class="o">{</span>
        <span class="k">return</span> <span class="n">INSTANCE</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¼˜ç‚¹ï¼šå†™æ³•ç®€å•ï¼Œå°±æ˜¯åœ¨ç±»åŠ è½½çš„æ—¶å€™å®Œæˆå®ä¾‹åŒ–ï¼Œé¿å…äº†çº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚</p>
<p>ç¼ºç‚¹ï¼šæ²¡æœ‰è¾¾åˆ°æ‡’åŠ è½½çš„æ•ˆæœï¼Œå¦‚æœä»å§‹è‡³ç»ˆéƒ½æœªä½¿ç”¨è¿‡è¿™ä¸ªå®ä¾‹ï¼Œä¼šé€ æˆå†…å­˜çš„æµªè´¹ã€‚</p>
<h3 id="2é¥¿æ±‰å¼é™æ€ä»£ç å—">2ã€é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Singleton</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="n">instance</span><span class="o">;</span>
    
    <span class="kd">static</span><span class="o">{</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="nf">Singleton</span><span class="o">(</span><span class="o">)</span><span class="o">{</span><span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="nf">getInstance</span><span class="o">(</span><span class="o">)</span><span class="o">{</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§æ–¹å¼è·Ÿç¬¬ä¸€ç§æ–¹å¼ç±»ä¼¼ï¼Œéƒ½æ˜¯åœ¨ç±»åŠ è½½çš„æ—¶å€™å®Œæˆçš„ï¼Œåªä¸è¿‡å°†å®ä¾‹åŒ–çš„è¿‡ç¨‹æ”¾åœ¨äº†é™æ€ä»£ç å—ç§ï¼Œä¼˜ç¼ºç‚¹è·Ÿä¸Šé¢ä¸€æ ·ã€‚</p>
<h3 id="3æ‡’æ±‰å¼çº¿ç¨‹ä¸å®‰å…¨">3ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Singleton</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="n">instance</span><span class="o">;</span>
    
    <span class="kd">private</span> <span class="nf">Singleton</span><span class="o">(</span><span class="o">)</span><span class="o">{</span><span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="nf">getInstance</span><span class="o">(</span><span class="o">)</span><span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">instance</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span><span class="o">{</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§å†™æ³•åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ˜¾ç„¶ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ã€‚</p>
<h3 id="4æ‡’æ±‰å¼çº¿ç¨‹å®‰å…¨åŒæ­¥æ–¹æ³•">4ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•ï¼‰</h3>
<pre><code>public class Singleton{
    private static Singleton instance;
    
    private Singleton(){}
    
    public static synchronized Singleton getInstance(){
        if(instance == null){
            instance = new Singleton();
        }
        return instance;
    }
}
</code></pre><p>è¿™ç§æ–¹æ³•æ˜¯å¯¹ä¸Šé¢çš„çº¿ç¨‹ä¸å®‰å…¨çš„æ‡’æ±‰å¼çš„æ”¹è¿›ã€‚</p>
<p>ç”±äºæ¯æ¬¡å»è·å–å®ä¾‹çš„æ—¶å€™éƒ½ä¼šè¿›å…¥<code>synchronized</code>ä»£ç å—è€Œä¸ç®¡å®ä¾‹æ˜¯å¦ä¸ºnullï¼Œè€Œå…¶å®è¿™ä¸ªæ–¹æ³•åªéœ€è¦æ‰§è¡Œä¸€æ¬¡å®ä¾‹åŒ–ä»£ç å°±å¯ä»¥ï¼Œå› æ­¤è¿™æ ·çš„å¼€é”€éå¸¸å¤§ï¼Œæ‰€ä»¥ä¸æ¨èä½¿ç”¨ã€‚</p>
<h3 id="5æ‡’æ±‰å¼çº¿ç¨‹å®‰å…¨åŒæ­¥ä»£ç å—">5ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—ï¼‰</h3>
<pre><code>public class Singleton{
    private static Singleton instance;
    
    private Singleton(){}
    
    public static Singleton getInstance(){
        if(instance == null){
            synchronized(Singleton.class){
                instance = new Singleton();
            }
        }
        return instance;
    }
}
</code></pre><p>å¹¶ä¸èƒ½èµ·åˆ°çº¿ç¨‹åŒæ­¥çš„ä½œç”¨ï¼Œè·Ÿç¬¬ä¸‰ç§æ–¹å¼é‡åˆ°çš„æƒ…å½¢ä¸€è‡´ã€‚å‡å¦‚ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥äº†<code>if(instance == null)</code>ä»£ç å—ï¼Œé‚£ä¹ˆè¿˜æ˜¯ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ï¼Œå› æ­¤åŒæ ·ä¸æ¨èä½¿ç”¨ã€‚</p>
<h3 id="6åŒé‡æ£€æŸ¥é”">6ã€åŒé‡æ£€æŸ¥é”</h3>
<pre><code>public class Singleton{
    private static volatile Singleton singleton;
    
    private Singleton(){}
    
    public static Singleton getInstance(){
        if(singleton == null){
            synchronized(Singleton.class){
                if(singleton == null){
                    singleton = new Singleton():
                }
            }
        }
        return singleton;
    }
}
</code></pre><p>åŒé‡æ£€æŸ¥é”å¯¹äºå¤šçº¿ç¨‹å¼€å‘è€…æ¥è¯´å¹¶ä¸é™Œç”Ÿï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸¤æ¬¡<code>if(singleton == null)</code>åˆ¤æ–­ï¼Œå¹¶é€šè¿‡å°†å®ä¾‹singletonè®¾ç½®ä¸º<code>volatile</code>å˜é‡ï¼Œè¿™æ ·å¯ä»¥å®ç°å˜é‡çš„å¯è§æ€§å¹¶ä¸”ç¦æ­¢ç¼–è¯‘å™¨æŒ‡ä»¤é‡æ’åºé€ æˆçš„å…¶å®ƒé—®é¢˜ã€‚</p>
<p>ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œå»¶è¿ŸåŠ è½½ï¼Œæ•ˆç‡è¾ƒé«˜ã€‚</p>
<h3 id="7é™æ€å†…éƒ¨ç±»">7ã€é™æ€å†…éƒ¨ç±»</h3>
<pre><code>public class Singleton{
    private Singleton(){}
    
    private static class SingletonInstance{
        private static final Singleton INSTANCE = new Singleton();
    }
    
    public static Singleton getInstance(){
        return SingletonInstance.INSTANCE;
    }
}
</code></pre><p>è¿™ç§æ–¹å¼è·Ÿé¥¿æ±‰å¼æ–¹å¼é‡‡ç”¨çš„æœºåˆ¶ç±»ä¼¼ï¼Œä½†åˆæœ‰ä¸åŒã€‚ä¸¤è€…éƒ½æ˜¯é‡‡ç”¨äº†ç±»è£…è½½çš„æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ–å®ä¾‹æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚ä¸åŒçš„åœ°æ–¹åœ¨é¥¿æ±‰å¼æ–¹å¼æ˜¯åªè¦Singletonç±»è¢«è£…è½½å°±ä¼šå®ä¾‹åŒ–ï¼Œæ²¡æœ‰Lazy-Loadingï¼ˆæ‡’åŠ è½½ï¼‰çš„ä½œç”¨ï¼Œè€Œé™æ€å†…éƒ¨ç±»æ–¹å¼åœ¨Singletonç±»è¢«è£…è½½æ—¶å¹¶ä¸ä¼šç«‹å³å®ä¾‹åŒ–ï¼Œè€Œæ˜¯åœ¨éœ€è¦å®ä¾‹åŒ–æ—¶ï¼Œè°ƒç”¨getInstanceæ–¹æ³•ï¼Œæ‰ä¼šè£…è½½SingletonInstanceç±»ï¼Œä»è€Œå®ŒæˆSingletonçš„å®ä¾‹åŒ–ã€‚</p>
<p>ç±»çš„é™æ€å±æ€§åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½ç±»çš„æ—¶å€™åˆå§‹åŒ–ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼Œ<strong>JVMå¸®åŠ©æˆ‘ä»¬ä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨æ€§ï¼Œåœ¨ç±»è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œåˆ«çš„çº¿ç¨‹æ˜¯æ— æ³•è¿›å…¥çš„ã€‚</strong></p>
<p>ä¼˜ç‚¹ï¼šé¿å…äº†çº¿ç¨‹ä¸å®‰å…¨ï¼Œå»¶è¿ŸåŠ è½½ï¼Œæ•ˆç‡é«˜ã€‚</p>
<h3 id="8æšä¸¾">8ã€æšä¸¾</h3>
<pre><code>public enum Singleton{
    INSTANCE;
    public void whateverMethod(){
        
    }
}
</code></pre><p>å€ŸåŠ©JDK1.5ä¸­æ·»åŠ çš„æšä¸¾æ¥å®ç°å•ä¾‹æ¨¡å¼ã€‚ä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œä¸”è¿˜èƒ½é˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚å¯èƒ½æ˜¯å› ä¸ºæšä¸¾åœ¨JDK1.5ä¸­æ‰æ·»åŠ ï¼Œæ‰€ä»¥åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œä½¿ç”¨æšä¸¾å®ç°å•ä¾‹æ¨¡å¼å¾ˆå°‘å‡ºç°ã€‚</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</category>
                                
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java/">java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>ConcurrentHashMapæºç åˆ†æ</title>
                <link>https://example.com/posts/concurrenthashmap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</link>
                <guid isPermaLink="true">https://example.com/posts/concurrenthashmap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</guid>
                <pubDate>Wed, 20 Mar 2019 16:01:23 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯concurrenthashmap">ä»€ä¹ˆæ˜¯ConcurrentHashMap</h3>
<blockquote>
<p>ConcurrentHashMap æ˜¯çº¿ç¨‹å®‰å…¨ä¸”é«˜æ•ˆçš„ HashMapã€‚ä½¿ç”¨ ConcurrentHashMap çš„ä¸»è¦åŸå› æ˜¯ HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ˆHashMap çº¿ç¨‹ä¸å®‰å…¨çš„åŸå› å¯ä»¥å‚è€ƒ<a href="https://zyhhh.top/posts/ConcurrentHashMap.html">è¿™é‡Œ</a>ï¼‰ï¼Œå¦‚æœè¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ Map ç»“æ„ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹æ–¹å¼ï¼š</p>
<ol>
<li>ä½¿ç”¨ Collections.synchronizedMap(HashMap&lt;K,V&gt; ()) æ–¹æ³•æŠŠ HashMap å˜æˆä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ Map</li>
<li>ä½¿ç”¨ HashTable</li>
<li>ä½¿ç”¨ ConcurrentHashMap</li>
</ol>
</blockquote>
<p>ä¸ºä»€ä¹ˆä¸ç”¨ HashTable å‘¢ï¼Œè¿™æ˜¯å› ä¸º HashTable çš„æ•ˆç‡éå¸¸ä½ï¼Œå…¶å†…éƒ¨æ–¹æ³•éƒ½æ˜¯ä½¿ç”¨ Synchronized æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸”è‹¥çº¿ç¨‹ç«äº‰æ¿€çƒˆæ—¶ï¼ŒHashTable çš„æ•ˆç‡ä¼šå˜å¾—æ›´åŠ ä½ï¼Œå› ä¸ºå½“ä¸€ä¸ªçº¿ç¨‹è®¿é—® HashTable çš„åŒæ­¥æ–¹æ³•ï¼Œå…¶å®ƒçº¿ç¨‹ä¹Ÿè®¿é—® HashTable çš„åŒæ­¥æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šè¿›å…¥é˜»å¡æˆ–è€…è½®è¯¢çŠ¶æ€ã€‚æ¯”å¦‚çº¿ç¨‹ 1 ä½¿ç”¨ put æ–¹æ³•è¿›è¡Œå…ƒç´ æ·»åŠ ï¼Œçº¿ç¨‹ 2 ä¸ä½†ä¸èƒ½ä½¿ç”¨ put æ–¹æ³•æ·»åŠ å…ƒç´ ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨ get æ–¹æ³•æŸ¥è¯¢å…ƒç´ ã€‚æ‰€ä»¥å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¾€å¾€ä¸ä¼šä½¿ç”¨ HashTableã€‚</p>
<p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒJava å®˜æ–¹æä¾›äº† ConcurrentHashMap ç±»æ¥å®ç°å¹¶å‘è®¿é—®æ€§èƒ½è¾ƒé«˜çš„ HashMapã€‚å…¶ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>çº¿ç¨‹å®‰å…¨</li>
<li>ç›¸æ¯”äº HashTable å’Œ Collections.synchronizedMap() æ•ˆç‡é«˜</li>
</ul>
<h3 id="concurrenthashmapçš„ç»“æ„">ConcurrentHashMapçš„ç»“æ„</h3>
<p>ConcurrentHashMap åœ¨ JDK 1.7 å’Œ JDK 1.8 çš„ç»“æ„æ˜¯ä¸ç›¸åŒçš„ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆè§£æ JDK 1.7 ä¸‹çš„ ConcurrentHashMapï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šå†åˆ†æ JDK 1.8 ä¸‹ ConcurrentHashMap çš„å®ç°å¹¶æ¯”è¾ƒä¸ 1.7 åšå‡ºäº†ä»€ä¹ˆä¼˜åŒ–ã€‚</p>
<h4 id="jdk17ä¸‹çš„concurrenthashmap">JDK1.7ä¸‹çš„ConcurrentHashMap</h4>
<p>åœ¨ JDK 1.7 ä¸­ï¼ŒConcurrentHashMap çš„ç»“æ„æ˜¯åˆ†æ®µé”ï¼ˆsegmentï¼‰ + HashEntry æ•°ç»„ã€‚ConcurrentHashMap å’Œ HashMap å®ç°ä¸Šç±»ä¼¼ï¼Œæœ€ä¸»è¦çš„å·®åˆ«æ˜¯ ConcurrentHashMap é‡‡ç”¨äº†åˆ†æ®µé”ï¼ˆSegmentï¼‰ï¼Œæ¯ä¸ªåˆ†æ®µé”ç»´æŠ¤ç€å‡ ä¸ªæ¡¶ï¼ˆHashEntryï¼‰ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®ä¸åŒåˆ†æ®µé”ä¸Šçš„æ¡¶ï¼Œä»è€Œä½¿å…¶å¹¶å‘åº¦æ›´é«˜ï¼ˆå¹¶å‘åº¦å°±æ˜¯ Segment çš„ä¸ªæ•°ï¼‰ã€‚</p>
<p><a href="https://blogimage-1258928558.cos.ap-guangzhou.myqcloud.com/ConcurrentHashMap/jdk1.7-concurrenthashmap.png"><img src="https://blogimage-1258928558.cos.ap-guangzhou.myqcloud.com/ConcurrentHashMap/jdk1.7-concurrenthashmap.png" alt="img"></a></p>
<p>å…¶ä¸­ segment æ˜¯ä¸€ç§å¯é‡å…¥é”ï¼ˆReentrantLockï¼‰ï¼Œåœ¨ ConcurrentHashMap ä¸­æ‰®æ¼”é”çš„è§’ï¼ŒHashEntry åˆ™ç”¨äºå¯¸å‚¨é”®å€¼å¯¹æ•°æ®ã€‚ä¸€ä¸ª ConcurrentHashMap ä¸­åŒ…å«ä¸€ä¸ª Segment æ•°ç»„ï¼ŒSegment çš„ç»“æ„å’Œ HashMap ç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨çš„ç»“æ„ï¼Œä¸€ä¸ª Segment ä¸­åŒ…å«ä¸€ä¸ª HashEntry æ•°ç»„ï¼Œæ¯ä¸ª HashEntry æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ã€‚æ¯ä¸ª Segment å®ˆæŠ¤ç€ä¸€ä¸ª HashEntry æ•°ç»„é‡Œé¢çš„å…ƒç´ ï¼Œå¯¹ HashEntry æ•°ç»„ä¸­å…ƒç´ è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»å…ˆè·å–å¯¹åº”çš„ Segment é”ã€‚</p>
<h4 id="jdk18ä¸‹çš„concurrenthashmap">JDK1.8ä¸‹çš„ConcurrentHashMap</h4>
<p>JDK 1.8 ä¸­ ï¼ŒConcurrentHashMap çš„ç»“æ„æ˜¯æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘ï¼Œä¸å†æ˜¯åˆ†æ®µé”ï¼ˆsegmentï¼‰æœºåˆ¶ï¼Œè€Œæ˜¯é‡‡ç”¨äº† CAS + Synchronized ç»†åŒ–äº†é”ç²’åº¦ï¼Œä»è€Œæå‡äº†å¹¶å‘æ€§èƒ½ï¼Œå¹¶ä¸”åœ¨æ•°ç»„é“¾è¡¨é•¿åº¦è¶…è¿‡ 8 æ—¶ï¼Œä¼šè‡ªåŠ¨å°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œè¿™æ ·è§£å†³äº†æ•£åˆ—ä¸å‡åŒ€äº§ç”Ÿé“¾è¡¨è¿‡é•¿ä»è€Œä½¿å¾—æœç´¢æ—¶é—´å¤æ‚åº¦è¿‡å¤§çš„é—®é¢˜ã€‚</p>
<p><a href="https://blogimage-1258928558.cos.ap-guangzhou.myqcloud.com/ConcurrentHashMap/jdk1.8-concurrenthashmap.png"><img src="https://blogimage-1258928558.cos.ap-guangzhou.myqcloud.com/ConcurrentHashMap/jdk1.8-concurrenthashmap.png" alt="img"></a></p>
<p>Synchronized åªé”å®šå½“å‰é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘çš„é¦–èŠ‚ç‚¹ï¼Œè¿™æ ·åªè¦ hash ä¸å†²çªï¼Œå°±ä¸ä¼šäº§ç”Ÿå¹¶å‘ï¼Œä»è€Œæå‡äº†ä¸€å®šçš„å¹¶å‘æ€§èƒ½ã€‚</p>
<h3 id="concurrenthashmapçš„æºç åˆ†æ">ConcurrentHashMapçš„æºç åˆ†æ</h3>
<p>ä¸ºäº†æ›´å…¨é¢çš„ç†è§£ ConcurrentHashMap çš„æºç å’Œå‘å±•å†å²ï¼Œè¿™é‡Œä¹Ÿåˆ†ä¸º JDK 1.7 å’Œ JDK 1.8 ä¸­çš„ ConcurrentHashMap æºç åˆ†æã€‚</p>
<h4 id="jdk-17-æºç ">JDK 1.7 æºç </h4>
<p>ç”±ä¸Šé¢å°èŠ‚æˆ‘ä»¬åˆæ­¥äº†è§£äº† ConcurrentHashMap åœ¨ 1.7 ä¸­çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­æˆ‘ä»¬éœ€è¦å…³æ³¨çš„ç‚¹ï¼š</p>
<ul>
<li>ConcurrentHashMap å¦‚ä½•å®šä½ Segment, å¦‚ä½•å®šä½ HashEntry</li>
<li>ä¿®æ”¹çš„åŠ é”é€»è¾‘ï¼Œå¦‚ä½•è¿›è¡Œæ‰©å®¹</li>
<li>è¯»æ•°æ®æ—¶ï¼Œå¦‚ä½•åšåˆ°ä¸åŠ é”ä½†ä¿è¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</li>
</ul>
<p>ConcurrentHashMap çš„é»˜è®¤å¸¸é‡å­—æ®µæœ‰ï¼š</p>
<table>
<thead>
<tr>
<th align="center">å¸¸é‡</th>
<th align="center">å«ä¹‰</th>
<th align="center">åˆå§‹å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">DEFAULT_INITIAL_CAPACITY</td>
<td align="center">åˆå§‹å®¹é‡</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">DEFAULT_LOAD_FACTOR</td>
<td align="center">åˆå§‹è´Ÿè½½å› å­</td>
<td align="center">0.75</td>
</tr>
<tr>
<td align="center">DEFAULT_CONCURRENCY_LEVEL</td>
<td align="center">å¹¶å‘åº¦</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">MAX_SEGMENTS</td>
<td align="center">segmentæœ€å¤§å®¹é‡</td>
<td align="center">2^16</td>
</tr>
<tr>
<td align="center">RETRIES_BEFORE_LOCK</td>
<td align="center">é‡è¯•æ¬¡æ•°</td>
<td align="center">2</td>
</tr>
</tbody>
</table>
<p>ConcurrentHashMap çš„åˆå§‹åŒ–æ–¹æ³•ä¹Ÿæ˜¯é€šè¿‡ initialCapacityã€loadFactor å’Œ ConcurrencyLevel ç­‰å‡ ä¸ªå‚æ•°åˆå§‹åŒ– segement æ•°ç»„ã€æ®µåç§»é‡ segmentShiftã€æ®µæ©ç  segmentMask å’Œæ¯ä¸ª segment ä¸­çš„ HashEntry æ•°ç»„æ¥å®ç°çš„ã€‚</p>
<p>å¤åˆ¶</p>
<pre><code>public ConcurrentHashMap(int initialCapacity,
                         float loadFactor, int concurrencyLevel) {
    if (!(loadFactor &gt; 0) || initialCapacity &lt; 0 || concurrencyLevel &lt;= 0)
        throw new IllegalArgumentException();
	
    if (concurrencyLevel &gt; MAX_SEGMENTS)
        concurrencyLevel = MAX_SEGMENTS;

    // Find power-of-two sizes best matching arguments
    int sshift = 0;  
    int ssize = 1;
    while (ssize &lt; concurrencyLevel) {
        ++sshift;
        ssize &lt;&lt;= 1;
    }
    segmentShift = 32 - sshift;
    segmentMask = ssize - 1;
    this.segments = Segment.newArray(ssize);

    if (initialCapacity &gt; MAXIMUM_CAPACITY)
        initialCapacity = MAXIMUM_CAPACITY;
    int c = initialCapacity / ssize;
    if (c * ssize &lt; initialCapacity)
        ++c;
    int cap = 1;
    while (cap &lt; c)
        cap &lt;&lt;= 1;

    for (int i = 0; i &lt; this.segments.length; ++i)
        this.segments[i] = new Segment&lt;K,V&gt;(cap, loadFactor);
}
</code></pre><h5 id="åˆå§‹åŒ–segmentæ•°ç»„">åˆå§‹åŒ–segmentæ•°ç»„</h5>
<p>åˆå§‹åŒ– segment æ•°ç»„æºç å¦‚ä¸‹ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>//å¹¶å‘åº¦æœ€å¤§åªæœ‰segmengsæ•°ç»„å¤§å°
if (concurrencyLevel &gt; MAX_SEGMENTS)
    concurrencyLevel = MAX_SEGMENTS;

// Find power-of-two sizes best matching arguments
// ä¸ºäº†ä¿è¯segemntsæ•°ç»„é•¿åº¦ä¸º2çš„Næ¬¡æ–¹
int sshift = 0;  
int ssize = 1;  //segmentæ•°ç»„çš„é•¿åº¦
while (ssize &lt; concurrencyLevel) {
    ++sshift;
    ssize &lt;&lt;= 1;
}
segmentShift = 32 - sshift;
segmentMask = ssize - 1;
this.segments = Segment.newArray(ssize);
</code></pre><p>ç”±ä¸Šå¯çŸ¥ï¼Œsegments æ•°ç»„çš„é•¿åº¦ ssize æ˜¯é€šè¿‡ concurrencyLevel è®¡ç®—å¾—å‡ºçš„ã€‚ä¸ºäº†èƒ½é€šè¿‡æŒ‰ä¸ºä¸çš„æ•£åˆ—ç®—æ³•æ¥å®šä½ segments æ•°ç»„çš„ç´¢å¼•ï¼Œå¿…é¡»ä¿è¯ segments æ•°ç»„çš„é•¿åº¦ä¸º 2 çš„ N æ¬¡æ–¹ï¼ˆpower-of-two sizeï¼‰ï¼Œæ‰€ä»¥å¿…é¡»è®¡ç®—å‡ºä¸€ä¸ªå¤§äºæˆ–ç­‰äº concurrencyLevel çš„æœ€å°çš„ 2 çš„ N æ¬¡æ–¹æ¥ä½œä¸º segments æ•°ç»„çš„é•¿åº¦ã€‚</p>
<p>æ¯”å¦‚å‡å¦‚concurrencyLevel ç­‰äº 14 ã€15 æˆ–è€… 16ï¼Œssize éƒ½ä¼šç­‰äº 16ï¼Œå³å®¹å™¨é‡Œé¢é”çš„ä¸ªæ•°ä¹Ÿæ˜¯ 16ã€‚</p>
<h5 id="åˆå§‹åŒ–segmentshiftå’Œsegmentmask">åˆå§‹åŒ–segmentShiftå’ŒsegmentMask</h5>
<p>è¿™ä¸¤ä¸ªå…¨å±€å˜é‡éœ€è¦åœ¨å®šä½ segment æ—¶çš„æ•£åˆ—ç®—æ³•ä¸­ä½¿ç”¨ï¼Œsshift ç­‰äº ssize ä» 1 å‘å·¦ç§»ä½çš„æ¬¡æ•°ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ concurrencyLevel ç­‰äº 16ï¼Œ1 éœ€è¦å¾€å·¦ç§»ä½ç§»åŠ¨ 4 æ¬¡ï¼Œæ‰€ä»¥ sshift ç­‰äº 4ã€‚segmentShift ç”¨äºå®šä½å‚ä¸æ•£åˆ—å‡½æ•°è¿ç®—çš„ä½æ•°ï¼Œ <code>segmentShift = 32 - sshift</code>ï¼Œæ‰€ä»¥ç­‰äº 28ï¼Œè¿™é‡Œä¹‹æ‰€ä»¥ç”¨ 32 æ˜¯å› ä¸º ConcurrentHashMap é‡Œçš„ hash() æ–¹æ³•è¾“å‡ºçš„æœ€å¤§æ•°æ˜¯ 32 ä½çš„ï¼Œåé¢çš„æµ‹è¯•ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ç‚¹ã€‚ segmentMask æ˜¯æ•£åˆ—è¿ç®—çš„æ©ç ï¼Œç­‰äº ssize - 1ï¼Œå³æœ€å¤§å€¼æ˜¯ 16ï¼Œ segmentMask çš„æœ€å¤§å€¼ä¸º 65535ã€‚</p>
<h5 id="åˆå§‹åŒ–æ¯ä¸ªsegment">åˆå§‹åŒ–æ¯ä¸ªsegment</h5>
<p>æºç å¦‚ä¸‹ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>if (initialCapacity &gt; MAXIMUM_CAPACITY)
    initialCapacity = MAXIMUM_CAPACITY;
int c = initialCapacity / ssize;
if (c * ssize &lt; initialCapacity)
    ++c;
int cap = 1;  // cå°±æ˜¯segmentä¸­HashEntryæ•°ç»„çš„é•¿åº¦
while (cap &lt; c)
    cap &lt;&lt;= 1;

for (int i = 0; i &lt; this.segments.length; ++i)
    this.segments[i] = new Segment&lt;K,V&gt;(cap, loadFactor);
}
</code></pre><p>ä¸Šé¢ä»£ç ä¸­çš„ cap å°±æ˜¯æ¯ä¸ª segment ä¸­ HashEntry æ•°ç»„çš„é•¿åº¦ï¼Œå®ƒç­‰äº initialCapacity é™¤ä»¥ ssize çš„å€æ•° cï¼Œå¦‚æœ c å¤§äº 1ï¼Œå°±ä¼šå–å¤§äºç­‰äº c çš„ 2 çš„ N æ¬¡æ–¹å€¼ï¼Œæ‰€ä»¥ cap ä¸æ˜¯ 1ï¼Œå°±æ˜¯ 2 çš„ N æ¬¡æ–¹ã€‚ segment çš„å®¹é‡ <code>threshold = (int) cap * loadFactor</code>ï¼Œé»˜è®¤æƒ…å†µä¸‹ initialCapacity ç­‰äº 16ï¼ŒloadFactor ç­‰äº 0.75ï¼Œé€šè¿‡è¿ç®— cap ç­‰äº 1ï¼Œthreshold ç­‰äºé›¶ã€‚</p>
<h5 id="å®šä½segment">å®šä½Segment</h5>
<p>åœ¨æ’å…¥å’Œè·å–å…ƒç´ çš„æ—¶å€™ï¼Œå¿…é¡»å…ˆé€šè¿‡æ•£åˆ—ï¼ˆhashï¼‰ç®—æ³•å®šä½åˆ°å¯¹åº”çš„ Segmentã€‚ç¿»æºç å¯ä»¥çœ‹åˆ°ï¼ŒConcurrentHashMap ä¸­çš„ hash ç®—æ³•æ˜¯å•ç‹¬å†™çš„æ–¹æ³•ï¼Œä½¿ç”¨çš„æ˜¯ Wang/Jenkins hash çš„å˜ç§ç®—æ³•å¯¹å…ƒç´ çš„ hashCode è¿›è¡Œä¸€æ¬¡å†æ•£åˆ—ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>private static int hash(int h) {
    // Spread bits to regularize both segment and index locations,
    // using variant of single-word Wang/Jenkins hash.
    h += (h &lt;&lt;  15) ^ 0xffffcd7d;
    h ^= (h &gt;&gt;&gt; 10);
    h += (h &lt;&lt;   3);
    h ^= (h &gt;&gt;&gt;  6);
    h += (h &lt;&lt;   2) + (h &lt;&lt; 14);
    return h ^ (h &gt;&gt;&gt; 16);
}
</code></pre><p>ä¹‹æ‰€ä»¥è¿›è¡Œå†æ•£åˆ—ï¼Œç›®çš„æ˜¯å‡å°‘æ•£åˆ—å†²çªï¼Œä½¿å…ƒç´ èƒ½å‡åŒ€çš„åˆ†å¸ƒåœ¨ä¸åŒçš„ Segment ä¸Šï¼Œä»è€Œæé«˜å®¹å™¨çš„å­˜å‚¨æ•ˆç‡ã€‚å‡å¦‚æ•£åˆ—çš„è´¨é‡å·®åˆ°æç‚¹ï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½åœ¨ä¸€ä¸ª Segment ä¸­ï¼Œä¸ä»…å­˜å–å…ƒç´ ç¼“æ…¢ï¼Œåˆ†æ®µé”ä¹Ÿä¼šå¤±å»æ„ä¹‰ã€‚</p>
<p>ConcurrentHashMap é€šè¿‡ä»¥ä¸‹æ•£åˆ—ç®—æ³•å®šä½ segmentï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>final Segment&lt;K,V&gt; segmentFor(int hash) {
    return segments[(hash &gt;&gt;&gt; segmentShift) &amp; segmentMask];
}
</code></pre><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒsegmentShift çš„å€¼ä¸º 28ï¼ŒsegmentMask çš„å€¼ä¸º15ï¼Œå†æ•£åˆ—åçš„æ•°çš„æœ€å¤§æ˜¯ 32 ä½äºŒè¿›åˆ¶æ•°æ®ï¼Œå‘å³æ— ç¬¦å·ç§»åŠ¨ 28 ä½ï¼Œæ„æ€æ˜¯è®©é«˜ 4 ä½å‚ä¸åˆ°æ•£åˆ—è¿ç®—ä¸­ã€‚</p>
<h5 id="get-æ“ä½œ">get æ“ä½œ</h5>
<p>å…ˆçœ‹æºç ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>public V get(Object key) {
    int hash = hash(key.hashCode());
    return segmentFor(hash).get(key, hash); //æºç å¦‚ä¸‹
}
</code></pre><p>å¤åˆ¶</p>
<pre><code>//Segmentç±»ä¸­çš„getæ–¹æ³•
V get(Object key, int hash) {
    if (count != 0) { // read-volatile
        HashEntry&lt;K,V&gt; e = getFirst(hash); //æºç å¦‚ä¸‹
        while (e != null) {
            if (e.hash == hash &amp;&amp; key.equals(e.key)) {
                V v = e.value;
                if (v != null)
                    return v;
                return readValueUnderLock(e); // recheck
            }
            e = e.next;
        }
    }
    return null;
}
</code></pre><p>å¯ä»¥çœ‹åˆ° get æ“ä½œæ¯”è¾ƒç®€å•å’Œé«˜æ•ˆï¼Œå…ˆç»è¿‡ä¸€æ¬¡å† hashï¼Œç„¶åä½¿ç”¨è¿™ä¸ªæ•£åˆ—å€¼é€šè¿‡æ•£åˆ—è¿ç®—å®šä½åˆ° Segmentï¼Œå†é€šè¿‡æ•£åˆ—ç®—æ³•å®šä½åˆ°å…ƒç´ ã€‚</p>
<p>å¤åˆ¶</p>
<pre><code>//å®šä½åˆ°å…·ä½“çš„HashEntry
HashEntry&lt;K,V&gt; getFirst(int hash) {
    HashEntry&lt;K,V&gt;[] tab = table;
    return tab[hash &amp; (tab.length - 1)];
}
</code></pre><p>è¿™ä¸ªæ“ä½œé«˜æ•ˆçš„åŸå› æ˜¯æ•´ä¸ª get æ“ä½œæ²¡æœ‰åŠ é”ï¼Œé™¤éè¯»åˆ°çš„å€¼ä¸ºç©ºæ—¶æ‰ä¼šåŠ é”é‡è¯»ã€‚è€ŒåŸç†å°±æ˜¯ä½¿ç”¨ volatile ä¿®é¥° get æ–¹æ³•ä¸­éœ€è¦ç”¨åˆ°çš„å…±äº«å˜é‡ï¼Œæ¯”å¦‚ count å­—æ®µå’Œ å­˜å‚¨å€¼çš„ HashEntry çš„ valueã€‚volatileä¿®é¥°çš„å˜é‡å¯ä»¥ä¿è¯å¯è§æ€§ï¼Œèƒ½è¢«å¤šçº¿ç¨‹åŒæ—¶è¯»å¹¶ä¸”ä¸ä¼šè¯»åˆ°è¿‡æœŸçš„å€¼ã€‚</p>
<p>å¤åˆ¶</p>
<pre><code>transient volatile int count;
volatile V value;
</code></pre><p>åœ¨å®šä½å…ƒç´ çš„ä»£ç ä¸­å¯ä»¥å‘ç°ï¼Œå®šä½ HashEntry å’Œ Segment çš„æ•£åˆ—ç®—æ³•è™½ç„¶ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸æ•°ç»„çš„é•¿åº¦å‡ 1 å†ç›¸ä¸ï¼Œä½†æ˜¯ç›¸ä¸çš„å€¼ä¸ä¸€æ ·ã€‚å®šä½ segment ä½¿ç”¨çš„æ˜¯å…ƒç´ çš„ hashCode ç»è¿‡å†æ•£åˆ—åå¾—åˆ°çš„å€¼çš„é«˜ä½ï¼Œè€Œå®šä½ HashEntry ç›´æ¥ä½¿ç”¨çš„æ˜¯å†æ•£åˆ—åçš„å€¼ã€‚è¿™ä¹ˆåšçš„ç›®çš„æ˜¯é¿å…ä¸¤æ¬¡æ•£åˆ—åçš„å€¼ä¸€æ ·ï¼Œè™½ç„¶å…ƒç´ åœ¨ Segment é‡Œé¢æ•£å¼€äº†ï¼Œä½†æ˜¯å´æ²¡æœ‰åœ¨ HashEntry ä¸­æ•£å¼€ã€‚</p>
<h5 id="put-æ“ä½œ">put æ“ä½œ</h5>
<p>æºç ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>public V put(K key, V value) {
    if (value == null)
        throw new NullPointerException();
    int hash = hash(key.hashCode());
    return segmentFor(hash).put(key, hash, value, false);  //æºç å¦‚ä¸‹
}
</code></pre><p>å¤åˆ¶</p>
<pre><code>V put(K key, int hash, V value, boolean onlyIfAbsent) {
    lock();
    try {
        int c = count;
        if (c++ &gt; threshold) // ensure capacity
            rehash();  //å¤§äºé˜ˆå€¼ï¼Œéœ€è¦è¿›è¡Œrehashæ‰©å®¹
        HashEntry&lt;K,V&gt;[] tab = table;
        int index = hash &amp; (tab.length - 1);  //å®šä½HashEntryä½ç½®
        HashEntry&lt;K,V&gt; first = tab[index];
        HashEntry&lt;K,V&gt; e = first;
        while (e != null &amp;&amp; (e.hash != hash || !key.equals(e.key)))
            e = e.next;

        V oldValue;
        //å¦‚æœå¯¹åº”çš„keyå·²ç»æœ‰å€¼ï¼Œè¦†ç›–
        if (e != null) {
            oldValue = e.value;
            if (!onlyIfAbsent)
                e.value = value;
        }
        //å†™å…¥æ–°å€¼
        else {
            oldValue = null;
            ++modCount;
            tab[index] = new HashEntry&lt;K,V&gt;(key, hash, first, value);
            count = c; // write-volatile
        }
        return oldValue;
    } finally {
        unlock();
    }
}
</code></pre><p>put æ“ä½œä¸ºäº†çº¿ç¨‹å®‰å…¨æ€§ï¼Œé¦–å…ˆéœ€è¦å®šä½åˆ°å¯¹åº”çš„ Segmentï¼Œå¹¶åœ¨æ“ä½œå…±äº«å˜é‡è¿‡ç¨‹ä¸­åŠ é”ã€‚æ’å…¥æ“ä½œä¸»è¦æœ‰ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>åˆ¤æ–­ Segment ä¸­çš„ HashEntry æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å®¹</li>
<li>å®šä½æ·»åŠ å…ƒç´ çš„ä½ç½®ï¼Œç„¶åå°†å…¶æ”¾åˆ° HashEntry æ•°ç»„ä¸­</li>
</ol>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒSegment çš„æ‰©å®¹åˆ¤æ–­æ¯” HashMap çš„æ‰©å®¹åˆ¤æ–­æ›´åŠ åˆç†ï¼Œå› ä¸º HashMap æ˜¯åœ¨æ’å…¥å…ƒç´ ååˆ¤æ–­å…ƒç´ æ˜¯å¦å·²ç»è¾¾åˆ°å®¹é‡çš„ï¼Œå¦‚æœè¾¾åˆ°äº†å°±è¿›è¡Œæ‰©å®¹ï¼Œä½†æ˜¯æœ‰å¯èƒ½æ‰©å®¹åå¹¶æ²¡æœ‰æ–°å…ƒç´ è¿›è¡Œæ·»åŠ ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±ç›¸å½“äºæ‰©å®¹æ— æ•ˆã€‚</p>
<p>å¤åˆ¶</p>
<pre><code>void rehash() {
    HashEntry&lt;K,V&gt;[] oldTable = table;
    int oldCapacity = oldTable.length;
    if (oldCapacity &gt;= MAXIMUM_CAPACITY)
        return;

    /*
             * Reclassify nodes in each list to new Map.  Because we are
             * using power-of-two expansion, the elements from each bin
             * must either stay at same index, or move with a power of two
             * offset. We eliminate unnecessary node creation by catching
             * cases where old nodes can be reused because their next
             * fields won't change. Statistically, at the default
             * threshold, only about one-sixth of them need cloning when
             * a table doubles. The nodes they replace will be garbage
             * collectable as soon as they are no longer referenced by any
             * reader thread that may be in the midst of traversing table
             * right now.
             */

    HashEntry&lt;K,V&gt;[] newTable = HashEntry.newArray(oldCapacity&lt;&lt;1);
    threshold = (int)(newTable.length * loadFactor);
    int sizeMask = newTable.length - 1;
    for (int i = 0; i &lt; oldCapacity ; i++) {
        // We need to guarantee that any existing reads of old Map can
        //  proceed. So we cannot yet null out each bin.
        HashEntry&lt;K,V&gt; e = oldTable[i];

        if (e != null) {
            HashEntry&lt;K,V&gt; next = e.next;
            int idx = e.hash &amp; sizeMask;

            //  Single node on list
            if (next == null)
                newTable[idx] = e;

            else {
                // Reuse trailing consecutive sequence at same slot
                HashEntry&lt;K,V&gt; lastRun = e;
                int lastIdx = idx;
                for (HashEntry&lt;K,V&gt; last = next;
                     last != null;
                     last = last.next) {
                    int k = last.hash &amp; sizeMask;
                    if (k != lastIdx) {
                        lastIdx = k;
                        lastRun = last;
                    }
                }
                newTable[lastIdx] = lastRun;

                // Clone all remaining nodes
                for (HashEntry&lt;K,V&gt; p = e; p != lastRun; p = p.next) {
                    int k = p.hash &amp; sizeMask;
                    HashEntry&lt;K,V&gt; n = newTable[k];
                    newTable[k] = new HashEntry&lt;K,V&gt;(p.key, p.hash,
                                                     n, p.value);
                }
            }
        }
    }
    table = newTable;
}
</code></pre><h5 id="size-æ“ä½œ">size æ“ä½œ</h5>
<p>ConcurrentHashMap ç»Ÿè®¡å®¹é‡å¾ˆæœ‰æ„æ€ï¼Œç»Ÿè®¡æ•´ä¸ª ConcurrentHashMap ä¸­å…ƒç´ çš„æ•°é‡ï¼Œå°±å¿…é¡»ç»Ÿè®¡æ‰€æœ‰ Segment é‡Œå…ƒç´ çš„å¤§å°åæ±‚å’Œã€‚Segment ä¸­çš„å…¨å±€å˜é‡ count æ˜¯ä¸€ä¸ª volatile å˜é‡ï¼Œé‚£ä¹ˆåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œæ˜¯ä¸æ˜¯ç›´æ¥æŠŠæ‰€æœ‰ Segment é‡Œçš„ count ç›¸åŠ å°±å¯ä»¥å¾—åˆ°æ•´ä¸ª ConcurrentHashMap å¤§å°äº†å‘¢ï¼Ÿ</p>
<p>åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ˜¾ç„¶ä¸æ˜¯çš„ï¼Œè™½ç„¶ç›¸åŠ æ—¶å¯ä»¥è·å–æ¯ä¸ª Segment çš„ count æœ€æ–°å€¼ï¼Œä½†æ˜¯å¯èƒ½ç´¯åŠ å‰ä½¿ç”¨çš„ count å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆç»Ÿè®¡ç»“æœå°±ä¸å‡†äº†ï¼Œæ‰€ä»¥ï¼Œæœ€å®‰å…¨çš„æ–¹æ³•æ˜¯åœ¨ç»Ÿè®¡ size çš„æ—¶å€™æŠŠæ‰€æœ‰çš„ Segment çš„ put ã€remove å’Œ clean æ–¹æ³•éƒ½é”ä½ï¼Œä½†æ˜¯è¿™æ ·åšæ˜¾ç„¶æ•ˆç‡éå¸¸ä½ä¸‹ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹æºç ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>public int size() {
    final Segment&lt;K,V&gt;[] segments = this.segments;
    long sum = 0;
    long check = 0;
    int[] mc = new int[segments.length];
    // Try a few times to get accurate count. On failure due to
    // continuous async changes in table, resort to locking.
    for (int k = 0; k &lt; RETRIES_BEFORE_LOCK; ++k) {
        check = 0;
        sum = 0;
        int mcsum = 0;
        for (int i = 0; i &lt; segments.length; ++i) {
            sum += segments[i].count;
            mcsum += mc[i] = segments[i].modCount;
        }
        if (mcsum != 0) {
            for (int i = 0; i &lt; segments.length; ++i) {
                check += segments[i].count;
                if (mc[i] != segments[i].modCount) {
                    check = -1; // force retry
                    break;
                }
            }
        }
        if (check == sum)
            break;
    }
    if (check != sum) { // Resort to locking all segments
        sum = 0;
        for (int i = 0; i &lt; segments.length; ++i)
            segments[i].lock();
        for (int i = 0; i &lt; segments.length; ++i)
            sum += segments[i].count;
        for (int i = 0; i &lt; segments.length; ++i)
            segments[i].unlock();
    }
    if (sum &gt; Integer.MAX_VALUE)
        return Integer.MAX_VALUE;
    else
        return (int)sum;
}
</code></pre><p>å…¶ä¸­çš„å¸¸é‡<code>RETRIES_BEFORE_LOCK</code>åœ¨æœ€ä¸Šé¢å·²ç»æåˆ°è¿‡ï¼Œé»˜è®¤å€¼æ˜¯ 2ï¼Œè¡¨ç¤ºé‡è¯•æ¬¡æ•°ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæºç ä¸­çš„åšæ³•æ˜¯å…ˆå°è¯• 2 æ¬¡ï¼ˆåˆå§‹çš„é‡è¯•æ¬¡æ•°ï¼‰é€šè¿‡ä¸é”ä½ Segment çš„æ–¹å¼æ¥ç»Ÿè®¡å„ä¸ª Segment å¤§å°ï¼Œå¦‚æœç»Ÿè®¡è¿‡ç¨‹ä¸­ï¼Œå®¹å™¨çš„ count å‘ç”Ÿäº†å˜åŒ–ï¼Œå†é‡‡ç”¨åŠ é”çš„æ–¹å¼æ¥ç»Ÿè®¡æ‰€æœ‰ Segment çš„å¤§å°ã€‚è€Œåˆ¤æ–­ç»Ÿè®¡è¿‡ç¨‹ä¸­å®¹å™¨æ˜¯å¦å‘ç”Ÿå˜åŒ–æ˜¯é€šè¿‡ modCount è¿™ä¸ªå˜é‡æ„ŸçŸ¥çš„ï¼Œåœ¨ put ã€remove å’Œ clean æ–¹æ³•é‡Œæ“ä½œå…ƒç´ å‰éƒ½ä¼šå°†å˜é‡ modCount å€¼åŠ  1ï¼Œé‚£ä¹ˆåœ¨ç»Ÿè®¡ size å‰åæ¯”è¾ƒ modCount æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå¾—çŸ¥å®¹å™¨çš„å¤§å°æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚</p>
<h4 id="jdk-18-æºç ">JDK 1.8 æºç </h4>
<p>JDK 1.8 æ•°æ®ç»“æ„è§ä¸Šï¼Œä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œæå‡å¹¶å‘åº¦ï¼ŒJDK 1.8 å¼€å§‹å»æ‰äº† Segment åˆ†æ®µé”æœºåˆ¶ï¼Œç›´æ¥é‡‡å–äº†ä¸ HashMap ç›¸åŒçš„æ•°æ®ç»“æ„ï¼Œä¸åŒçš„æ˜¯ä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œé‡‡ç”¨äº† CAS + Synchronized è¿›è¡Œ put ã€remove ç­‰æ“ä½œã€‚</p>
<p>ä¸åŒäº JDK 1.7 ä¸­çš„ HashEntry å­˜å‚¨é”®å€¼å¯¹ï¼ŒJDK 1.8 ä¸­é‡‡ç”¨äº† Node è¿™ä¸ªå†…éƒ¨ç±»è¿›è¡Œé”®å€¼å¯¹çš„å­˜å‚¨ã€‚</p>
<p>å…ˆçœ‹ä¸€ä¸‹ JDK 1.8 ä¸­ ConcurrentHashMap çš„å­—æ®µï¼š</p>
<table>
<thead>
<tr>
<th align="center">å­—æ®µå</th>
<th align="center">å«ä¹‰</th>
<th align="center">åˆå§‹å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">MAXIMUM_CAPACITY</td>
<td align="center">æœ€å¤§å®¹é‡</td>
<td align="center">2^30</td>
</tr>
<tr>
<td align="center">DEFAULT_CAPACITY</td>
<td align="center">é»˜è®¤å®¹é‡</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">MAX_ARRAY_SIZE</td>
<td align="center">æœ€å¤§æ•°ç»„å®¹é‡</td>
<td align="center">Integer.MAX_VALUE - 8</td>
</tr>
<tr>
<td align="center">DEFAULT_CONCURRENCY_LEVEL</td>
<td align="center">é»˜è®¤å¹¶å‘åº¦</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">LOAD_FACTOR</td>
<td align="center">è´Ÿè½½å› å­</td>
<td align="center">0.75f</td>
</tr>
</tbody>
</table>
<p>å½“ç„¶è¿˜æœ‰å¾ˆå¤šå­—æ®µï¼Œè¿™é‡ŒåªæŒ‘ä¸€äº›éå¸¸é‡è¦çš„ã€‚</p>
<p>JDK 1.8 ä¸­ ConcurrentHashMap æ¯”è¾ƒå¤æ‚ï¼Œä½†æ˜¯åˆ†ææ—¶åªåˆ†æå¦‚ä½•åˆ©ç”¨ CAS + Synchronized è¿›è¡Œé«˜æ•ˆçš„åŒæ­¥æ›´æ–°æ•°æ®ã€‚</p>
<h5 id="put-æ“ä½œ-1">put æ“ä½œ</h5>
<p>å…ˆçœ‹æºç ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>public V put(K key, V value) {
    return putVal(key, value, false); //æºç å¦‚ä¸‹
}
</code></pre><p>å¤åˆ¶</p>
<pre><code>final V putVal(K key, V value, boolean onlyIfAbsent) {
    //ConcurrentHashMap ä¸å…è®¸æ’å…¥nullé”®ï¼ŒHashMapå…è®¸æ’å…¥ä¸€ä¸ªnullé”®
    if (key == null || value == null) throw new NullPointerException();
    //è®¡ç®—keyçš„hashå€¼
    int hash = spread(key.hashCode());
    int binCount = 0;
    //forå¾ªç¯çš„ä½œç”¨ï¼šå› ä¸ºæ›´æ–°å…ƒç´ æ˜¯ä½¿ç”¨CASæœºåˆ¶æ›´æ–°ï¼Œéœ€è¦ä¸æ–­çš„å¤±è´¥é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚
    for (Node&lt;K,V&gt;[] tab = table;;) {
        // fï¼šé“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘å¤´ç»“ç‚¹ï¼Œå‘é“¾è¡¨ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œéœ€è¦synchronizedè·å–fçš„é”ã€‚
        Node&lt;K,V&gt; f; int n, i, fh;
        //åˆ¤æ–­Node[]æ•°ç»„æ˜¯å¦åˆå§‹åŒ–ï¼Œæ²¡æœ‰åˆ™è¿›è¡Œåˆå§‹åŒ–æ“ä½œ
        if (tab == null || (n = tab.length) == 0)
            tab = initTable();
        //é€šè¿‡hashå®šä½Node[]æ•°ç»„çš„ç´¢å¼•åæ ‡ï¼Œæ˜¯å¦æœ‰NodeèŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨CASè¿›è¡Œæ·»åŠ ï¼ˆé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼‰ï¼Œæ·»åŠ å¤±è´¥åˆ™è¿›å…¥ä¸‹æ¬¡å¾ªç¯ã€‚
        else if ((f = tabAt(tab, i = (n - 1) &amp; hash)) == null) {
            if (casTabAt(tab, i, null,
                         new Node&lt;K,V&gt;(hash, key, value, null)))
                break;                   // no lock when adding to empty bin
        }
        //æ£€æŸ¥åˆ°å†…éƒ¨æ­£åœ¨ç§»åŠ¨å…ƒç´ ï¼ˆNode[] æ•°ç»„æ‰©å®¹ï¼‰
        else if ((fh = f.hash) == MOVED)
            //å¸®åŠ©å®ƒæ‰©å®¹
            tab = helpTransfer(tab, f);
        else {
            V oldVal = null;
            //é”ä½é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„å¤´ç»“ç‚¹
            synchronized (f) {
                //åˆ¤æ–­fæ˜¯å¦æ˜¯é“¾è¡¨çš„å¤´ç»“ç‚¹
                if (tabAt(tab, i) == f) {
                    //å¦‚æœfh&gt;=0 æ˜¯é“¾è¡¨èŠ‚ç‚¹
                    if (fh &gt;= 0) {
                        binCount = 1;
                        //éå†é“¾è¡¨æ‰€æœ‰èŠ‚ç‚¹
                        for (Node&lt;K,V&gt; e = f;; ++binCount) {
                            K ek;
                            //å¦‚æœèŠ‚ç‚¹å­˜åœ¨ï¼Œåˆ™æ›´æ–°value
                            if (e.hash == hash &amp;&amp;
                                ((ek = e.key) == key ||
                                 (ek != null &amp;&amp; key.equals(ek)))) {
                                oldVal = e.val;
                                if (!onlyIfAbsent)
                                    e.val = value;
                                break;
                            }
                            //ä¸å­˜åœ¨åˆ™åœ¨é“¾è¡¨å°¾éƒ¨æ·»åŠ æ–°èŠ‚ç‚¹ã€‚
                            Node&lt;K,V&gt; pred = e;
                            if ((e = e.next) == null) {
                                pred.next = new Node&lt;K,V&gt;(hash, key,
                                                          value, null);
                                break;
                            }
                        }
                    }
                    //TreeBinæ˜¯çº¢é»‘äºŒå‰æ ‘èŠ‚ç‚¹
                    else if (f instanceof TreeBin) {
                        Node&lt;K,V&gt; p;
                        binCount = 2;
                        //æ·»åŠ æ ‘èŠ‚ç‚¹
                        if ((p = ((TreeBin&lt;K,V&gt;)f).putTreeVal(hash, key,
                                                              value)) != null) {
                            oldVal = p.val;
                            if (!onlyIfAbsent)
                                p.val = value;
                        }
                    }
                }
            }

            if (binCount != 0) {
                //å¦‚æœé“¾è¡¨é•¿åº¦å·²ç»è¾¾åˆ°ä¸´ç•Œå€¼8 å°±éœ€è¦æŠŠé“¾è¡¨è½¬æ¢ä¸ºæ ‘ç»“æ„
                if (binCount &gt;= TREEIFY_THRESHOLD)
                    treeifyBin(tab, i);
                if (oldVal != null)
                    return oldVal;
                break;
            }
        }
    }
    //å°†å½“å‰ConcurrentHashMapçš„sizeæ•°é‡+1
    addCount(1L, binCount);
    return null;
}
</code></pre><p>ç®€è€Œè¨€ä¹‹ï¼Œput æ“ä½œçš„é€»è¾‘å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>åˆ¤æ–­ Node[] æ•°ç»„æ˜¯å¦åˆå§‹åŒ–ï¼Œæ²¡æœ‰åˆ™è¿›è¡Œåˆå§‹åŒ–æ“ä½œ</p>
</li>
<li>
<p>é€šè¿‡ hash å®šä½ Node[] æ•°ç»„çš„ç´¢å¼•åæ ‡ï¼Œæ˜¯å¦æœ‰ Node èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨ CAS è¿›è¡Œæ·»åŠ ï¼ˆé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼‰ï¼Œæ·»åŠ å¤±è´¥åˆ™è¿›å…¥ä¸‹æ¬¡å¾ªç¯ã€‚</p>
</li>
<li>
<p>æ£€æŸ¥åˆ°å†…éƒ¨æ­£åœ¨æ‰©å®¹ï¼Œå¦‚æœæ­£åœ¨æ‰©å®¹ï¼Œå°±å¸®åŠ©å®ƒä¸€å—æ‰©å®¹ã€‚</p>
</li>
<li>
<p>å¦‚æœ f != nullï¼Œåˆ™ä½¿ç”¨ synchronized é”ä½ f å…ƒç´ ï¼ˆé“¾è¡¨/çº¢é»‘äºŒå‰æ ‘çš„å¤´å…ƒç´ ï¼‰</p>
<p>4.1 å¦‚æœæ˜¯ Node (é“¾è¡¨ç»“æ„)åˆ™æ‰§è¡Œé“¾è¡¨çš„æ·»åŠ æ“ä½œã€‚
4.2 å¦‚æœæ˜¯ TreeNode (æ ‘å‹ç»“æœ)åˆ™æ‰§è¡Œæ ‘æ·»åŠ æ“ä½œã€‚</p>
</li>
<li>
<p>åˆ¤æ–­é“¾è¡¨é•¿åº¦å·²ç»è¾¾åˆ°ä¸´ç•Œå€¼ 8 å°±éœ€è¦æŠŠé“¾è¡¨è½¬æ¢ä¸ºæ ‘ç»“æ„ã€‚</p>
<h5 id="get-æ“ä½œ-1">get æ“ä½œ</h5>
</li>
</ol>
<p>å…ˆçœ‹æºç ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>public V get(Object key) {
    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; e, p; int n, eh; K ek;
    int h = spread(key.hashCode());
    if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;
        (e = tabAt(tab, (n - 1) &amp; h)) != null) {
        if ((eh = e.hash) == h) {
            if ((ek = e.key) == key || (ek != null &amp;&amp; key.equals(ek)))
                return e.val;
        }
        else if (eh &lt; 0)
            return (p = e.find(h, key)) != null ? p.val : null;
        while ((e = e.next) != null) {
            if (e.hash == h &amp;&amp;
                ((ek = e.key) == key || (ek != null &amp;&amp; key.equals(ek))))
                return e.val;
        }
    }
    return null;
}
</code></pre><p>è¿˜æ˜¯ä¸åŠ é”ï¼Œä½†æ˜¯åŒ JDK 1.7 ç›¸åŒï¼ŒNode èŠ‚ç‚¹ä¸­çš„ value å’Œ next éƒ½æ˜¯ volatile çš„ï¼Œå³çº¿ç¨‹å¯¹è¿™äº›æ•°æ®çš„ä¿®æ”¹å¯¹å…¶ä»–çº¿ç¨‹æ˜¯ç«‹é©¬å¯è§çš„ã€‚é‡çš„ç»“æœ-.-ï¼Œå°±åƒloadFactoré»˜è®¤å€¼0.75ä¸€æ ·ã€‚</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">javaå¤šçº¿ç¨‹</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">javaå¤šçº¿ç¨‹</category>
                                
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java/">java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>HashMapçº¿ç¨‹ä¸å®‰å…¨çš„åŸå› </title>
                <link>https://example.com/posts/hashmap%E7%BA%BF%E7%A8%8B%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E5%8E%9F%E5%9B%A0/</link>
                <guid isPermaLink="true">https://example.com/posts/hashmap%E7%BA%BF%E7%A8%8B%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E5%8E%9F%E5%9B%A0/</guid>
                <pubDate>Fri, 15 Mar 2019 16:01:23 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<h3 id="çº¿ç¨‹ä¸å®‰å…¨çš„hashmap">çº¿ç¨‹ä¸å®‰å…¨çš„HashMap</h3>
<p>HashMap åœ¨æ—¥å¸¸å¼€å‘ä¸­æ˜¯ååˆ†å¸¸è§çš„ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨ Map å­˜å‚¨é”®å€¼å¯¹çš„é¦–é€‰ç±»ï¼Œå…³äº HashMap çš„æºç åˆ†æå¯ä»¥<a href="%5Bhttps://zyhhh.top/posts/hashmap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/%5D(https://zyhhh.top/posts/hashmap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/)">çœ‹è¿™é‡Œ</a>ã€‚ç”±äºä» JDK 1.8 å¼€å§‹å¯¹ HashMap è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¢åŠ äº†çº¢é»‘æ ‘è¿™ç§æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥ JDK 1.8 çš„ HashMap è¾ƒä¸ºå¤æ‚ï¼Œè¿™é‡Œä¸ºäº†ç®€åŒ–åˆ†æï¼Œé‡‡ç”¨ JDK 1.7 ç‰ˆæœ¬ç‰ˆæœ¬çš„ HashMap è¿›è¡Œä¸¾ä¾‹è¯´æ˜ã€‚</p>
<p>HashMap çº¿ç¨‹ä¸å®‰å…¨ä¸»è¦ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li>å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯¹é”®å€¼å¯¹è¿›è¡Œä¿®æ”¹æ“ä½œï¼ˆput å’Œ removeï¼‰ä¼šå‡ºç°ä¸¢å¤±æ›´æ–°é—®é¢˜</li>
<li>1.7ä½¿ç”¨çš„æ˜¯å¤´æ’æ³•ï¼Œä½¿ç”¨å¤´æ’æ³•åœ¨å¤šçº¿ç¨‹æ‰©å®¹çš„è¿‡ç¨‹å¯èƒ½ä¼šé€ æˆé‡Œé¢æœ‰ä¸€ä¸ªresizeæ–¹æ³•ï¼Œå®ƒåˆè°ƒç”¨äº†ä¸€ä¸ªtransferæ–¹æ³•ï¼ŒæŠŠé‡Œé¢çš„Entryè¿›è¡Œä¸€ä¸ªrehash,åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé€ æˆä¸€ä¸ªé“¾è¡¨çš„å¾ªç¯ï¼Œå¯èƒ½åœ¨ä¸‹ä¸€æ¬¡getæ—¶å‡ºç°æ­»å¾ªç¯çš„æƒ…å†µï¼ŒJDK 1.8 å·²ç»ä¿®å¤è¯¥é—®é¢˜</li>
</ol>
<p>ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹ JDK 1.7 ä¸‹ HashMap çš„æºç ä¸­çš„ put æ“ä½œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">V</span> <span class="nf">put</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="k">return</span> <span class="n">putForNullKey</span><span class="o">(</span><span class="n">value</span><span class="o">)</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">hash</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">indexFor</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">table</span><span class="o">.</span><span class="na">length</span><span class="o">)</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">table</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="o">;</span> <span class="n">e</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Object</span> <span class="n">k</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span><span class="o">=</span> <span class="n">hash</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="o">(</span><span class="o">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">key</span> <span class="o">|</span><span class="o">|</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">)</span><span class="o">)</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">e</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
            <span class="n">e</span><span class="o">.</span><span class="na">recordAccess</span><span class="o">(</span><span class="k">this</span><span class="o">)</span><span class="o">;</span>
            <span class="k">return</span> <span class="n">oldValue</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">modCount</span><span class="o">+</span><span class="o">+</span><span class="o">;</span>
    <span class="n">addEntry</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span><span class="o">;</span>
    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨ put æ“ä½œä¸­æœ‰ä¸€ä¸ª addEntry æ–¹æ³•ï¼Œè¿™æ˜¯æ ¸å¿ƒæ–¹æ³•ï¼Œå…¶æºç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kt">void</span> <span class="nf">addEntry</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">,</span> <span class="kt">int</span> <span class="n">bucketIndex</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//è·å–å¤´èŠ‚ç‚¹ï¼Œæ­¤å¤„åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¸å®‰å…¨
</span><span class="c1"></span>    <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">table</span><span class="o">[</span><span class="n">bucketIndex</span><span class="o">]</span><span class="o">;</span>
    <span class="n">table</span><span class="o">[</span><span class="n">bucketIndex</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">size</span><span class="o">+</span><span class="o">+</span> <span class="o">&gt;</span><span class="o">=</span> <span class="n">threshold</span><span class="o">)</span>
        <span class="n">resize</span><span class="o">(</span><span class="n">2</span> <span class="o">*</span> <span class="n">table</span><span class="o">.</span><span class="na">length</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨å‡å¦‚ A çº¿ç¨‹å’Œ B çº¿ç¨‹åŒæ—¶å¯¹åŒä¸€ä¸ªæ•°ç»„ä½ç½®è°ƒç”¨ addEntryï¼Œä¸¤ä¸ªçº¿ç¨‹ä¼šåŒæ—¶å¾—åˆ°ç°åœ¨çš„å¤´ç»“ç‚¹ï¼Œç„¶å A å†™å…¥æ–°çš„å¤´ç»“ç‚¹ä¹‹åï¼ŒB ä¹Ÿå†™å…¥æ–°çš„å¤´ç»“ç‚¹ï¼Œé‚£ B çš„å†™å…¥æ“ä½œå°±ä¼šè¦†ç›– A çš„å†™å…¥æ“ä½œé€ æˆ A çš„å†™å…¥æ“ä½œä¸¢å¤±ã€‚</p>
<p>åŒç†å¯ä»¥çœ‹ä¸€ä¸‹ remove æ“ä½œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">V</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">removeEntryForKey</span><span class="o">(</span><span class="n">key</span><span class="o">)</span><span class="o">;</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">e</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">e</span><span class="o">.</span><span class="na">value</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">removeEntryForKey</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">hash</span> <span class="o">=</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="n">hash</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">indexFor</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">table</span><span class="o">.</span><span class="na">length</span><span class="o">)</span><span class="o">;</span>
    <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">prev</span> <span class="o">=</span> <span class="n">table</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="o">;</span>
    <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">prev</span><span class="o">;</span>

    <span class="k">while</span> <span class="o">(</span><span class="n">e</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="n">Object</span> <span class="n">k</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span><span class="o">=</span> <span class="n">hash</span> <span class="o">&amp;</span><span class="o">&amp;</span>
            <span class="o">(</span><span class="o">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">key</span> <span class="o">|</span><span class="o">|</span> <span class="o">(</span><span class="n">key</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">)</span><span class="o">)</span><span class="o">)</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">modCount</span><span class="o">+</span><span class="o">+</span><span class="o">;</span>
            <span class="n">size</span><span class="o">-</span><span class="o">-</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">prev</span> <span class="o">=</span><span class="o">=</span> <span class="n">e</span><span class="o">)</span>
                <span class="n">table</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
            <span class="k">else</span>
                <span class="n">prev</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
            <span class="n">e</span><span class="o">.</span><span class="na">recordRemoval</span><span class="o">(</span><span class="k">this</span><span class="o">)</span><span class="o">;</span>
            <span class="k">return</span> <span class="n">e</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">e</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œåŒä¸€ä¸ªæ•°ç»„ä½ç½®çš„æ—¶å€™ï¼Œä¹Ÿéƒ½ä¼šå…ˆå–å¾—ç°åœ¨çŠ¶æ€ä¸‹è¯¥ä½ç½®å­˜å‚¨çš„å¤´ç»“ç‚¹ï¼Œç„¶åå„è‡ªå»è¿›è¡Œè®¡ç®—æ“ä½œï¼Œä¹‹åå†æŠŠç»“æœå†™ä¼šåˆ°è¯¥æ•°ç»„ä½ç½®å»ï¼Œå…¶å®å†™å›çš„æ—¶å€™å¯èƒ½å…¶ä»–çš„çº¿ç¨‹å·²ç»å°±æŠŠè¿™ä¸ªä½ç½®ç»™ä¿®æ”¹è¿‡äº†ï¼Œå°±ä¼šè¦†ç›–å…¶ä»–çº¿ç¨‹çš„ä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯ä¸¢å¤±ä¿®æ”¹é—®é¢˜ã€‚</p>
<p><strong>ç¬¬äºŒç§æƒ…å†µä¸­</strong>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ resize æ“ä½œçš„æºç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kt">void</span> <span class="nf">resize</span><span class="o">(</span><span class="kt">int</span> <span class="n">newCapacity</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Entry</span><span class="o">[</span><span class="o">]</span> <span class="n">oldTable</span> <span class="o">=</span> <span class="n">table</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">oldCapacity</span> <span class="o">=</span> <span class="n">oldTable</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">oldCapacity</span> <span class="o">=</span><span class="o">=</span> <span class="n">MAXIMUM_CAPACITY</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">;</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">Entry</span><span class="o">[</span><span class="o">]</span> <span class="n">newTable</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Entry</span><span class="o">[</span><span class="n">newCapacity</span><span class="o">]</span><span class="o">;</span>
    <span class="n">transfer</span><span class="o">(</span><span class="n">newTable</span><span class="o">,</span> <span class="n">initHashSeedAsNeeded</span><span class="o">(</span><span class="n">newCapacity</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">newTable</span><span class="o">;</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">newCapacity</span> <span class="o">*</span> <span class="n">loadFactor</span><span class="o">,</span> <span class="n">MAXIMUM_CAPACITY</span> <span class="o">+</span> <span class="n">1</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/**
</span><span class="cm"> * Transfers all entries from current table to newTable.
</span><span class="cm"> */</span>
<span class="c1">// å…³é”®åœ¨äºè¿™ä¸ªtransferæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å°†æ—§hashè¡¨ä¸­çš„å…ƒç´ rehashåˆ°æ–°çš„hashè¡¨ä¸­
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">transfer</span><span class="o">(</span><span class="n">Entry</span><span class="o">[</span><span class="o">]</span> <span class="n">newTable</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">rehash</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">newCapacity</span> <span class="o">=</span> <span class="n">newTable</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">:</span> <span class="n">table</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// tableå˜é‡å³ä¸ºæ—§hashè¡¨
</span><span class="c1"></span>        <span class="k">while</span><span class="o">(</span><span class="kc">null</span> <span class="o">!</span><span class="o">=</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// #1
</span><span class="c1"></span>            <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">rehash</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span> <span class="kc">null</span> <span class="o">=</span><span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">key</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="n">hash</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">)</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="c1">// ç”¨å…ƒç´ çš„hashå€¼è®¡ç®—å‡ºè¿™ä¸ªå…ƒç´ åœ¨æ–°hashè¡¨ä¸­çš„ä½ç½®
</span><span class="c1"></span>            <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">indexFor</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span><span class="o">,</span> <span class="n">newCapacity</span><span class="o">)</span><span class="o">;</span>
            <span class="c1">// #2
</span><span class="c1"></span>            <span class="n">e</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">newTable</span><span class="o">[</span><span class="n">I</span><span class="o">]</span><span class="o">;</span>
            <span class="c1">// #3
</span><span class="c1"></span>            <span class="n">newTable</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
            <span class="c1">// #4
</span><span class="c1"></span>            <span class="n">e</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>å‡è®¾çº¿ç¨‹ 1 (t1)å’Œçº¿ç¨‹ 2 (t2)åŒæ—¶ resizeï¼Œä¸¤ä¸ªçº¿ç¨‹ resize å‰ï¼Œä¸¤ä¸ªçº¿ç¨‹åŠ HashMap çš„çŠ¶æ€å¦‚ä¸‹ ï¼š</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424223221.png" alt=""></p>
<p>å †å†…å­˜ä¸­çš„ HashMap å¯¹è±¡ä¸­çš„ table å­—æ®µæŒ‡å‘æ—§çš„ hash è¡¨ï¼Œå…¶ä¸­ index ä¸º 7 çš„ä½ç½®æœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬ä»¥è¿™ä¸¤ä¸ªå…ƒç´ çš„ rehash ä¸ºä¾‹ï¼Œçœ‹çœ‹å¾ªç¯é“¾è¡¨æ˜¯å¦‚ä½•å½¢æˆçš„ã€‚</p>
<p>çº¿ç¨‹ 1 å’Œçº¿ç¨‹ 2 åˆ†åˆ« new äº†ä¸€ä¸ª hash è¡¨ï¼Œç”¨ newTable å­—æ®µè¡¨ç¤ºã€‚</p>
<p><strong>Step1</strong>: t2 æ‰§è¡Œå®Œ #1 ä»£ç åï¼ŒCPUä¸”èµ°æ‰§è¡Œ t1ï¼Œå¹¶ä¸” t1 æ‰§è¡Œå®Œæˆ</p>
<p>è¿™é‡Œå¯ä»¥æ ¹æ®ä¸Šå›¾æ¨ç®—ä¸€ä¸‹ï¼Œæ­¤æ—¶çŠ¶æ€å¦‚ä¸‹ ï¼š</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424223232.png" alt=""></p>
<p>ç”¨ t2.e è¡¨ç¤ºçº¿ç¨‹ 2 ä¸­çš„å±€éƒ¨å˜é‡ eï¼Œt2.next åŒç†ã€‚</p>
<p><strong>Step2</strong>: t2 ç»§ç»­å‘ä¸‹æ‰§è¡Œå®Œæœ¬æ¬¡å¾ªç¯</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424223318.png" alt=""></p>
<p><strong>Step3</strong>: t2 ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424223332.png" alt=""></p>
<p><strong>Step4</strong>: t2ç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œå¾ªç¯é“¾è¡¨å‡ºç°</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424223347.png" alt=""></p>
<p>ç„¶åæˆ‘ä»¬åœ¨è¿™ä¸ªæ—¶å€™è¿›è¡Œä¸€ä¸ª get æ“ä½œï¼Œget æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p>
<p>å¤åˆ¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">V</span> <span class="nf">get</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="k">return</span> <span class="n">getForNullKey</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">getEntry</span><span class="o">(</span><span class="n">key</span><span class="o">)</span><span class="o">;</span>

    <span class="k">return</span> <span class="kc">null</span> <span class="o">=</span><span class="o">=</span> <span class="n">entry</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">final</span> <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">getEntry</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">size</span> <span class="o">=</span><span class="o">=</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kt">int</span> <span class="n">hash</span> <span class="o">=</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="n">hash</span><span class="o">(</span><span class="n">key</span><span class="o">)</span><span class="o">;</span>
    <span class="c1">// éå†é“¾è¡¨
</span><span class="c1"></span>    <span class="k">for</span> <span class="o">(</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">table</span><span class="o">[</span><span class="n">indexFor</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">table</span><span class="o">.</span><span class="na">length</span><span class="o">)</span><span class="o">]</span><span class="o">;</span>
         <span class="n">e</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
         <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Object</span> <span class="n">k</span><span class="o">;</span>
        <span class="c1">// å‡è®¾è¿™é‡Œæ¡ä»¶ä¸€ç›´ä¸æˆç«‹
</span><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span><span class="o">=</span> <span class="n">hash</span> <span class="o">&amp;</span><span class="o">&amp;</span>
            <span class="o">(</span><span class="o">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">key</span> <span class="o">|</span><span class="o">|</span> <span class="o">(</span><span class="n">key</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">)</span><span class="o">)</span><span class="o">)</span><span class="o">)</span>
            <span class="k">return</span> <span class="n">e</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>ç”±ä¸Šå›¾å¯çŸ¥ï¼Œfor å¾ªç¯ä¸­çš„ <code>e = e.next</code>æ°¸è¿œä¸ä¼šä¸ºç©ºï¼Œé‚£ä¹ˆï¼Œå¦‚æœ get ä¸€ä¸ªåœ¨è¿™ä¸ªé“¾è¡¨ä¸­ä¸å­˜åœ¨çš„ key æ—¶ï¼Œå°±ä¼šå‡ºç°æ­»å¾ªç¯äº†ã€‚</p>
<h3 id="å®ç°çº¿ç¨‹å®‰å…¨">å®ç°çº¿ç¨‹å®‰å…¨</h3>
<p>é‚£ä¹ˆå¦‚ä½•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„ HashMap å‘¢ï¼Ÿ</p>
<p>å¯ä»¥æœ‰ä¸€ä¸‹è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>ä½¿ç”¨ Collections.synchronizedMap(Map&lt;K,V&gt; ) æ–¹æ³•æŠŠ HashMap å˜æˆä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ Map</li>
<li>ä½¿ç”¨ Hashtableã€ConcurrentHashMap è¿™ä¸¤ä¸ªçº¿ç¨‹å®‰å…¨çš„ Map</li>
</ul>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">javaå¤šçº¿ç¨‹</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">javaå¤šçº¿ç¨‹</category>
                                
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java/">java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>HashMapæºç åˆ†æ</title>
                <link>https://example.com/posts/hashmap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</link>
                <guid isPermaLink="true">https://example.com/posts/hashmap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</guid>
                <pubDate>Thu, 14 Mar 2019 16:01:23 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<blockquote>
<p><code>HashMap</code>æœ€æ—©å‡ºç°åœ¨JDK1.2ä¸­ï¼Œåº•å±‚åŸºäºæ•£åˆ—ç®—æ³•ï¼ˆHashï¼‰å®ç°ã€‚å¹¶ä¸”<code>HashMap</code>å…è®¸nullé”®å’Œnullå€¼ï¼Œæ˜¯çº¿ç¨‹éå®‰å…¨ç±»ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½ä¼šå­˜åœ¨é—®é¢˜ï¼Œä¸ä¹‹å¯¹åº”çš„æ˜¯<code>HashTable</code>ç±»ï¼Œ<code>HashTable</code>æ˜¯çº¿ç¨‹å®‰å…¨çš„<code>HashMap</code>ï¼Œä½†æ˜¯åœ¨ä¹‹å‰ç”±äºHashTableæ–¹æ³•éƒ½æ˜¯ç”¨<code>synchronized</code>å®ç°ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹æ—¶åè€Œå¹¶ä¸ä½¿ç”¨<code>HashTable</code>ï¼Œè€Œæ˜¯ä½¿ç”¨<code>CurrentHashMap</code>ã€‚åœ¨JDK1.8åï¼Œ<code>HashMap</code>å’Œ<code>CurrentHashMap</code>çš„æ•°æ®ç»“æ„éƒ½æœ‰äº†æ–°å˜åŒ–ï¼Œå³åŠ å…¥äº†çº¢é»‘æ ‘ã€‚</p>
</blockquote>
<h3 id="jdk17åŠä¹‹å‰ç‰ˆæœ¬ä¸­çš„hashmapæ•°æ®ç»“æ„">JDK1.7åŠä¹‹å‰ç‰ˆæœ¬ä¸­çš„HashMapæ•°æ®ç»“æ„</h3>
<p>åœ¨JDK1.6ï¼Œ1.7ä¸­ï¼ŒHashMapéƒ½æ˜¯åŸºäºâ€œæ‹‰é“¾æ³•â€å®ç°ï¼Œå³æ•°ç»„+é“¾è¡¨çš„å½¢å¼ï¼Œé€šè¿‡ä¸åŒçš„hashå€¼æ¥å¯¹é”®åˆ†é…ä¸åŒçš„æ¡¶ï¼ˆbucketï¼‰ã€‚æ•°æ®èŠ‚ç‚¹ä¸ºEntryèŠ‚ç‚¹ï¼Œæ•°æ®æ’å…¥ä½¿ç”¨å¤´æ’æ³•ï¼Œæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„åŸå› ä¹‹ä¸€ã€‚</p>
<h3 id="jdk18ç‰ˆæœ¬çš„hashmapæ•°æ®ç»“æ„">JDK1.8ç‰ˆæœ¬çš„HashMapæ•°æ®ç»“æ„</h3>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200415155353.png" alt=""></p>
<p>åœ¨JDK1.8ä¸­å¯¹HashMapçš„æºç è¿›è¡Œäº†ä¼˜åŒ–ï¼Œåœ¨JDK1.7ä¸­ï¼ŒHashMapå¤„ç†â€œç¢°æ’â€çš„æ—¶å€™ï¼Œéƒ½æ˜¯é‡‡ç”¨é“¾è¡¨æ¥å­˜å‚¨ï¼Œå½“ç¢°æ’çš„èŠ‚ç‚¹å¾ˆå¤šçš„æ—¶å€™ï¼ŒæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä»åŸæ¥çš„O(1)å˜æˆäº†O(N)ã€‚è€ŒJDK1.8ä¸­ï¼Œä¸ºäº†ä¼˜åŒ–è¿™ç§æƒ…å†µï¼ŒHashMapå¤„ç†â€œç¢°æ’â€å¢åŠ äº†çº¢é»‘æ ‘è¿™ç§æ•°æ®ç»“æ„ï¼Œå½“ç¢°æ’èŠ‚ç‚¹è¾ƒå°‘æ—¶ï¼Œé‡‡æ ·é“¾è¡¨å­˜å‚¨ï¼Œå½“è¾ƒå¤§ï¼ˆé»˜è®¤æ˜¯è¶…è¿‡8ï¼‰æ—¶ï¼Œå˜æˆä½¿ç”¨çº¢é»‘æ ‘ï¼ˆç‰¹ç‚¹æ˜¯æŸ¥è¯¢æ—¶é—´æ˜¯O(logN)ï¼‰å­˜å‚¨ã€‚</p>
<h4 id="ç»“æ„">ç»“æ„</h4>
<p><code>Node</code>æ˜¯HashMapä¸­çš„ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//Nodeæ˜¯å•å‘é“¾è¡¨ï¼Œå®ç°äº†Map.Entryæ¥å£
</span><span class="c1"></span><span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
 	<span class="kd">final</span> <span class="kt">int</span> <span class="n">hash</span><span class="o">;</span> <span class="c1">//å“ˆå¸Œ
</span><span class="c1"></span> 	<span class="kd">final</span> <span class="n">K</span> <span class="n">key</span><span class="o">;</span>  <span class="c1">//é”®å€¼å¯¹
</span><span class="c1"></span>   <span class="n">V</span> <span class="n">value</span><span class="o">;</span>
 	<span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>  <span class="c1">//ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
</span><span class="c1"></span>    
	 <span class="c1">//æ„é€ å‡½æ•°
</span><span class="c1"></span>  <span class="n">Node</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
	 <span class="k">this</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span> <span class="n">hash</span><span class="o">;</span>
 	 <span class="k">this</span><span class="o">.</span><span class="na">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">;</span>
 	 <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
 	 <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
 	<span class="o">}</span>

 	<span class="c1">// getter and setter ... toString ...
</span><span class="c1"></span> 	<span class="kd">public</span> <span class="kd">final</span> <span class="n">K</span> <span class="nf">getKey</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span> <span class="k">return</span> <span class="n">key</span><span class="o">;</span> <span class="o">}</span>
 	<span class="kd">public</span> <span class="kd">final</span> <span class="n">V</span> <span class="nf">getValue</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
 	<span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span> <span class="k">return</span> <span class="n">key</span> <span class="o">+</span> <span class="s">&#34;=&#34;</span> <span class="o">+</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>

	<span class="kd">public</span> <span class="kd">final</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
 	<span class="k">return</span> <span class="n">Objects</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">key</span><span class="o">)</span> <span class="o">^</span> <span class="n">Objects</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">value</span><span class="o">)</span><span class="o">;</span>
   <span class="o">}</span>

 <span class="kd">public</span> <span class="kd">final</span> <span class="n">V</span> <span class="nf">setValue</span><span class="o">(</span><span class="n">V</span> <span class="n">newValue</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">oldValue</span><span class="o">;</span>
 <span class="o">}</span>

 <span class="kd">public</span> <span class="kd">final</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
 	<span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="o">=</span><span class="o">=</span> <span class="k">this</span><span class="o">)</span>
 	   <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
 	<span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="k">instanceof</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">)</span> <span class="o">{</span>
 	   <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="o">?</span><span class="o">,</span><span class="o">?</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="o">?</span><span class="o">,</span><span class="o">?</span><span class="o">&gt;</span><span class="o">)</span><span class="n">o</span><span class="o">;</span>
 	<span class="k">if</span> <span class="o">(</span><span class="n">Objects</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getKey</span><span class="o">(</span><span class="o">)</span><span class="o">)</span> <span class="o">&amp;</span><span class="o">&amp;</span>
 	   <span class="n">Objects</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">)</span>
 	   <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
  <span class="o">}</span>
    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>TreeNode</code>æ˜¯çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">static</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
 	<span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">parent</span><span class="o">;</span> <span class="c1">// red-black tree links
</span><span class="c1"></span> 	<span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">left</span><span class="o">;</span>
 	<span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">right</span><span class="o">;</span>
 	<span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">prev</span><span class="o">;</span> <span class="c1">// needed to unlink next upon deletion
</span><span class="c1"></span> 	<span class="kt">boolean</span> <span class="n">red</span><span class="o">;</span>
 	<span class="n">TreeNode</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">val</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
 	<span class="kd">super</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">val</span><span class="o">,</span> <span class="n">next</span><span class="o">)</span><span class="o">;</span>
 <span class="o">}</span>

 <span class="cm">/**
</span><span class="cm">     * Returns root of tree containing this node.
</span><span class="cm">     */</span>
 <span class="kd">final</span> <span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">root</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
 	<span class="k">for</span> <span class="o">(</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="k">this</span><span class="o">,</span> <span class="n">p</span><span class="o">;</span><span class="o">;</span><span class="o">)</span> <span class="o">{</span>
 		<span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">p</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="na">parent</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span>
 			<span class="k">return</span> <span class="n">r</span><span class="o">;</span>
         <span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="o">;</span>
 	<span class="o">}</span>
 <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="ç±»å®šä¹‰">ç±»å®šä¹‰</h4>
<pre><code>public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable
</code></pre><h4 id="å˜é‡">å˜é‡</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="cm">/**
</span><span class="cm"> * é»˜è®¤åˆå§‹å®¹é‡16(å¿…é¡»æ˜¯2çš„å¹‚æ¬¡æ–¹)
</span><span class="cm"> */</span>
<span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DEFAULT_INITIAL_CAPACITY</span> <span class="o">=</span> <span class="n">1</span> <span class="o">&lt;</span><span class="o">&lt;</span> <span class="n">4</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * æœ€å¤§å®¹é‡ï¼Œ2çš„30æ¬¡æ–¹
</span><span class="cm"> */</span>
<span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAXIMUM_CAPACITY</span> <span class="o">=</span> <span class="n">1</span> <span class="o">&lt;</span><span class="o">&lt;</span> <span class="n">30</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * é»˜è®¤åŠ è½½å› å­ï¼Œç”¨æ¥è®¡ç®—threshold
</span><span class="cm"> */</span>
<span class="kd">static</span> <span class="kd">final</span> <span class="kt">float</span> <span class="n">DEFAULT_LOAD_FACTOR</span> <span class="o">=</span> <span class="n">0</span><span class="o">.</span><span class="na">75f</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * é“¾è¡¨è½¬æˆæ ‘çš„é˜ˆå€¼ï¼Œå½“æ¡¶ä¸­é“¾è¡¨é•¿åº¦å¤§äº8æ—¶è½¬æˆæ ‘ 
</span><span class="cm">   threshold = capacity * loadFactor
</span><span class="cm"> */</span>
<span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">TREEIFY_THRESHOLD</span> <span class="o">=</span> <span class="n">8</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * è¿›è¡Œresizeæ“ä½œæ—¶ï¼Œè‹¥æ¡¶ä¸­æ•°é‡å°‘äº6åˆ™ä»æ ‘è½¬æˆé“¾è¡¨
</span><span class="cm"> */</span>
<span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">UNTREEIFY_THRESHOLD</span> <span class="o">=</span> <span class="n">6</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * æ¡¶ä¸­ç»“æ„è½¬åŒ–ä¸ºçº¢é»‘æ ‘å¯¹åº”çš„tableçš„æœ€å°å¤§å°
</span><span class="cm">   å½“éœ€è¦å°†è§£å†³ hash å†²çªçš„é“¾è¡¨è½¬å˜ä¸ºçº¢é»‘æ ‘æ—¶ï¼Œ
</span><span class="cm">   éœ€è¦åˆ¤æ–­ä¸‹æ­¤æ—¶æ•°ç»„å®¹é‡ï¼Œ
</span><span class="cm">   è‹¥æ˜¯ç”±äºæ•°ç»„å®¹é‡å¤ªå°ï¼ˆå°äºã€€MIN_TREEIFY_CAPACITYã€€ï¼‰
</span><span class="cm">   å¯¼è‡´çš„ hash å†²çªå¤ªå¤šï¼Œåˆ™ä¸è¿›è¡Œé“¾è¡¨è½¬å˜ä¸ºçº¢é»‘æ ‘æ“ä½œï¼Œ
</span><span class="cm">   è½¬ä¸ºåˆ©ç”¨ã€€resize() å‡½æ•°å¯¹ã€€hashMap æ‰©å®¹
</span><span class="cm"> */</span>
<span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MIN_TREEIFY_CAPACITY</span> <span class="o">=</span> <span class="n">64</span><span class="o">;</span>
<span class="cm">/**
</span><span class="cm"> ä¿å­˜Node&lt;K,V&gt;èŠ‚ç‚¹çš„æ•°ç»„
</span><span class="cm"> è¯¥è¡¨åœ¨é¦–æ¬¡ä½¿ç”¨æ—¶åˆå§‹åŒ–ï¼Œå¹¶æ ¹æ®éœ€è¦è°ƒæ•´å¤§å°ã€‚ åˆ†é…æ—¶ï¼Œ
</span><span class="cm"> é•¿åº¦å§‹ç»ˆæ˜¯2çš„å¹‚ã€‚
</span><span class="cm"> */</span>
<span class="kd">transient</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">[</span><span class="o">]</span> <span class="n">table</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * å­˜æ”¾å…·ä½“å…ƒç´ çš„é›†
</span><span class="cm"> */</span>
<span class="kd">transient</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="n">entrySet</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * è®°å½• hashMap å½“å‰å­˜å‚¨çš„å…ƒç´ çš„æ•°é‡
</span><span class="cm"> */</span>
<span class="kd">transient</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * æ¯æ¬¡æ›´æ”¹mapç»“æ„çš„è®¡æ•°å™¨
</span><span class="cm"> */</span>
<span class="kd">transient</span> <span class="kt">int</span> <span class="n">modCount</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * ä¸´ç•Œå€¼ å½“å®é™…å¤§å°(å®¹é‡*å¡«å……å› å­)è¶…è¿‡ä¸´ç•Œå€¼æ—¶ï¼Œä¼šè¿›è¡Œæ‰©å®¹
</span><span class="cm"> */</span>
<span class="kt">int</span> <span class="n">threshold</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * è´Ÿè½½å› å­ï¼šè¦è°ƒæ•´å¤§å°çš„ä¸‹ä¸€ä¸ªå¤§å°å€¼ï¼ˆå®¹é‡*åŠ è½½å› å­ï¼‰ã€‚
</span><span class="cm"> */</span>
<span class="kd">final</span> <span class="kt">float</span> <span class="n">loadFactor</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="æ„é€ æ–¹æ³•">æ„é€ æ–¹æ³•</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="nf">HashMap</span><span class="o">(</span><span class="kt">int</span> <span class="n">initialCapacity</span><span class="o">,</span> <span class="kt">float</span> <span class="n">loadFactor</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// åˆå§‹å®¹é‡ä¸èƒ½å°äº0ï¼Œå¦åˆ™æŠ¥é”™
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">initialCapacity</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&#34;Illegal initial capacity: &#34;</span> <span class="o">+</span> <span class="n">initialCapacity</span><span class="o">)</span><span class="o">;</span>
    <span class="c1">// åˆå§‹å®¹é‡ä¸èƒ½å¤§äºæœ€å¤§å€¼ï¼Œå¦åˆ™ä¸ºæœ€å¤§å€¼
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">initialCapacity</span> <span class="o">&gt;</span> <span class="n">MAXIMUM_CAPACITY</span><span class="o">)</span>
        <span class="n">initialCapacity</span> <span class="o">=</span> <span class="n">MAXIMUM_CAPACITY</span><span class="o">;</span>
    
    <span class="c1">//è´Ÿè½½å› å­ä¸èƒ½å°äºæˆ–ç­‰äº0ï¼Œä¸èƒ½ä¸ºéæ•°å­—
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">loadFactor</span> <span class="o">&lt;</span><span class="o">=</span> <span class="n">0</span> <span class="o">|</span><span class="o">|</span> <span class="n">Float</span><span class="o">.</span><span class="na">isNaN</span><span class="o">(</span><span class="n">loadFactor</span><span class="o">)</span><span class="o">)</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&#34;Illegal load factor: &#34;</span> <span class="o">+</span> <span class="n">loadFactor</span><span class="o">)</span><span class="o">;</span>
    
    <span class="c1">// åˆå§‹åŒ–è´Ÿè½½å› å­                                        
</span><span class="c1"></span>    <span class="k">this</span><span class="o">.</span><span class="na">loadFactor</span> <span class="o">=</span> <span class="n">loadFactor</span><span class="o">;</span>
    
    <span class="c1">// åˆå§‹åŒ–thresholdå¤§å°
</span><span class="c1"></span>    <span class="k">this</span><span class="o">.</span><span class="na">threshold</span> <span class="o">=</span> <span class="n">tableSizeFor</span><span class="o">(</span><span class="n">initialCapacity</span><span class="o">)</span><span class="o">;</span>    
<span class="o">}</span>

<span class="kd">public</span> <span class="nf">HashMap</span><span class="o">(</span><span class="kt">int</span> <span class="n">initialCapacity</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// è°ƒç”¨HashMap(int, float)å‹æ„é€ å‡½æ•°
</span><span class="c1"></span>    <span class="k">this</span><span class="o">(</span><span class="n">initialCapacity</span><span class="o">,</span> <span class="n">DEFAULT_LOAD_FACTOR</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="nf">HashMap</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// åˆå§‹åŒ–å¡«å……å› å­ï¼Œæ­¤å¤„è¯´æ˜HashMapä¹Ÿæ˜¯é‡‡ç”¨å»¶è¿ŸåŠ è½½çš„æ–¹å¼ï¼Œé¦–æ¬¡ä½¿ç”¨æ—¶æ‰ä¼šè¿›è¡ŒåŠ è½½
</span><span class="c1"></span>    <span class="k">this</span><span class="o">.</span><span class="na">loadFactor</span> <span class="o">=</span> <span class="n">DEFAULT_LOAD_FACTOR</span><span class="o">;</span>
        
<span class="kd">public</span> <span class="nf">HashMap</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="o">?</span> <span class="kd">extends</span> <span class="n">K</span><span class="o">,</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">m</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// åˆå§‹åŒ–å¡«å……å› å­
</span><span class="c1"></span>    <span class="k">this</span><span class="o">.</span><span class="na">loadFactor</span> <span class="o">=</span> <span class="n">DEFAULT_LOAD_FACTOR</span><span class="o">;</span>
    <span class="c1">// å°†mä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³HashMapä¸­
</span><span class="c1"></span>    <span class="n">putMapEntries</span><span class="o">(</span><span class="n">m</span><span class="o">,</span> <span class="kc">false</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>
    
<span class="c1">//putMapEntries(Map m, boolean evict)å‡½æ•°å°†mçš„æ‰€æœ‰å…ƒç´ å­˜å…¥æœ¬HashMapå®ä¾‹ä¸­ã€‚
</span><span class="c1"></span><span class="kd">final</span> <span class="kt">void</span> <span class="nf">putMapEntries</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="o">?</span> <span class="kd">extends</span> <span class="n">K</span><span class="o">,</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">m</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">evict</span><span class="o">)</span> <span class="o">{</span>
<span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">size</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
<span class="k">if</span> <span class="o">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// åˆ¤æ–­tableæ˜¯å¦å·²ç»åˆå§‹åŒ–
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="n">table</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// pre-size
</span><span class="c1"></span>       <span class="c1">// æœªåˆå§‹åŒ–ï¼Œsä¸ºmçš„å®é™…å…ƒç´ ä¸ªæ•°
</span><span class="c1"></span>       <span class="kt">float</span> <span class="n">ft</span> <span class="o">=</span> <span class="o">(</span><span class="o">(</span><span class="kt">float</span><span class="o">)</span><span class="n">s</span> <span class="o">/</span> <span class="n">loadFactor</span><span class="o">)</span> <span class="o">+</span> <span class="n">1</span><span class="o">.</span><span class="na">0F</span><span class="o">;</span>
       <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="o">(</span><span class="o">(</span><span class="n">ft</span> <span class="o">&lt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span><span class="n">MAXIMUM_CAPACITY</span><span class="o">)</span> <span class="o">?</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="n">ft</span> <span class="o">:</span> <span class="n">MAXIMUM_CAPACITY</span><span class="o">)</span><span class="o">;</span>
            <span class="c1">// è®¡ç®—å¾—åˆ°çš„tå¤§äºé˜ˆå€¼ï¼Œåˆ™åˆå§‹åŒ–é˜ˆå€¼
</span><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="o">)</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="n">tableSizeFor</span><span class="o">(</span><span class="n">t</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">// å·²åˆå§‹åŒ–ï¼Œå¹¶ä¸”må…ƒç´ ä¸ªæ•°å¤§äºé˜ˆå€¼ï¼Œè¿›è¡Œæ‰©å®¹å¤„ç†
</span><span class="c1"></span>        <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="o">)</span>
            <span class="n">resize</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="c1">// å°†mä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³HashMapä¸­
</span><span class="c1"></span>        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="o">?</span> <span class="kd">extends</span> <span class="n">K</span><span class="o">,</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">:</span> <span class="n">m</span><span class="o">.</span><span class="na">entrySet</span><span class="o">(</span><span class="o">)</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">K</span> <span class="n">key</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getKey</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
            <span class="n">V</span> <span class="n">value</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
            <span class="n">putVal</span><span class="o">(</span><span class="n">hash</span><span class="o">(</span><span class="n">key</span><span class="o">)</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">evict</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="tablesizeforæ–¹æ³•è¯¦è§£">tableSizeForæ–¹æ³•è¯¦è§£</h4>
<p>ç”¨ä½è¿ç®—æ‰¾åˆ°å¤§äºæˆ–ç­‰äºcapçš„æœ€å°2çš„æ•´æ¬¡å¹‚çš„æ•°ï¼Œæ¯”å¦‚10ï¼Œåˆ™è¿”å›16ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="nf">tableSizeFor</span><span class="o">(</span><span class="kt">int</span> <span class="n">cap</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">cap</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>
        <span class="n">n</span> <span class="o">|</span><span class="o">=</span> <span class="n">n</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="n">1</span><span class="o">;</span>
        <span class="n">n</span> <span class="o">|</span><span class="o">=</span> <span class="n">n</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="n">2</span><span class="o">;</span>
        <span class="n">n</span> <span class="o">|</span><span class="o">=</span> <span class="n">n</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="n">4</span><span class="o">;</span>
        <span class="n">n</span> <span class="o">|</span><span class="o">=</span> <span class="n">n</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="n">8</span><span class="o">;</span>
        <span class="n">n</span> <span class="o">|</span><span class="o">=</span> <span class="n">n</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="n">16</span><span class="o">;</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">?</span> <span class="n">1</span> <span class="o">:</span> <span class="o">(</span><span class="n">n</span> <span class="o">&gt;</span><span class="o">=</span> <span class="n">MAXIMUM_CAPACITY</span><span class="o">)</span> <span class="o">?</span> <span class="n">MAXIMUM_CAPACITY</span> <span class="o">:</span> <span class="n">n</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol>
<li>è®©cap-1å†èµ‹å€¼ç»™nçš„ç›®çš„æ˜¯ä½¿å¾—æ‰¾åˆ°çš„ç›®æ ‡å€¼å¤§äºæˆ–ç­‰äºåŸå€¼ã€‚ä¾‹å¦‚äºŒè¿›åˆ¶<code>0100</code>,åè¿›åˆ¶æ˜¯4,è‹¥ä¸å‡1è€Œç›´æ¥æ“ä½œï¼Œç­”æ¡ˆæ˜¯<code>0001 0000</code>åè¿›åˆ¶æ˜¯16ï¼Œæ˜æ˜¾ä¸ç¬¦åˆé¢„æœŸã€‚</li>
<li>å¯¹nå³ç§»1ä½ï¼š001xxâ€¦xxxï¼Œå†ä½æˆ–ï¼š011xxâ€¦xxx</li>
<li>å¯¹nå³ç§»2ä½ï¼š00011â€¦xxxï¼Œå†ä½æˆ–ï¼š01111â€¦xxx</li>
<li>å¯¹nå³ç§»4ä½â€¦</li>
<li>å¯¹nå³ç§»8ä½â€¦</li>
<li>å¯¹nå³ç§»16ä½,å› ä¸ºintæœ€å¤§å°±<code>2^32</code>æ‰€ä»¥ç§»åŠ¨1ã€2ã€4ã€8ã€16ä½å¹¶å–ä½æˆ–,ä¼šå°†æœ€é«˜ä½çš„1åé¢çš„ä½å…¨å˜ä¸º1ã€‚</li>
<li>å†è®©ç»“æœn+1ï¼Œå³å¾—åˆ°äº†2çš„æ•´æ•°æ¬¡å¹‚çš„å€¼äº†ã€‚</li>
</ol>
<p>é™„å¸¦ä¸€ä¸ªå®ä¾‹ï¼š</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200424224740.png" alt=""></p>
<h4 id="loadfactoryè´Ÿè½½å› å­">loadFactoryè´Ÿè½½å› å­</h4>
<p><strong>å¯¹äºHashMapæ¥è¯´ï¼Œè´Ÿè½½å› å­æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å‚æ•°ï¼Œè¯¥å‚æ•°ååº”äº†HashMapæ¡¶æ•°ç»„çš„ä½¿ç”¨æƒ…å†µï¼Œé€šè¿‡è°ƒèŠ‚è´Ÿè½½å› å­ï¼Œå¯ä»¥ä½¿HashMapæ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä¸Šæœ‰ä¸åŒçš„è¡¨ç°ã€‚</strong></p>
<p>å½“æˆ‘ä»¬è°ƒä½è´Ÿè½½å› å­æ—¶ï¼ŒHashMap æ‰€èƒ½å®¹çº³çš„é”®å€¼å¯¹æ•°é‡å˜å°‘ã€‚æ‰©å®¹æ—¶ï¼Œé‡æ–°å°†é”®å€¼å¯¹å­˜å‚¨æ–°çš„æ¡¶æ•°ç»„é‡Œï¼Œé”®çš„é”®ä¹‹é—´äº§ç”Ÿçš„ç¢°æ’ä¼šä¸‹é™ï¼Œé“¾è¡¨é•¿åº¦å˜çŸ­ã€‚æ­¤æ—¶ï¼ŒHashMap çš„å¢åˆ æ”¹æŸ¥ç­‰æ“ä½œçš„æ•ˆç‡å°†ä¼šå˜é«˜ï¼Œè¿™é‡Œæ˜¯å…¸å‹çš„æ‹¿ç©ºé—´æ¢æ—¶é—´ã€‚</p>
<p>ç›¸åï¼Œå¦‚æœå¢åŠ è´Ÿè½½å› å­ï¼ˆè´Ÿè½½å› å­å¯ä»¥å¤§äº1ï¼‰ï¼ŒHashMap æ‰€èƒ½å®¹çº³çš„é”®å€¼å¯¹æ•°é‡å˜å¤šï¼Œç©ºé—´åˆ©ç”¨ç‡é«˜ï¼Œä½†ç¢°æ’ç‡ä¹Ÿé«˜ã€‚è¿™æ„å‘³ç€é“¾è¡¨é•¿åº¦å˜é•¿ï¼Œæ•ˆç‡ä¹Ÿéšä¹‹é™ä½ï¼Œè¿™ç§æƒ…å†µæ˜¯æ‹¿æ—¶é—´æ¢ç©ºé—´ã€‚è‡³äºè´Ÿè½½å› å­æ€ä¹ˆè°ƒèŠ‚ï¼Œè¿™ä¸ªçœ‹ä½¿ç”¨åœºæ™¯äº†ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨é»˜è®¤å€¼å°±å¯ä»¥äº†ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹0.75åœ¨æ—¶é—´è·Ÿç©ºé—´ä»£ä»·ä¸Šè¾¾åˆ°äº†å¹³è¡¡æ‰€ä»¥ä¸å»ºè®®ä¿®æ”¹ã€‚</p>
<h4 id="æŸ¥æ‰¾">æŸ¥æ‰¾</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">V</span> <span class="nf">get</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span><span class="o">;</span>
   <span class="k">return</span> <span class="o">(</span><span class="n">e</span> <span class="o">=</span> <span class="n">getNode</span><span class="o">(</span><span class="n">hash</span><span class="o">(</span><span class="n">key</span><span class="o">)</span><span class="o">,</span> <span class="n">key</span><span class="o">)</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">e</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">// HashMapä¸­çš„Hashæ–¹æ³•
</span><span class="c1"></span><span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="nf">hash</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
   <span class="kt">int</span> <span class="n">h</span><span class="o">;</span>
 <span class="c1">// æ‹¿åˆ°keyçš„hashå€¼åä¸å…¶æ— ç¬¦å·å³ç§»16ä½å–â€œä¸â€
</span><span class="c1"></span> <span class="c1">// è¿™ç§æ–¹å¼èƒ½æ··åˆåŸå§‹hashå€¼çš„é«˜ä½å’Œä½ä½ï¼Œå¹¶ä¸”æ··åˆåçš„ä½ä½æ··æ‚äº†é«˜ä½çš„ç‰¹å¾
</span><span class="c1"></span> <span class="c1">// ä¸»è¦æ˜¯è€ƒè™‘æ•°ç»„çš„tableçš„lengthæ¯”è¾ƒå°çš„æ—¶å€™ä¹Ÿèƒ½ä¿è¯è€ƒè™‘åˆ°é«˜ä½bitéƒ½èƒ½å‚ä¸åˆ°hashä¸­ï¼Œå¹¶ä¸”æ•ˆç‡å¾ˆé«˜
</span><span class="c1"></span> <span class="c1">// é€šè¿‡è¿™ç§æ–¹å¼ï¼Œè®©é«˜ä½æ•°æ®ä¸ä½ä½æ•°æ®è¿›è¡Œå¼‚æˆ–ï¼Œä»¥æ­¤åŠ å¤§ä½ä½ä¿¡æ¯çš„éšæœºæ€§ï¼Œå˜ç›¸çš„è®©é«˜ä½æ•°æ®å‚ä¸åˆ°è®¡ç®—ä¸­ã€‚
</span><span class="c1"></span>  <span class="k">return</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="o">(</span><span class="n">h</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="o">)</span><span class="o">)</span> <span class="o">^</span> <span class="o">(</span><span class="n">h</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="n">16</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">final</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">getNode</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
 	<span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">[</span><span class="o">]</span> <span class="n">tab</span><span class="o">;</span> 
 	<span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">first</span><span class="o">,</span> <span class="n">e</span><span class="o">;</span> 
 	<span class="kt">int</span> <span class="n">n</span><span class="o">;</span> <span class="n">K</span> <span class="n">k</span><span class="o">;</span>
 <span class="c1">// å®šä½é”®å€¼å¯¹æ‰€åœ¨æ¡¶çš„ä½ç½®
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">tab</span> <span class="o">=</span> <span class="n">table</span><span class="o">)</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="o">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">&gt;</span> <span class="n">0</span> <span class="o">&amp;</span><span class="o">&amp;</span>  <span class="o">(</span><span class="n">first</span> <span class="o">=</span> <span class="n">tab</span><span class="o">[</span><span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">hash</span><span class="o">]</span><span class="o">)</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
 <span class="c1">// åˆ¤æ–­æ¡¶ä¸­ç¬¬ä¸€é¡¹(æ•°ç»„å…ƒç´ )ç›¸ç­‰
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="n">first</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span><span class="o">=</span> <span class="n">hash</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="c1">// always check first node
</span><span class="c1"></span>     <span class="o">(</span><span class="o">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">key</span> <span class="o">|</span><span class="o">|</span> <span class="o">(</span><span class="n">key</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">)</span><span class="o">)</span><span class="o">)</span><span class="o">)</span>
 		<span class="k">return</span> <span class="n">first</span><span class="o">;</span>
 <span class="c1">// æ¡¶ä¸­ä¸æ­¢ä¸€ä¸ªç»“ç‚¹
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">e</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
 <span class="c1">// æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œæ˜¯çš„è¯è°ƒç”¨getTreeNodeæ–¹æ³•
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="n">first</span> <span class="k">instanceof</span> <span class="n">TreeNode</span><span class="o">)</span>
 	<span class="k">return</span> <span class="o">(</span><span class="o">(</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">)</span><span class="n">first</span><span class="o">)</span><span class="o">.</span><span class="na">getTreeNode</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">)</span><span class="o">;</span>
 <span class="c1">// ä¸æ˜¯çº¢é»‘æ ‘çš„è¯ï¼Œåœ¨é“¾è¡¨ä¸­éå†æŸ¥æ‰¾    
</span><span class="c1"></span> <span class="k">do</span> <span class="o">{</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span><span class="o">=</span> <span class="n">hash</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="o">(</span><span class="o">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">key</span> <span class="o">|</span><span class="o">|</span> <span class="o">(</span><span class="n">key</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">)</span><span class="o">)</span><span class="o">)</span><span class="o">)</span>
 	<span class="k">return</span> <span class="n">e</span><span class="o">;</span>
 <span class="o">}</span> <span class="k">while</span> <span class="o">(</span><span class="o">(</span><span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span><span class="o">;</span>
 	<span class="o">}</span>
 <span class="o">}</span>
 	<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>HashMapï¼šå¦‚ä½•æœ‰æ•ˆå‡å°‘ç¢°æ’</p>
<ol>
<li>æ‰°åŠ¨å‡½æ•°ï¼šä¿ƒä½¿å…ƒç´ ä½ç½®åˆ†å¸ƒå‡åŒ€ï¼Œå‡å°‘ç¢°æ’å‡ ç‡</li>
<li>ä½¿ç”¨finalå¯¹è±¡ï¼Œå¹¶é‡‡ç”¨åˆé€‚çš„equals()å’ŒhashCode()æ–¹æ³•</li>
</ol>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>
<p>HashMapçš„hashç®—æ³•(<code>hash()</code>æ–¹æ³•)ã€‚</p>
</li>
<li>
<p><code>(n - 1) &amp; hash</code>ç­‰ä»·äºå¯¹ length å–ä½™ã€‚</p>
<h4 id="æ·»åŠ ">æ·»åŠ </h4>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">V</span> <span class="nf">put</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// è°ƒç”¨hash(key)æ–¹æ³•æ¥è®¡ç®—hash 
</span><span class="c1"></span>   <span class="k">return</span> <span class="n">putVal</span><span class="o">(</span><span class="n">hash</span><span class="o">(</span><span class="n">key</span><span class="o">)</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">final</span> <span class="n">V</span> <span class="nf">putVal</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">onlyIfAbsent</span><span class="o">,</span><span class="kt">boolean</span> <span class="n">evict</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">[</span><span class="o">]</span> <span class="n">tab</span><span class="o">;</span> 
   <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">p</span><span class="o">;</span> 
   <span class="kt">int</span> <span class="n">n</span><span class="o">,</span> <span class="n">i</span><span class="o">;</span>
   <span class="c1">// å®¹é‡åˆå§‹åŒ–ï¼šå½“tableä¸ºç©ºï¼Œåˆ™è°ƒç”¨resize()æ–¹æ³•æ¥åˆå§‹åŒ–å®¹å™¨ï¼Œå¹¶ä¸”resize()æ–¹æ³•å¯ä»¥æ‰©å®¹
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">tab</span> <span class="o">=</span> <span class="n">table</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span> <span class="o">|</span><span class="o">|</span> <span class="o">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">0</span><span class="o">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">(</span><span class="n">tab</span> <span class="o">=</span> <span class="n">resize</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
   <span class="c1">//ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­ï¼Œæ¡¶ä¸ºç©ºï¼Œæ–°ç”Ÿæˆç»“ç‚¹æ”¾å…¥æ¡¶ä¸­
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">p</span> <span class="o">=</span> <span class="n">tab</span><span class="o">[</span><span class="n">i</span> <span class="o">=</span> <span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">hash</span><span class="o">]</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="n">tab</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">newNode</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="kc">null</span><span class="o">)</span><span class="o">;</span>
   <span class="k">else</span> <span class="o">{</span>
   <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span><span class="o">;</span> <span class="n">K</span> <span class="n">k</span><span class="o">;</span>
   <span class="c1">// æ¯”è¾ƒæ¡¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ (æ•°ç»„ä¸­çš„ç»“ç‚¹)çš„hashå€¼ç›¸ç­‰ï¼Œkeyç›¸ç­‰
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span><span class="o">=</span> <span class="n">hash</span> <span class="o">&amp;</span><span class="o">&amp;</span>  <span class="o">(</span><span class="o">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">key</span> <span class="o">|</span><span class="o">|</span> <span class="o">(</span><span class="n">key</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">)</span><span class="o">)</span><span class="o">)</span><span class="o">)</span>
   <span class="c1">//å¦‚æœé”®çš„å€¼ä»¥åŠèŠ‚ç‚¹ hash ç­‰äºé“¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªé”®å€¼å¯¹èŠ‚ç‚¹æ—¶ï¼Œåˆ™å°† e æŒ‡å‘è¯¥é”®å€¼å¯¹
</span><span class="c1"></span>       <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="o">;</span>
   <span class="c1">// å¦‚æœæ¡¶ä¸­çš„å¼•ç”¨ç±»å‹ä¸º TreeNodeï¼Œåˆ™è°ƒç”¨çº¢é»‘æ ‘çš„æ’å…¥æ–¹æ³•
</span><span class="c1"></span>   <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">p</span> <span class="k">instanceof</span> <span class="n">TreeNode</span><span class="o">)</span>
   <span class="c1">// æ”¾å…¥æ ‘ä¸­
</span><span class="c1"></span>        <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="o">(</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">)</span><span class="n">p</span><span class="o">)</span><span class="o">.</span><span class="na">putTreeVal</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">tab</span><span class="o">,</span> <span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span><span class="o">;</span>
   <span class="k">else</span> <span class="o">{</span>
   <span class="c1">//å¯¹é“¾è¡¨è¿›è¡Œéå†ï¼Œå¹¶ç»Ÿè®¡é“¾è¡¨é•¿åº¦
</span><span class="c1"></span>   <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">binCount</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="o">;</span> <span class="o">+</span><span class="o">+</span><span class="n">binCount</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">//åœ¨å°¾éƒ¨æ’å…¥æ–°ç»“ç‚¹
</span><span class="c1"></span>       <span class="n">p</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">newNode</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="kc">null</span><span class="o">)</span><span class="o">;</span>
   <span class="c1">// å¦‚æœç»“ç‚¹æ•°é‡è¾¾åˆ°é˜ˆå€¼ï¼Œè½¬åŒ–ä¸ºçº¢é»‘æ ‘
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="n">binCount</span> <span class="o">&gt;</span><span class="o">=</span> <span class="n">TREEIFY_THRESHOLD</span> <span class="o">-</span> <span class="n">1</span><span class="o">)</span> <span class="c1">// -1 for 1st
</span><span class="c1"></span>       <span class="n">treeifyBin</span><span class="o">(</span><span class="n">tab</span><span class="o">,</span> <span class="n">hash</span><span class="o">)</span><span class="o">;</span>
       <span class="k">break</span><span class="o">;</span>
    <span class="o">}</span>
   <span class="c1">// åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">=</span><span class="o">=</span> <span class="n">hash</span> <span class="o">&amp;</span><span class="o">&amp;</span>  <span class="o">(</span><span class="o">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">key</span> <span class="o">|</span><span class="o">|</span> <span class="o">(</span><span class="n">key</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">k</span><span class="o">)</span><span class="o">)</span><span class="o">)</span><span class="o">)</span>
        <span class="k">break</span><span class="o">;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
      <span class="o">}</span>
   <span class="o">}</span>
   <span class="c1">//åˆ¤æ–­è¦æ’å…¥çš„é”®å€¼å¯¹æ˜¯å¦å­˜åœ¨ HashMap ä¸­
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// existing mapping for key
</span><span class="c1"></span>       <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
   <span class="c1">// onlyIfAbsent è¡¨ç¤ºæ˜¯å¦ä»…åœ¨ oldValue ä¸º null çš„æƒ…å†µä¸‹æ›´æ–°é”®å€¼å¯¹çš„å€¼
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="o">!</span><span class="n">onlyIfAbsent</span> <span class="o">|</span><span class="o">|</span> <span class="n">oldValue</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span>
       <span class="n">e</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
       <span class="n">afterNodeAccess</span><span class="o">(</span><span class="n">e</span><span class="o">)</span><span class="o">;</span>
       <span class="k">return</span> <span class="n">oldValue</span><span class="o">;</span>
    <span class="o">}</span>
 <span class="o">}</span>
   <span class="o">+</span><span class="o">+</span><span class="n">modCount</span><span class="o">;</span>
   <span class="c1">// é”®å€¼å¯¹æ•°é‡è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œåˆ™è¿›è¡Œæ‰©å®¹
</span><span class="c1"></span>   <span class="k">if</span> <span class="o">(</span><span class="o">+</span><span class="o">+</span><span class="n">size</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="o">)</span>
     <span class="n">resize</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
     <span class="n">afterNodeInsertion</span><span class="o">(</span><span class="n">evict</span><span class="o">)</span><span class="o">;</span>
     <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>äº‹å®ä¸Šï¼Œ<code>new HashMap();</code>å®Œæˆåï¼Œå¦‚æœæ²¡æœ‰<code>put</code>æ“ä½œï¼Œæ˜¯ä¸ä¼šåˆ†é…å­˜å‚¨ç©ºé—´çš„ã€‚</p>
<p>HashMapï¼šputæ–¹æ³•çš„é€»è¾‘</p>
<ol>
<li>å¦‚æœHashMapæœªè¢«åˆå§‹åŒ–è¿‡ï¼Œåˆ™åˆå§‹åŒ–</li>
<li>å¯¹keyæ±‚hashå€¼ï¼Œç„¶åå†è®¡ç®—ä¸‹æ ‡</li>
<li>å¦‚æœæ²¡æœ‰ç¢°æ’ï¼Œç›´æ¥æ”¾å…¥æ¡¶ä¸­</li>
<li>å¦‚æœç¢°æ’äº†ï¼Œä»¥é“¾è¡¨çš„æ–¹å¼é“¾æ¥åˆ°åé¢</li>
<li>å¦‚æœé“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼ï¼Œå°±æŠŠé“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘</li>
<li>å¦‚æœé“¾è¡¨çš„é•¿åº¦ä½äº6ï¼Œå°±æŠŠçº¢é»‘æ ‘è½¬å›é“¾è¡¨</li>
<li>å¦‚æœèŠ‚ç‚¹å·²ç»å­˜åœ¨å°±æ›¿æ¢æ—§å€¼</li>
<li>å¦‚æœæ¡¶æ»¡äº†ï¼ˆå®¹é‡16*è´Ÿè½½å› å­0.75ï¼‰ï¼Œå°±éœ€è¦resizeï¼ˆæ‰©å®¹2å€åé‡æ’ï¼‰</li>
</ol>
<h4 id="æ‰©å®¹æœºåˆ¶">æ‰©å®¹æœºåˆ¶</h4>
<p>åœ¨ HashMap ä¸­ï¼Œæ¡¶æ•°ç»„çš„é•¿åº¦å‡æ˜¯2çš„å¹‚ï¼Œé˜ˆå€¼å¤§å°ä¸ºæ¡¶æ•°ç»„é•¿åº¦ä¸è´Ÿè½½å› å­çš„ä¹˜ç§¯ã€‚å½“ HashMap ä¸­çš„é”®å€¼å¯¹æ•°é‡è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œè¿›è¡Œæ‰©å®¹ã€‚ HashMap æŒ‰å½“å‰æ¡¶æ•°ç»„é•¿åº¦çš„2å€è¿›è¡Œæ‰©å®¹ï¼Œé˜ˆå€¼ä¹Ÿå˜ä¸ºåŸæ¥çš„2å€ï¼ˆå¦‚æœè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œé˜ˆå€¼æº¢å‡ºå½’é›¶ï¼Œåˆ™æŒ‰é˜ˆå€¼å…¬å¼é‡æ–°è®¡ç®—ï¼‰ã€‚æ‰©å®¹ä¹‹åï¼Œè¦é‡æ–°è®¡ç®—é”®å€¼å¯¹çš„ä½ç½®ï¼Œå¹¶æŠŠå®ƒä»¬ç§»åŠ¨åˆ°åˆé€‚çš„ä½ç½®ä¸Šå»ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">[</span><span class="o">]</span> <span class="nf">resize</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
 <span class="c1">// æ‹¿åˆ°æ•°ç»„æ¡¶
</span><span class="c1"></span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">[</span><span class="o">]</span> <span class="n">oldTab</span> <span class="o">=</span> <span class="n">table</span><span class="o">;</span>
 <span class="kt">int</span> <span class="n">oldCap</span> <span class="o">=</span> <span class="o">(</span><span class="n">oldTab</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="n">oldTab</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
 <span class="kt">int</span> <span class="n">oldThr</span> <span class="o">=</span> <span class="n">threshold</span><span class="o">;</span>
 <span class="kt">int</span> <span class="n">newCap</span><span class="o">,</span> <span class="n">newThr</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
 <span class="c1">// å¦‚æœæ•°ç»„æ¡¶çš„å®¹é‡å¤§ä¸0
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="n">oldCap</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
 <span class="c1">// å¦‚æœæ¯”æœ€å¤§å€¼è¿˜å¤§ï¼Œåˆ™èµ‹å€¼ä¸ºæœ€å¤§å€¼
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="n">oldCap</span> <span class="o">&gt;</span><span class="o">=</span> <span class="n">MAXIMUM_CAPACITY</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">;</span>
 <span class="k">return</span> <span class="n">oldTab</span><span class="o">;</span>
 <span class="o">}</span>
 <span class="c1">// å¦‚æœæ‰©å®¹åå°äºæœ€å¤§å€¼ è€Œä¸” æ—§æ•°ç»„æ¡¶å¤§äºåˆå§‹å®¹é‡16ï¼Œ é˜ˆå€¼å·¦ç§»1(æ‰©å¤§2å€)
</span><span class="c1"></span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">newCap</span> <span class="o">=</span> <span class="n">oldCap</span> <span class="o">&lt;</span><span class="o">&lt;</span> <span class="n">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="n">MAXIMUM_CAPACITY</span> <span class="o">&amp;</span><span class="o">&amp;</span>
                 <span class="n">oldCap</span> <span class="o">&gt;</span><span class="o">=</span> <span class="n">DEFAULT_INITIAL_CAPACITY</span><span class="o">)</span>
            <span class="n">newThr</span> <span class="o">=</span> <span class="n">oldThr</span> <span class="o">&lt;</span><span class="o">&lt;</span> <span class="n">1</span><span class="o">;</span> <span class="c1">// double threshold
</span><span class="c1"></span> <span class="o">}</span>
 <span class="c1">// å¦‚æœæ•°ç»„æ¡¶å®¹é‡&lt;=0 ä¸” æ—§é˜ˆå€¼ &gt;0
</span><span class="c1"></span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">oldThr</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="c1">// initial capacity was placed in threshold
</span><span class="c1"></span> <span class="c1">// æ–°å®¹é‡=æ—§é˜ˆå€¼
</span><span class="c1"></span>        <span class="n">newCap</span> <span class="o">=</span> <span class="n">oldThr</span><span class="o">;</span>
 <span class="c1">// å¦‚æœæ•°ç»„æ¡¶å®¹é‡&lt;=0 ä¸” æ—§é˜ˆå€¼ &lt;=0
</span><span class="c1"></span> <span class="k">else</span> <span class="o">{</span> <span class="c1">// zero initial threshold signifies using defaults
</span><span class="c1"></span> <span class="c1">// æ–°å®¹é‡=é»˜è®¤å®¹é‡
</span><span class="c1"></span>        <span class="n">newCap</span> <span class="o">=</span> <span class="n">DEFAULT_INITIAL_CAPACITY</span><span class="o">;</span>
 <span class="c1">// æ–°é˜ˆå€¼= è´Ÿè½½å› å­*é»˜è®¤å®¹é‡
</span><span class="c1"></span>        <span class="n">newThr</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="o">(</span><span class="n">DEFAULT_LOAD_FACTOR</span> <span class="o">*</span> <span class="n">DEFAULT_INITIAL_CAPACITY</span><span class="o">)</span><span class="o">;</span>
 <span class="o">}</span>
 <span class="c1">// å¦‚æœæ–°é˜ˆå€¼ä¸º0
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="n">newThr</span> <span class="o">=</span><span class="o">=</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
 <span class="c1">// é‡æ–°è®¡ç®—é˜ˆå€¼
</span><span class="c1"></span> <span class="kt">float</span> <span class="n">ft</span> <span class="o">=</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span><span class="n">newCap</span> <span class="o">*</span> <span class="n">loadFactor</span><span class="o">;</span>
        <span class="n">newThr</span> <span class="o">=</span> <span class="o">(</span><span class="n">newCap</span> <span class="o">&lt;</span> <span class="n">MAXIMUM_CAPACITY</span> <span class="o">&amp;</span><span class="o">&amp;</span> <span class="n">ft</span> <span class="o">&lt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span><span class="n">MAXIMUM_CAPACITY</span> <span class="o">?</span>
 <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="n">ft</span> <span class="o">:</span> <span class="n">Integer</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">)</span><span class="o">;</span>
 <span class="o">}</span>
 <span class="c1">// æ›´æ–°é˜ˆå€¼
</span><span class="c1"></span>    <span class="n">threshold</span> <span class="o">=</span> <span class="n">newThr</span><span class="o">;</span>
 <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="o">{</span><span class="s">&#34;rawtypes&#34;</span><span class="o">,</span><span class="s">&#34;unchecked&#34;</span><span class="o">}</span><span class="o">)</span>
 <span class="c1">// åˆ›å»ºæ–°æ•°ç»„
</span><span class="c1"></span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">[</span><span class="o">]</span> <span class="n">newTab</span> <span class="o">=</span> <span class="o">(</span><span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">[</span><span class="o">]</span><span class="o">)</span><span class="k">new</span> <span class="n">Node</span><span class="o">[</span><span class="n">newCap</span><span class="o">]</span><span class="o">;</span>
 <span class="c1">// è¦†ç›–æ•°ç»„æ¡¶    
</span><span class="c1"></span>    <span class="n">table</span> <span class="o">=</span> <span class="n">newTab</span><span class="o">;</span>
 <span class="c1">// å¦‚æœæ—§æ•°ç»„æ¡¶ä¸æ˜¯ç©ºï¼Œåˆ™éå†æ¡¶æ•°ç»„ï¼Œå¹¶å°†é”®å€¼å¯¹æ˜ å°„åˆ°æ–°çš„æ¡¶æ•°ç»„ä¸­
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="n">oldTab</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
 <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">oldCap</span><span class="o">;</span> <span class="o">+</span><span class="o">+</span><span class="n">j</span><span class="o">)</span> <span class="o">{</span>
 <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span><span class="o">;</span>
 <span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">e</span> <span class="o">=</span> <span class="n">oldTab</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="o">)</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">oldTab</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span>
                    <span class="n">newTab</span><span class="o">[</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">newCap</span> <span class="o">-</span> <span class="n">1</span><span class="o">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
 <span class="c1">// å¦‚æœæ˜¯çº¢é»‘æ ‘
</span><span class="c1"></span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="k">instanceof</span> <span class="n">TreeNode</span><span class="o">)</span>
 <span class="c1">// é‡æ–°æ˜ å°„æ—¶ï¼Œéœ€è¦å¯¹çº¢é»‘æ ‘è¿›è¡Œæ‹†åˆ†
</span><span class="c1"></span> <span class="o">(</span><span class="o">(</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span><span class="o">)</span><span class="n">e</span><span class="o">)</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">newTab</span><span class="o">,</span> <span class="n">j</span><span class="o">,</span> <span class="n">oldCap</span><span class="o">)</span><span class="o">;</span>
 <span class="k">else</span> <span class="o">{</span> <span class="c1">// preserve order
</span><span class="c1"></span> <span class="c1">// å¦‚æœä¸æ˜¯çº¢é»‘æ ‘ï¼Œåˆ™æŒ‰é“¾è¡¨å¤„ç†
</span><span class="c1"></span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">loHead</span> <span class="o">=</span> <span class="kc">null</span><span class="o">,</span> <span class="n">loTail</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
 <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">hiHead</span> <span class="o">=</span> <span class="kc">null</span><span class="o">,</span> <span class="n">hiTail</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
 <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>
 <span class="c1">// éå†é“¾è¡¨ï¼Œå¹¶å°†é“¾è¡¨èŠ‚ç‚¹æŒ‰åŸé¡ºåºè¿›è¡Œåˆ†ç»„
</span><span class="c1"></span> <span class="k">do</span> <span class="o">{</span>
 <span class="n">next</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
 <span class="k">if</span> <span class="o">(</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">&amp;</span> <span class="n">oldCap</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">loTail</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span>
     <span class="n">loHead</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
 <span class="k">else</span>
     <span class="n">loTail</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
     <span class="n">loTail</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
 <span class="o">}</span>
 <span class="k">else</span> <span class="o">{</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">hiTail</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span>
     <span class="n">hiHead</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
 <span class="k">else</span>
     <span class="n">hiTail</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
     <span class="n">hiTail</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
   <span class="o">}</span>
 <span class="o">}</span> <span class="k">while</span> <span class="o">(</span><span class="o">(</span><span class="n">e</span> <span class="o">=</span> <span class="n">next</span><span class="o">)</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span><span class="o">;</span>
 <span class="c1">// å°†åˆ†ç»„åçš„é“¾è¡¨æ˜ å°„åˆ°æ–°æ¡¶ä¸­
</span><span class="c1"></span> <span class="k">if</span> <span class="o">(</span><span class="n">loTail</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
     <span class="n">loTail</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
     <span class="n">newTab</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">loHead</span><span class="o">;</span>
 <span class="o">}</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">hiTail</span> <span class="o">!</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
     <span class="n">hiTail</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
     <span class="n">newTab</span><span class="o">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">oldCap</span><span class="o">]</span> <span class="o">=</span> <span class="n">hiHead</span><span class="o">;</span>
 		<span class="o">}</span>
 	   <span class="o">}</span>
 	  <span class="o">}</span>
    <span class="o">}</span>
 <span class="o">}</span>
 	<span class="k">return</span> <span class="n">newTab</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¯´æ˜ï¼šè¿›è¡Œæ‰©å®¹ï¼Œä¼šä¼´éšç€ä¸€æ¬¡é‡æ–°hashåˆ†é…ï¼Œå¹¶ä¸”ä¼šéå†hashè¡¨ä¸­æ‰€æœ‰çš„å…ƒç´ ï¼Œæ˜¯éå¸¸è€—æ—¶çš„ã€‚åœ¨ç¼–å†™ç¨‹åºä¸­ï¼Œè¦å°½é‡é¿å…resizeã€‚</p>
<p>HashMapæ‰©å®¹é—®é¢˜ï¼š</p>
<ol>
<li>å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œè°ƒæ•´å¤§å°ä¼šå­˜åœ¨æ¡ä»¶ç«äº‰ï¼Œå®¹æ˜“é€ æˆæ­»é”</li>
<li>rehashingæ˜¯ä¸€ä¸ªæ¯”è¾ƒè€—æ—¶çš„è¿‡ç¨‹</li>
</ol>
<p>æ•´ä½“æ­¥éª¤ï¼š</p>
<ol>
<li>è®¡ç®—æ–°æ¡¶æ•°ç»„çš„å®¹é‡ newCap å’Œæ–°é˜ˆå€¼ newThr</li>
<li>æ ¹æ®è®¡ç®—å‡ºçš„ newCap åˆ›å»ºæ–°çš„æ¡¶æ•°ç»„ï¼Œæ¡¶æ•°ç»„ table ä¹Ÿæ˜¯åœ¨è¿™é‡Œè¿›è¡Œåˆå§‹åŒ–çš„</li>
<li>å°†é”®å€¼å¯¹èŠ‚ç‚¹é‡æ–°æ˜ å°„åˆ°æ–°çš„æ¡¶æ•°ç»„é‡Œã€‚å¦‚æœèŠ‚ç‚¹æ˜¯ TreeNode ç±»å‹ï¼Œåˆ™éœ€è¦æ‹†åˆ†çº¢é»‘æ ‘ã€‚å¦‚æœæ˜¯æ™®é€šèŠ‚ç‚¹ï¼Œåˆ™èŠ‚ç‚¹æŒ‰åŸé¡ºåºè¿›è¡Œåˆ†ç»„ã€‚</li>
</ol>
<p>æ€»ç»“èµ·æ¥ï¼Œä¸€å…±æœ‰ä¸‰ç§<strong>æ‰©å®¹æ–¹å¼</strong>ï¼š</p>
<ol>
<li>ä½¿ç”¨é»˜è®¤æ„é€ æ–¹æ³•åˆå§‹åŒ–HashMapã€‚ä»å‰æ–‡å¯ä»¥çŸ¥é“HashMapåœ¨ä¸€å¼€å§‹åˆå§‹åŒ–çš„æ—¶å€™ä¼šè¿”å›ä¸€ä¸ªç©ºçš„tableï¼Œå¹¶ä¸”thersholdä¸º0ã€‚å› æ­¤ç¬¬ä¸€æ¬¡æ‰©å®¹çš„å®¹é‡ä¸ºé»˜è®¤å€¼<code>DEFAULT_INITIAL_CAPACITY</code>ä¹Ÿå°±æ˜¯16ã€‚åŒæ—¶<code>threshold = DEFAULT_INITIAL_CAPACITY * DEFAULT_LOAD_FACTOR = 12</code>ã€‚</li>
<li>æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ æ–¹æ³•åˆå§‹åŒ–<code>HashMap</code>ã€‚é‚£ä¹ˆä»ä¸‹é¢æºç å¯ä»¥çœ‹åˆ°åˆå§‹å®¹é‡ä¼šç­‰äº<code>threshold</code>ï¼Œæ¥ç€<code>threshold = å½“å‰çš„å®¹é‡ï¼ˆthresholdï¼‰ * DEFAULT_LOAD_FACTOR</code>ã€‚</li>
<li>HashMapä¸æ˜¯ç¬¬ä¸€æ¬¡æ‰©å®¹ã€‚å¦‚æœ<code>HashMap</code>å·²ç»æ‰©å®¹è¿‡çš„è¯ï¼Œé‚£ä¹ˆæ¯æ¬¡tableçš„å®¹é‡ä»¥åŠ<code>threshold</code>é‡ä¸ºåŸæœ‰çš„ä¸¤å€ã€‚</li>
</ol>
<p>ç»†å¿ƒç‚¹çš„äººä¼šå¾ˆå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆè¦åˆ¤æ–­loadFactorä¸º0å‘¢ï¼Ÿ</p>
<blockquote>
<p>loadFactorå°æ•°ä½ä¸º 0ï¼Œæ•´æ•°ä½å¯è¢«2æ•´é™¤ä¸”å¤§äºç­‰äº8æ—¶ï¼Œåœ¨æŸæ¬¡è®¡ç®—ä¸­å°±å¯èƒ½ä¼šå¯¼è‡´ newThr æº¢å‡ºå½’é›¶ã€‚</p>
</blockquote>
<h3 id="ç–‘é—®å’Œè¿›é˜¶">ç–‘é—®å’Œè¿›é˜¶</h3>
<p><strong>1. JDK1.7æ˜¯åŸºäºæ•°ç»„+å•é“¾è¡¨å®ç°ï¼ˆä¸ºä»€ä¹ˆä¸ç”¨åŒé“¾è¡¨ï¼‰</strong></p>
<p>é¦–å…ˆï¼Œç”¨é“¾è¡¨æ˜¯ä¸ºäº†è§£å†³hashå†²çªã€‚</p>
<p>å•é“¾è¡¨èƒ½å®ç°ä¸ºä»€ä¹ˆè¦ç”¨åŒé“¾è¡¨å‘¢?(åŒé“¾è¡¨éœ€è¦æ›´å¤§çš„å­˜å‚¨ç©ºé—´)</p>
<p><strong>2. ä¸ºä»€ä¹ˆè¦ç”¨çº¢é»‘æ ‘ï¼Œè€Œä¸ç”¨å¹³è¡¡äºŒå‰æ ‘ï¼Ÿ</strong></p>
<blockquote>
<p>æ’å…¥æ•ˆç‡æ¯”å¹³è¡¡äºŒå‰æ ‘é«˜ï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”æ™®é€šäºŒå‰æ ‘é«˜ã€‚æ‰€ä»¥é€‰æ‹©æ€§èƒ½ç›¸å¯¹æŠ˜ä¸­çš„çº¢é»‘æ ‘ã€‚</p>
</blockquote>
<p><strong>3. é‡å†™å¯¹è±¡çš„Equalsæ–¹æ³•æ—¶ï¼Œè¦é‡å†™hashCodeæ–¹æ³•ï¼Œä¸ºä»€ä¹ˆï¼Ÿè·ŸHashMapæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</strong></p>
<p>equalsä¸hashcodeé—´çš„å…³ç³»:</p>
<ol>
<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸åŒï¼ˆå³ç”¨equalsæ¯”è¾ƒè¿”å›trueï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„hashCodeå€¼ä¸€å®šè¦ç›¸åŒï¼›</li>
<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„hashCodeç›¸åŒï¼Œå®ƒä»¬å¹¶ä¸ä¸€å®šç›¸åŒ(å³ç”¨equalsæ¯”è¾ƒè¿”å›false)</li>
</ol>
<p>å› ä¸ºåœ¨ HashMap çš„é“¾è¡¨ç»“æ„ä¸­éå†åˆ¤æ–­çš„æ—¶å€™ï¼Œç‰¹å®šæƒ…å†µä¸‹é‡å†™çš„ equals æ–¹æ³•æ¯”è¾ƒå¯¹è±¡æ˜¯å¦ç›¸ç­‰çš„ä¸šåŠ¡é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œå¾ªç¯ä¸‹æ¥æ›´æ˜¯å½±å“æŸ¥æ‰¾æ•ˆç‡ã€‚æ‰€ä»¥è¿™é‡ŒæŠŠ hashcode çš„åˆ¤æ–­æ”¾åœ¨å‰é¢ï¼Œåªè¦ hashcode ä¸ç›¸ç­‰å°±ç©å„¿å®Œï¼Œä¸ç”¨å†å»è°ƒç”¨å¤æ‚çš„ equals äº†ã€‚å¾ˆå¤šç¨‹åº¦åœ°æå‡ HashMap çš„ä½¿ç”¨æ•ˆç‡ã€‚</p>
<p>æ‰€ä»¥é‡å†™ hashcode æ–¹æ³•æ˜¯ä¸ºäº†è®©æˆ‘ä»¬èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨ HashMap ç­‰é›†åˆç±»ï¼Œå› ä¸º HashMap åˆ¤æ–­å¯¹è±¡æ˜¯å¦ç›¸ç­‰æ—¢è¦æ¯”è¾ƒ hashcode åˆè¦ä½¿ç”¨ equals æ¯”è¾ƒã€‚è€Œè¿™æ ·çš„å®ç°æ˜¯ä¸ºäº†æé«˜ HashMap çš„æ•ˆç‡ã€‚</p>
<p><strong>4. HashMapä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨å¯¹è±¡çš„åŸå§‹hashå€¼å‘¢?</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="nf">hash</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
 <span class="kt">int</span> <span class="n">h</span><span class="o">;</span>
 <span class="k">return</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span><span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="o">(</span><span class="n">h</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="o">)</span><span class="o">)</span> <span class="o">^</span> <span class="o">(</span><span class="n">h</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="n">16</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å‘ç°ï¼ŒHashMapçš„å“ˆå¸Œå€¼æ˜¯é€šè¿‡ä¸Šé¢çš„æ–¹å¼è·å–ï¼Œè€Œä¸æ˜¯é€šè¿‡<code>key.hashCode()</code>æ–¹æ³•è·å–ã€‚</p>
<p>åŸå› ï¼š</p>
<blockquote>
<p>é€šè¿‡ç§»ä½å’Œå¼‚æˆ–è¿ç®—ï¼Œå¯ä»¥è®© hash å˜å¾—æ›´å¤æ‚ï¼Œè¿›è€Œå½±å“ hash çš„åˆ†å¸ƒæ€§ã€‚</p>
</blockquote>
<p><strong>5. æ—¢ç„¶çº¢é»‘æ ‘é‚£ä¹ˆå¥½ï¼Œä¸ºå•¥hashmapä¸ç›´æ¥é‡‡ç”¨çº¢é»‘æ ‘ï¼Œè€Œæ˜¯å½“å¤§äº8ä¸ªçš„æ—¶å€™æ‰è½¬æ¢çº¢é»‘æ ‘ï¼Ÿ</strong></p>
<p>å› ä¸ºçº¢é»‘æ ‘éœ€è¦è¿›è¡Œå·¦æ—‹ï¼Œå³æ—‹æ“ä½œï¼Œ è€Œå•é“¾è¡¨ä¸éœ€è¦ã€‚</p>
<p>ä»¥ä¸‹éƒ½æ˜¯å•é“¾è¡¨ä¸çº¢é»‘æ ‘ç»“æ„å¯¹æ¯”ã€‚</p>
<p>å¦‚æœå…ƒç´ å°äº8ä¸ªï¼ŒæŸ¥è¯¢æˆæœ¬é«˜ï¼Œæ–°å¢æˆæœ¬ä½ã€‚</p>
<p>å¦‚æœå…ƒç´ å¤§äº8ä¸ªï¼ŒæŸ¥è¯¢æˆæœ¬ä½ï¼Œæ–°å¢æˆæœ¬é«˜ã€‚</p>
<p>è‡³äºä¸ºä»€ä¹ˆé€‰æ•°å­—8ï¼Œæ˜¯å¤§ä½¬æŠ˜ä¸­è¡¡é‡çš„ç»“æœ-.-ï¼Œå°±åƒloadFactoré»˜è®¤å€¼0.75ä¸€æ ·ã€‚</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">javaå¤šçº¿ç¨‹</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">javaå¤šçº¿ç¨‹</category>
                                
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java/">java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>ç»™åšå®¢æ·»åŠ ä¸€ä¸ªlive2dçœ‹æ¿å¨˜</title>
                <link>https://example.com/posts/live2d/</link>
                <guid isPermaLink="true">https://example.com/posts/live2d/</guid>
                <pubDate>Sat, 02 Mar 2019 01:53:34 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<h2 id="live2d-æ˜¯ä»€ä¹ˆ">Live2d æ˜¯ä»€ä¹ˆ</h2>
<p>Live2d çš„å®˜ç½‘åœ°å€ï¼šhttps://www.live2d.com/zh-CHS/</p>
<p>Live2d æ˜¯ä¸€ç§ <code>2d</code> çš„ç»˜å›¾æ¸²æŸ“æŠ€æœ¯ï¼Œæ˜¯ç”±æ—¥æœ¬çš„ä¸€ä¸ªå« <code>Cybernoids</code> çš„å…¬å¸å¼€å‘ï¼Œé€šè¿‡ä¸€ç³»åˆ—å¯ä»¥è¿ç»­åŠ¨ç”»çš„çš„äººç‰©æˆ–è€…åŠ¨ç‰©æ¥å»ºç«‹æ¨¡å‹ï¼Œç”Ÿæˆä¸€ç§å¯ä»¥åŠ¨çš„ <code>2d</code> å›¾å½¢æˆ–è€…è¯´äºŒç»´æ¨¡å‹ã€‚è¿™ç§æ¨¡å‹å’ŒäºŒæ¬¡å…ƒå¾ˆæ¥è¿‘ï¼Œæ‰€ä»¥å–œæ¬¢è¿™ç§é£æ ¼çš„äººå¾ˆå¤šï¼Œä½†æ˜¯ä¹Ÿæœ‰å®ƒè‡ªèº«çš„ç¼ºé™·é‚£å°±æ˜¯ä¸å®¹æ˜“å•†ä¸šåŒ–å’Œæ›´å¿«çš„å‘å±•ï¼Œä¾‹å¦‚ç°åœ¨çš„ <code>3d</code> æ¨¡å‹åœ¨æ¸¸æˆä¸Šå’Œ <code>VR</code> æŠ€æœ¯ä¸Šæœ‰å¾ˆå¤§çš„å‘å±•ç©ºé—´ï¼Œè€Œ <code>Live2d</code> è‡³ä»Šè¿˜æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„å¥‘åˆç‚¹ï¼Œä½†æ˜¯è¿™ä¸æ¯«ä¸å½±å“å®…ç”·å¯¹è¿™é¡¹æŠ€æœ¯çš„çƒ­çˆ±ã€‚</p>
<p><a href="https://dp2px.com/post/hexo-live2d/image1.webp"><img src="https://dp2px.com/post/hexo-live2d/image1.webp" alt="Live2d äºŒç»´æ¨¡å‹æ¼”ç¤º"></a>Live2d äºŒç»´æ¨¡å‹æ¼”ç¤º</p>
<h2 id="live2d-çš„åˆ¶ä½œè¿‡ç¨‹">Live2d çš„åˆ¶ä½œè¿‡ç¨‹</h2>
<p>å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ç›´æ¥å®‰è£…å¯ä»¥å¾—åˆ°ä¸¤ç§è½¯ä»¶ï¼Œåˆ†åˆ«æ˜¯ <code>Cubism Modeler</code> å’Œ <code>Cubism Animator</code>ï¼Œæœ€åæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…ç¬¬ä¸‰ä¸ªè½¯ä»¶ <code>Viewer</code> ç”¨ä½œé¢„è§ˆè°ƒæˆç­‰ã€‚</p>
<p>ç”±äºè¿˜æ˜¯ç”± <code>2d</code> å›¾å½¢åˆ¶ä½œï¼Œæ‰€ä»¥å¯¹åŠ¨ç”»å¸ˆè¦æ±‚æ¯”è¾ƒé«˜ï¼Œé™¤å»åŸç”»ç»˜åˆ¶èƒ½åŠ›ï¼ŒåŠ¨ç”»å¸ˆè¿˜éœ€è¦å…·æœ‰ä¸€å®šä¸‰ç»´ç©ºé—´æ„Ÿï¼Œä»¥åŠå¤æ‚é€»è¾‘èƒ½åŠ›ã€‚åˆ¶ä½œè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>PhotoShop</code> åˆ¶ä½œ <code>psd</code> æ ¼å¼çš„åŸç”»åˆ‡å›¾ã€‚</li>
<li>å¯¼å…¥ <code>Cubism Modeler</code> é‡Œè’™çš®ã€‚</li>
<li>è®¾ç½®è’™çš®ã€‚</li>
<li>å¯¼å‡ºåˆ° <code>Cubism Animator</code> é‡Œé¢å¼€å§‹åˆ¶ä½œåŠ¨ç”»ã€‚</li>
<li>æœ€åå†å¯¼å‡ºæ–‡ä»¶å°±å®Œæˆäº†ã€‚</li>
</ul>
<h2 id="å¼•å…¥çœ‹æ¿å¨˜åšå®¢æŒ‚ä»¶">å¼•å…¥çœ‹æ¿å¨˜åšå®¢æŒ‚ä»¶</h2>
<h3 id="ç¬¬ä¸€æ­¥ä¾èµ–-dependencies">ç¬¬ä¸€æ­¥ï¼šä¾èµ– Dependencies</h3>
<p>ä½ è¦ç¡®ä¿ä½ çš„é¡µé¢ä¸­å¯ä»¥ä½¿ç”¨ <code>font-awesome</code>, éœ€è¦ä½¿ç”¨åˆ°ï¼Œè¿˜æœ‰å°±æ˜¯ <code>jQuery</code> æ˜¯å¦æœ‰æ·»åŠ ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js&#34;</span><span class="p"></span><span class="p">&gt;</span><span class="p">&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css&#34;</span><span class="p"></span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>å¦‚æœä½ å‘ç°æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œæ£€æŸ¥ä¸€ä¸‹ä½ çš„ <code>jQuery</code> æ˜¯å¦æ­£å¸¸å¼•å…¥äº†ã€‚</p>
<h3 id="ç¬¬äºŒæ­¥ä½¿ç”¨-usage">ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ Usage</h3>
<p>ä½ å¯ä»¥ä½¿ç”¨ä¸€è¡Œä»£ç å®Œæˆçœ‹æ¿å¨˜çš„å¼•å…¥ï¼Œä½ åªéœ€è¦åœ¨ä½ çš„ <code>footer</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç å³å¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js&#34;</span><span class="p"></span><span class="p">&gt;</span><span class="p">&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>åšå®Œè¿™ä¸¤æ­¥ä½ å·²ç»å®Œæˆäº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿™æ ·åšè¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³ä¿®æ”¹çœ‹æ¿å¨˜ä¸Šé¢çš„æç¤ºæ–‡å­—å’Œé”šç‚¹ï¼Œå’Œè‡ªå·±çš„ç½‘ç«™å†…å®¹å…³è”å’Œå‘¼åº”ï¼Œè¿™æ ·å°±éœ€è¦å°†ä¸‹é¢è¿™å‡ ä¸ªæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°é™æ€æ–‡ä»¶å¤¹å³å¯ã€‚</p>
<p><a href="https://dp2px.com/post/hexo-live2d/image2.png"><img src="https://dp2px.com/post/hexo-live2d/image2.png" alt="Live2d æœ¬åœ°éœ€è¦ä¸‹è½½çš„æ–‡ä»¶"></a>Live2d æœ¬åœ°éœ€è¦ä¸‹è½½çš„æ–‡ä»¶</p>
<p>è¿™äº›æ–‡ä»¶ä½ å¯ä»¥åœ¨åŸä½œè€…çš„ <code>GitHub</code> ä¸Šé¢ä¸‹è½½ï¼Œä¸‹è½½åœ°å€ï¼šhttps://github.com/stevenjoezhang/live2d-widget</p>
<p>æ¥ä¸‹æ¥ä½ åªéœ€è¦é…ç½®ä¸€ä¸‹ <code>autoload.js</code> é‡Œé¢çš„æ ¹ç›®å½•å³å¯ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">//æ³¨æ„ï¼šlive2d_path å‚æ•°åº”ä½¿ç”¨ç»å¯¹è·¯å¾„
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">live2d_path</span> <span class="o">=</span> <span class="s2">&#34;/live2d/&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="è‡ªå®šä¹‰-live2d-çœ‹æ¿å¨˜">è‡ªå®šä¹‰ Live2d çœ‹æ¿å¨˜</h2>
<p>å®‰è£…å®Œæˆåæˆ‘ä»¬å¯ä»¥å¯¹çœ‹æ¿å¨˜çš„æ ·å¼å’Œå¤´é¡¶çš„æ°”æ³¡æ¶ˆæ¯è‡ªå®šä¹‰ï¼Œè¿™æ ·å¯ä»¥åšå‡ºå’Œè‡ªå·±ç½‘ç«™å¾ˆå¥‘åˆçš„äº¤äº’æ•ˆæœï¼Œä½¿è¿™ä¸ªçœ‹æ¿å¨˜æˆä¸ºä½ ç½‘ç«™ä¸Šç‹¬ä¸€æ— äºŒçš„ã€‚</p>
<h3 id="live2d-çœ‹æ¿å¨˜å¤§å°è°ƒæ•´">Live2d çœ‹æ¿å¨˜å¤§å°è°ƒæ•´</h3>
<p>è°ƒæ•´çœ‹æ¿å¨˜çš„å¤§å°å’Œä¸Šé¢æ°”æ³¡å¯¹è¯æ¡†çš„å¤§å°ï¼Œè¿˜æœ‰ä¾§è¾¹èœå•çš„æ ·å¼ï¼Œæ˜¯å¦æ˜¾ç¤ºç­‰éƒ½å¯ä»¥åœ¨ <code>waifu.css</code> æ ·å¼æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æµè§ˆå™¨ä¸­ F12 æŸ¥çœ‹å¯¹åº”æ§ä»¶çš„åç§°å³å¯ï¼Œåœ¨æ ·å¼æ–‡ä»¶ä¸­æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ æ ‡ç­¾è¿›è¡Œä¿®æ”¹å³å¯ã€‚</p>
<p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ä¸­ä¿®æ”¹æ ·å¼ï¼Œè¿™æ ·å¯ä»¥ä¸€è¾¹ä¿®æ”¹ä¸€è¾¹æŸ¥çœ‹æ•ˆæœï¼Œå°†æœ‰æ•ˆæœçš„ä¿®æ”¹ç»“æœæ›´æ”¹åˆ° <code>waifu.css</code> æ–‡ä»¶ä¸­å³å¯ã€‚</p>
<h3 id="live2d-è‡ªå®šä¹‰éšè—åŠŸèƒ½">Live2d è‡ªå®šä¹‰éšè—åŠŸèƒ½</h3>
<p>æˆ‘ä»¬å¦‚æœæƒ³è¦éšè—ç»„ä»¶ä¸­çš„æŸäº›åœ°æ–¹ï¼Œæˆ–è€…ä¿®æ”¹è·³è½¬é“¾æ¥ï¼Œæˆ–è€…è‡ªå®šä¹‰æ˜¾ç¤ºæŒ‰é’®å›¾æ ‡çš„æ ·å­éƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>waifu-tips.js</code> æ–‡ä»¶å®ç°ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦æ›´æ”¹èœå•çš„å¤šå°‘ï¼Œå¯ä»¥è¿™æ ·ä¿®æ”¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">$</span><span class="p">(</span><span class="s2">&#34;body&#34;</span><span class="p">)</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="sb">`</span><span class="sb">&lt;div id=&#34;waifu&#34;&gt;
</span><span class="sb">    &lt;div id=&#34;waifu-tips&#34;&gt;&lt;/div&gt;
</span><span class="sb">    &lt;canvas id=&#34;live2d&#34; width=&#34;300&#34; height=&#34;300&#34;&gt;&lt;/canvas&gt;
</span><span class="sb">    &lt;div id=&#34;waifu-tool&#34;&gt;
</span><span class="sb">        &lt;span class=&#34;fa fa-lg fa-paper-plane&#34;&gt;&lt;/span&gt;
</span><span class="sb">        &lt;span class=&#34;fa fa-lg fa-user-circle&#34;&gt;&lt;/span&gt;
</span><span class="sb">        &lt;span class=&#34;fa fa-lg fa-street-view&#34;&gt;&lt;/span&gt;
</span><span class="sb">        &lt;span class=&#34;fa fa-lg fa-camera-retro&#34;&gt;&lt;/span&gt;
</span><span class="sb">        &lt;span class=&#34;fa fa-lg fa-times&#34;&gt;&lt;/span&gt;
</span><span class="sb">    &lt;/div&gt;
</span><span class="sb">&lt;/div&gt;</span><span class="sb">`</span><span class="p">)</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>åªéœ€è¦ä¿®æ”¹è¿™é‡Œçš„æ ‡ç­¾ï¼Œä¸éœ€è¦çš„åˆ é™¤å³å¯ï¼Œå¦‚æœè¦æ·»åŠ å°±è¿½åŠ ä¸€ä¸ªï¼Œå…¶ä»–åœ°æ–¹ä¹Ÿæ˜¯ç±»ä¼¼çš„è®¾ç½®ï¼Œå¦‚æœéœ€è¦ä½ å¯ä»¥æŸ¥çœ‹è¯¥æ–‡ä»¶ä¿®æ”¹å…¶ä»–åœ°æ–¹ã€‚</p>
<h3 id="live2d-çœ‹æ¿å¨˜å¯¹è¯è‡ªå®šä¹‰">Live2d çœ‹æ¿å¨˜å¯¹è¯è‡ªå®šä¹‰</h3>
<p>æˆ‘ä»¬çš„çœ‹æ¿å¨˜ä¼šæ—¶ä¸æ—¶çš„å’Œæˆ‘ä»¬å¯¹è¯ï¼Œè€Œä¸”ä½ ä¼šå‘ç°å½“ä½ çš„é¼ æ ‡ä»æŸä¸ªæ ‡ç­¾æˆ–è€…é“¾æ¥ä¸Šé¢ç§»åŠ¨è¿‡åï¼Œçœ‹æ¿å¨˜éƒ½ä¼šå’Œä½ äº’åŠ¨ï¼Œè€Œè¿™ä¸ªäº’åŠ¨å¯èƒ½å’Œæˆ‘ä»¬çš„ç½‘ç«™å†…å®¹ä¸å¥‘åˆï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰“å¼€æ–‡ä»¶ <code>waifu-tips.json</code> æ¥è¿›è¡Œä¿®æ”¹ï¼Œæˆ–è€…è¿›è¡Œåˆ é™¤ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ·»åŠ æ–°çš„ã€‚</p>
<p>è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å†…å®¹å¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&#34;mouseover&#34;</span><span class="p">:</span> <span class="p">[</span><span class="p">{</span>
        <span class="nt">&#34;selector&#34;</span><span class="p">:</span> <span class="s2">&#34;#waifu #live2d&#34;</span><span class="p">,</span>
        <span class="nt">&#34;text&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å¯¹è¯æç¤ºä¸€&#34;</span><span class="p">,</span> <span class="s2">&#34;å¯¹è¯æç¤ºäºŒ&#34;</span><span class="p">]</span>
    <span class="p">}</span><span class="p">]</span><span class="p">,</span>
    <span class="nt">&#34;click&#34;</span><span class="p">:</span> <span class="p">[</span><span class="p">{</span>
        <span class="nt">&#34;selector&#34;</span><span class="p">:</span> <span class="s2">&#34;#waifu #live2d&#34;</span><span class="p">,</span>
        <span class="nt">&#34;text&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å¯¹è¯æç¤ºä¸€&#34;</span><span class="p">,</span> <span class="s2">&#34;å¯¹è¯æç¤ºäºŒ&#34;</span><span class="p">]</span>
    <span class="p">}</span><span class="p">]</span><span class="p">,</span>
    <span class="nt">&#34;seasons&#34;</span><span class="p">:</span> <span class="p">[</span><span class="p">{</span>
        <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="s2">&#34;01/01&#34;</span><span class="p">,</span>
        <span class="nt">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;å¯¹è¯æç¤º&#34;</span>
    <span class="p">}</span><span class="p">]</span>   
<span class="p">}</span>  
</code></pre></td></tr></table>
</div>
</div><p>ä»ä¸Šé¢çš„ json ç»“æ„ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œå®é™…ä¸Šå¯¹æˆ‘ä»¬çš„äº‹ä»¶å“åº”åšå‡ºä¸‰ä¸ªåˆ†ç±»ï¼Œä¸€ç§ä½¿é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼Œå¦ä¸€ç§ä½¿é¼ æ ‡ç‚¹å‡»äº‹ä»¶ï¼Œè¿˜æœ‰ä¸€ç§ä½¿æ—¥æœŸäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»™è¿™äº›é›†åˆä¸­æ·»åŠ æˆ‘ä»¬æƒ³ç»‘å®šçš„äº‹ä»¶ï¼Œ<code>selector</code> å°±æ˜¯è¦ç»‘å®šäº‹ä»¶çš„æ ‡ç­¾çš„id, è€Œ <code>text</code> åˆ™æ˜¯ç»‘å®šåæç¤ºçš„æ–‡æœ¬ï¼Œå¦‚æœæœ‰å¤šæ¡åˆ™ä¼šéšæœºæç¤ºå…¶ä¸­çš„æŸä¸€æ¡ã€‚</p>
<p>åšåˆ°è¿™é‡Œå·²ç»èƒ½åŸºæœ¬æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œå¦‚æœä½ è¿˜æƒ³æ·±åº¦å®šåˆ¶ä¹Ÿå¯ä»¥ï¼Œä½ å¯ä»¥ç ”ç©¶ä¸€ä¸‹æºä»£ç ï¼Œç„¶åå®šåˆ¶æ›´å¥½ç©çš„ä¸œè¥¿å‡ºæ¥ã€‚å…³äºåšå®¢è£…æ‰®å’Œç¾åŒ–è¿˜æœ‰å¾ˆå¤šå¥½ç©çš„ä¸œè¥¿ï¼Œå¦‚æœä½ æœ‰å…´è¶£å¯ä»¥çœ‹çœ‹æˆ‘å†™çš„å…³äºåšå®¢ç¾åŒ–çš„è¿™ç¯‡æ–‡ç«  <a href="https://dp2px.com/2019/04/25/hexo-meihua/">ã€ŠHexoä¸»é¢˜ï¼ˆNextï¼‰ç¾åŒ–ã€é…ç½®ã€ä¼˜åŒ–è¿™ä¸€ç¯‡å°±å¤Ÿäº†ã€‹</a></p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/%E5%8D%9A%E5%AE%A2/">åšå®¢</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/live2d/">live2d</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Jsoupçˆ¬è™«å…¥é—¨</title>
                <link>https://example.com/posts/jsoup%E7%88%AC%E8%99%AB%E5%85%A5%E9%97%A8-%E5%89%AF%E6%9C%AC/</link>
                <guid isPermaLink="true">https://example.com/posts/jsoup%E7%88%AC%E8%99%AB%E5%85%A5%E9%97%A8-%E5%89%AF%E6%9C%AC/</guid>
                <pubDate>Thu, 14 Feb 2019 16:01:23 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<p>jsoupæ˜¯ä¸€æ¬¾Javaçš„HTMLè§£æå™¨ï¼Œä¸»è¦ç”¨æ¥å¯¹HTMLè§£æã€‚</p>
<h2 id="ä¸€å¯¼å…¥ä¾èµ–">ä¸€.å¯¼å…¥ä¾èµ–</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="na">jsoup</span><span class="o">&lt;</span><span class="o">/</span><span class="n">groupId</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">jsoup</span><span class="o">&lt;</span><span class="o">/</span><span class="n">artifactId</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">1</span><span class="o">.</span><span class="na">10</span><span class="o">.</span><span class="na">2</span><span class="o">&lt;</span><span class="o">/</span><span class="n">version</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="o">/</span><span class="n">dependency</span><span class="o">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="äºŒçˆ¬å–æ•°æ®">äºŒ.çˆ¬å–æ•°æ®</h2>
<p>æ–°å»ºä¸€ä¸ªHtmlParseUtilå·¥å…·ç±»</p>
<h3 id="1è·å–è¯·æ±‚éœ€è¦è”ç½‘">1.è·å–è¯·æ±‚ï¼ˆéœ€è¦è”ç½‘ï¼‰</h3>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200412235228.png" alt=""></p>
<p>2.ç”¨Jsoupå°†HTMLè½¬åŒ–ä¸ºDoucumentå¯¹è±¡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java">        <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&#34;https://search.jd.com/Search?keyword=keyword&#34;</span><span class="o">;</span>
        <span class="n">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">Jsoup</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">url</span><span class="o">)</span><span class="o">,</span> <span class="n">20000</span><span class="o">)</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="3è·å–éœ€è¦çš„èŠ‚ç‚¹å±æ€§">3.è·å–éœ€è¦çš„èŠ‚ç‚¹å±æ€§</h3>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200412235258.png" alt=""></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">Element</span> <span class="n">element</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">getElementById</span><span class="o">(</span><span class="s">&#34;J_goodsList&#34;</span><span class="o">)</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºçœ‹æ˜¯å¦æˆåŠŸè·å–</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">element</span><span class="o">.</span><span class="na">html</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœ</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200412235357.png" alt=""></p>
<p>æˆåŠŸè·å–åˆ°è¯¥èŠ‚ç‚¹å±æ€§ï¼Œåˆ†æä¸€ä¸‹html,å‘ç°è‡ªå·±æ‰€éœ€è¦çˆ¬å–çš„å†…å®¹éƒ½åœ¨è¯¥èŠ‚ç‚¹çš„liå…ƒç´ ä¸­</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200412235418.png" alt=""></p>
<p>è·å–æ‰€æœ‰çš„liå…ƒç´ ï¼Œå¹¶è·å–å…ƒç´ ä¸­çš„å†…å®¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">Elements</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="na">getElementsByTag</span><span class="o">(</span><span class="s">&#34;li&#34;</span><span class="o">)</span><span class="o">;</span>
<span class="k">for</span> <span class="o">(</span><span class="n">Element</span> <span class="n">element1</span> <span class="o">:</span> <span class="n">elements</span><span class="o">)</span> <span class="o">{</span>
     <span class="c1">//å›¾ç‰‡ç‰¹åˆ«å¤šçš„ç½‘ç«™ï¼Œæ‡’åŠ è½½,å›¾ç‰‡è·¯å¾„ä¸€èˆ¬ä¸æ”¾åœ¨srcé‡Œï¼Œåˆ†æhtmlå‘ç°æ”¾åœ¨source-data-lazy-imgä¸‹
</span><span class="c1"></span>     <span class="n">String</span> <span class="n">img</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="na">getElementsByTag</span><span class="o">(</span><span class="s">&#34;img&#34;</span><span class="o">)</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">0</span><span class="o">)</span><span class="o">.</span><span class="na">attr</span><span class="o">(</span><span class="s">&#34;source-data-lazy-img&#34;</span><span class="o">)</span><span class="o">;</span>
     <span class="n">String</span> <span class="n">price</span><span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="na">getElementsByClass</span><span class="o">(</span><span class="s">&#34;p-price&#34;</span><span class="o">)</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">0</span><span class="o">)</span><span class="o">.</span><span class="na">text</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
     <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="na">getElementsByClass</span><span class="o">(</span><span class="s">&#34;p-name&#34;</span><span class="o">)</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">0</span><span class="o">)</span><span class="o">.</span><span class="na">text</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;==========================&#34;</span><span class="o">)</span><span class="o">;</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">img</span><span class="o">)</span><span class="o">;</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">)</span><span class="o">;</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">price</span><span class="o">)</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œ</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200412235452.png" alt=""></p>
<p>æˆåŠŸçˆ¬å–åˆ°æƒ³è¦è·å–çš„ä¿¡æ¯</p>
<p>é¡¹ç›®ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HtmlParseUtil</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[</span><span class="o">]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>        
        <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&#34;https://search.jd.com/Search?keyword=keyword&#34;</span><span class="o">;</span>
        <span class="n">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">Jsoup</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">url</span><span class="o">)</span><span class="o">,</span> <span class="n">20000</span><span class="o">)</span><span class="o">;</span>
        <span class="n">Element</span> <span class="n">element</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">getElementById</span><span class="o">(</span><span class="s">&#34;J_goodsList&#34;</span><span class="o">)</span><span class="o">;</span>
<span class="c1">//      System.out.println(element.html());
</span><span class="c1"></span>        <span class="n">Elements</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="na">getElementsByTag</span><span class="o">(</span><span class="s">&#34;li&#34;</span><span class="o">)</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Element</span> <span class="n">element1</span> <span class="o">:</span> <span class="n">elements</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">img</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="na">getElementsByTag</span><span class="o">(</span><span class="s">&#34;img&#34;</span><span class="o">)</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">0</span><span class="o">)</span><span class="o">.</span><span class="na">attr</span><span class="o">(</span><span class="s">&#34;source-data-lazy-img&#34;</span><span class="o">)</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">price</span><span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="na">getElementsByClass</span><span class="o">(</span><span class="s">&#34;p-price&#34;</span><span class="o">)</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">0</span><span class="o">)</span><span class="o">.</span><span class="na">text</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="na">getElementsByClass</span><span class="o">(</span><span class="s">&#34;p-name&#34;</span><span class="o">)</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">0</span><span class="o">)</span><span class="o">.</span><span class="na">text</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;==========================&#34;</span><span class="o">)</span><span class="o">;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">img</span><span class="o">)</span><span class="o">;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">)</span><span class="o">;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">price</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span>

    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/java/">java</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/%E7%88%AC%E8%99%AB/">çˆ¬è™«</category>
                                
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java/">java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>MySQLå¸¸ç”¨å‘½ä»¤</title>
                <link>https://example.com/posts/mysql%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</link>
                <guid isPermaLink="true">https://example.com/posts/mysql%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</guid>
                <pubDate>Fri, 08 Feb 2019 16:01:23 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<h3 id="1æ–°å»ºæ•°æ®åº“">1.æ–°å»ºæ•°æ®åº“</h3>
<pre><code>creat database &lt;æ•°æ®åº“å&gt; ;
</code></pre><h3 id="2æ˜¾ç¤ºæ•°æ®åº“">2.æ˜¾ç¤ºæ•°æ®åº“</h3>
<pre><code>show databases;
</code></pre><h3 id="3è¿æ¥æ•°æ®åº“">3.è¿æ¥æ•°æ®åº“</h3>
<pre><code>use &lt;æ•°æ®åº“å&gt;;
</code></pre><h3 id="4æ˜¾ç¤ºæ•°æ®è¡¨">4.æ˜¾ç¤ºæ•°æ®è¡¨</h3>
<pre><code>show tables;
</code></pre><h3 id="5æ–°å»ºæ•°æ®è¡¨">5.æ–°å»ºæ•°æ®è¡¨</h3>
<pre><code>creat table è¡¨çš„åå­—

 ( åˆ—åa æ•°æ®ç±»å‹(æ•°æ®é•¿åº¦)  çº¦æŸ, 

   åˆ—åb æ•°æ®ç±»å‹(æ•°æ®é•¿åº¦)  çº¦æŸï¼Œ

   åˆ—åc æ•°æ®ç±»å‹(æ•°æ®é•¿åº¦)  çº¦æŸ);
</code></pre><h3 id="6æ’å…¥æ•°æ®">6.æ’å…¥æ•°æ®</h3>
<pre><code>insert into è¡¨çš„åå­—(åˆ—åa,åˆ—åb,åˆ—åc) VALUES(å€¼1,å€¼2,å€¼3);
</code></pre><h3 id="å¸¸è§çº¦æŸ">å¸¸è§çº¦æŸ</h3>
<h5 id="ä¸»é”®primary-key">ä¸»é”®ï¼šPRIMARY KEY</h5>
<p>constraint ä¸»é”®å primary key (å­—æ®µå)</p>
<p>å¤åˆä¸»é”®ï¼šconstraint ä¸»é”®å primary key <strong>(å­—æ®µåï¼Œå­—æ®µå)</strong></p>
<h5 id="é»˜è®¤å€¼default">é»˜è®¤å€¼ï¼šDEFAULT</h5>
<h5 id="å”¯ä¸€çº¦æŸ-unique">å”¯ä¸€çº¦æŸ ï¼šUNIQUE</h5>
<h5 id="å¤–é”®çº¦æŸforeign-key">å¤–é”®çº¦æŸ:FOREIGN KEY</h5>
<p>constraint ä¸»é”®å foreign key (å­—æ®µå) references è¡¨åï¼ˆè¡¨çš„ä¸»é”®ï¼‰</p>
<h5 id="éç©ºçº¦æŸnot-null">éç©ºçº¦æŸï¼šNOT NULL</h5>
<h3 id="åŸºæœ¬çš„selectè¯­å¥">åŸºæœ¬çš„SELECTè¯­å¥</h3>
<p>SELECT è¦æŸ¥è¯¢çš„åˆ—å FROM è¡¨å WHERE é™åˆ¶æ¡ä»¶;</p>
<p><strong>æ’åº</strong>ï¼š<strong>ORDER BY</strong> çš„ç»“æœæ˜¯<strong>å‡åº</strong>æ’åˆ—ï¼Œè€Œä½¿ç”¨å…³é”®è¯ <strong>ASC</strong> å’Œ <strong>DESC</strong> å¯æŒ‡å®š<strong>å‡åº</strong>æˆ–<strong>é™åº</strong>æ’åº</p>
<h4 id="sql-å†…ç½®å‡½æ•°å’Œè®¡ç®—">SQL å†…ç½®å‡½æ•°å’Œè®¡ç®—ï¼š</h4>
<table>
<thead>
<tr>
<th>å‡½æ•°åï¼š</th>
<th>COUNT</th>
<th>SUM</th>
<th>AVG</th>
<th>MAX</th>
<th>MIN</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä½œç”¨ï¼š</td>
<td>è®¡æ•°</td>
<td>æ±‚å’Œ</td>
<td>æ±‚å¹³å‡å€¼</td>
<td>æœ€å¤§å€¼</td>
<td>æœ€å°å€¼</td>
</tr>
</tbody>
</table>
<h4 id="æ•°æ®åº“åŠè¡¨çš„ä¿®æ”¹å’Œåˆ é™¤"><strong>æ•°æ®åº“åŠè¡¨çš„ä¿®æ”¹å’Œåˆ é™¤</strong></h4>
<p><strong>åˆ é™¤æ•°æ®åº“</strong></p>
<pre><code>DROP DATABASE æ•°æ®åº“å;
</code></pre><p><strong>é‡å‘½åä¸€å¼ è¡¨</strong></p>
<pre><code>RENAME TABLE åŸå TO æ–°åå­—; 
æˆ–
ALTER TABLE åŸå RENAME æ–°å; 
æˆ–
ALTER TABLE åŸå RENAME TO æ–°å;
</code></pre><p><strong>åˆ é™¤ä¸€å¼ è¡¨</strong></p>
<pre><code>DROP TABLE è¡¨åå­—;
</code></pre><p><strong>å¢åŠ ä¸€åˆ—</strong></p>
<pre><code>ALTER TABLE è¡¨åå­— ADD COLUMN åˆ—åå­— æ•°æ®ç±»å‹ çº¦æŸ;
æˆ–ï¼š
ALTER TABLE è¡¨åå­— ADD åˆ—åå­— æ•°æ®ç±»å‹ çº¦æŸ;
</code></pre><p>å¦‚æœè¦æŠŠå¢åŠ çš„åˆ—æ’å…¥åœ¨æŒ‡å®šä½ç½®ï¼Œåˆ™éœ€è¦åœ¨è¯­å¥çš„æœ€åä½¿ç”¨AFTERå…³é”®è¯(<strong>â€œAFTER åˆ—1â€ è¡¨ç¤ºæ–°å¢çš„åˆ—è¢«æ”¾ç½®åœ¨ â€œåˆ—1â€ çš„åé¢</strong>)ã€‚</p>
<p><strong>åˆ é™¤ä¸€åˆ—</strong></p>
<pre><code>ALTER TABLE è¡¨åå­— DROP COLUMN åˆ—åå­—;
æˆ–ï¼š 
ALTER TABLE è¡¨åå­— DROP åˆ—åå­—;
</code></pre><p><strong>é‡å‘½åä¸€åˆ—</strong></p>
<pre><code>ALTER TABLE è¡¨åå­— CHANGE åŸåˆ—å æ–°åˆ—å æ•°æ®ç±»å‹ çº¦æŸ;
</code></pre><p><strong>æ”¹å˜æ•°æ®ç±»å‹</strong></p>
<pre><code>ALTER TABLE è¡¨åå­— MODIFY åˆ—åå­— æ–°æ•°æ®ç±»å‹;
</code></pre><p><strong>ä¿®æ”¹è¡¨ä¸­æŸä¸ªå€¼</strong></p>
<pre><code>UPDATE è¡¨åå­— SET åˆ—1=å€¼1,åˆ—2=å€¼2 WHERE æ¡ä»¶;
</code></pre><p><strong>åˆ é™¤ä¸€è¡Œè®°å½•</strong></p>
<pre><code>DELETE FROM è¡¨åå­— WHERE æ¡ä»¶;
</code></pre><h4 id="ç´¢å¼•">ç´¢å¼•</h4>
<p>æ–°å»ºç´¢å¼•</p>
<pre><code>ALTER TABLE è¡¨åå­— ADD INDEX ç´¢å¼•å (åˆ—å);
æˆ–
CREATE INDEX ç´¢å¼•å ON è¡¨åå­— (åˆ—å);
</code></pre><p>æŸ¥çœ‹ç´¢å¼•</p>
<pre><code>SHOW INDEX FROM è¡¨åå­—
</code></pre><p>æ¯”å¦‚æœ‰ä¸€ä¸ªç”¨æˆ·è¡¨ï¼Œå®ƒæ‹¥æœ‰ç”¨æˆ·å(username)å’Œä¸ªäººç­¾å(note)ä¸¤ä¸ªå­—æ®µã€‚å…¶ä¸­ç”¨æˆ·åå…·æœ‰å”¯ä¸€æ€§ï¼Œå¹¶ä¸”æ ¼å¼å…·æœ‰è¾ƒå¼ºçš„é™åˆ¶ï¼Œæˆ‘ä»¬ç»™ç”¨æˆ·ååŠ ä¸Šä¸€ä¸ªå”¯ä¸€ç´¢å¼•ï¼›ä¸ªæ€§ç­¾åæ ¼å¼å¤šå˜ï¼Œè€Œä¸”å…è®¸ä¸åŒç”¨æˆ·ä½¿ç”¨é‡å¤çš„ç­¾åï¼Œä¸åŠ ä»»ä½•ç´¢å¼•ã€‚</p>
<p>ä¸€äº›å­—æ®µä¸é€‚åˆåˆ›å»ºç´¢å¼•ï¼Œæ¯”å¦‚æ€§åˆ«ï¼Œè¿™ä¸ªå­—æ®µå­˜åœ¨å¤§é‡çš„é‡å¤è®°å½•æ— æ³•äº«å—ç´¢å¼•å¸¦æ¥çš„é€Ÿåº¦åŠ æˆï¼Œç”šè‡³ä¼šæ‹–ç´¯æ•°æ®åº“ï¼Œå¯¼è‡´æ•°æ®å†—ä½™å’Œé¢å¤–çš„ CPU å¼€é”€ã€‚</p>
<h4 id="è§†å›¾">è§†å›¾</h4>
<p>åˆ›å»ºè§†å›¾</p>
<pre><code>CREATE VIEW è§†å›¾å(åˆ—a,åˆ—b,åˆ—c) AS SELECT åˆ—1,åˆ—2,åˆ—3 FROM è¡¨åå­—;
</code></pre><p>è§†å›¾æ˜¯ä»ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ä¸­å¯¼å‡ºæ¥çš„è¡¨ï¼Œæ˜¯ä¸€ç§<strong>è™šæ‹Ÿå­˜åœ¨çš„è¡¨</strong>ã€‚å®ƒå°±åƒä¸€ä¸ªçª—å£ï¼Œé€šè¿‡è¿™ä¸ªçª—å£å¯ä»¥çœ‹åˆ°ç³»ç»Ÿä¸“é—¨æä¾›çš„æ•°æ®ï¼Œè¿™æ ·ï¼Œç”¨æˆ·å¯ä»¥ä¸ç”¨çœ‹åˆ°æ•´ä¸ªæ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œè€Œåªå…³å¿ƒå¯¹è‡ªå·±æœ‰ç”¨çš„æ•°æ®ã€‚</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/mysql/">mysql</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/mysql/">mysql</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>SpringBootå…¥é—¨(ä¸€)ï¼šè®¤è¯†SpingBoot</title>
                <link>https://example.com/posts/springboot%E5%85%A5%E9%97%A8%E4%B8%80%E8%AE%A4%E8%AF%86spingboot/</link>
                <guid isPermaLink="true">https://example.com/posts/springboot%E5%85%A5%E9%97%A8%E4%B8%80%E8%AE%A4%E8%AF%86spingboot/</guid>
                <pubDate>Tue, 05 Feb 2019 06:07:00 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<blockquote>
<p>Springæ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œæ˜¯ Spring å…¨å®¶æ¡¶ä¸­çš„ä¸€å‘˜,2003 å¹´å…´èµ·çš„ä¸€ä¸ªè½»é‡çº§çš„Java å¼€å‘æ¡†æ¶ï¼Œä½œè€…ï¼šRod Johnson  ã€‚</p>
<p>Springæ˜¯ä¸ºäº†è§£å†³ä¼ä¸šçº§åº”ç”¨å¼€å‘çš„å¤æ‚æ€§è€Œåˆ›å»ºçš„ï¼Œç®€åŒ–å¼€å‘ã€‚</p>
</blockquote>
<h4 id="ä»€ä¹ˆæ˜¯-spring-boot">ä»€ä¹ˆæ˜¯ Spring Boot</h4>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/20200414164213.png" alt=""></p>
<p>Spring Boot å…¶å®å°±æ˜¯ Springï¼Œå­¦è¿‡ Spring çš„å¤§å®¶ä¸€å®šéƒ½çŸ¥é“ï¼Œå³ä½¿æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç¨‹åºï¼ŒSpring éƒ½éœ€è¦å¤§é‡çš„é…ç½®ã€‚è€Œ Spring Boot å°†æˆ‘ä»¬ä»é…ç½®æ–‡ä»¶ä¸­è§£æ”¾äº†å‡ºæ¥ï¼ŒSpring Boot æä¾›äº†å¤§é‡çš„é»˜è®¤é…ç½®ï¼Œæˆ‘ä»¬åªéœ€è¦å°‘æ•°çš„é…ç½®ç”šè‡³ä¸é…ç½®ï¼Œå°±å¯ä»¥å»ºç«‹èµ·æ¥ä¸€ä¸ª Spring Boot åº”ç”¨ï¼Œç®€ç›´å°±æ˜¯ Java ç¨‹åºå‘˜çš„ç¦éŸ³ã€‚</p>
<p>Spring Boot åŸºäº Spring å¼€å‘ï¼ŒSpirng Boot æœ¬èº«å¹¶ä¸æä¾› Spring æ¡†æ¶çš„æ ¸å¿ƒç‰¹æ€§ä»¥åŠæ‰©å±•åŠŸèƒ½ï¼Œåªæ˜¯ç”¨äºå¿«é€Ÿã€æ•æ·åœ°å¼€å‘æ–°ä¸€ä»£åŸºäº Spring æ¡†æ¶çš„åº”ç”¨ç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¹¶ä¸æ˜¯ç”¨æ¥æ›¿ä»£ Spring çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯å’Œ Spring æ¡†æ¶ç´§å¯†ç»“åˆç”¨äºæå‡ Spring å¼€å‘è€…ä½“éªŒçš„å·¥å…·ã€‚Spring Boot ä»¥<strong>çº¦å®šå¤§äºé…ç½®çš„æ ¸å¿ƒæ€æƒ³</strong>ï¼Œé»˜è®¤å¸®æˆ‘ä»¬è¿›è¡Œäº†å¾ˆå¤šè®¾ç½®ï¼Œå¤šæ•° Spring Boot åº”ç”¨åªéœ€è¦å¾ˆå°‘çš„ Spring é…ç½®ã€‚åŒæ—¶å®ƒé›†æˆäº†å¤§é‡å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“é…ç½®ï¼ˆä¾‹å¦‚ Redisã€MongoDBã€Jpaã€RabbitMQã€Quartz ç­‰ç­‰ï¼‰ï¼ŒSpring Boot åº”ç”¨ä¸­è¿™äº›ç¬¬ä¸‰æ–¹åº“å‡ ä¹å¯ä»¥é›¶é…ç½®çš„å¼€ç®±å³ç”¨ã€‚</p>
<p>ç®€å•æ¥è¯´å°±æ˜¯SpringBootå…¶å®ä¸æ˜¯ä»€ä¹ˆæ–°çš„æ¡†æ¶ï¼Œå®ƒé»˜è®¤é…ç½®äº†å¾ˆå¤šæ¡†æ¶çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±åƒmavenæ•´åˆäº†æ‰€æœ‰çš„jaråŒ…ï¼Œspring bootæ•´åˆäº†æ‰€æœ‰çš„æ¡†æ¶ ã€‚</p>
<p>Spring Boot å‡ºç”Ÿåé—¨ï¼Œä»ä¸€å¼€å§‹å°±ç«™åœ¨ä¸€ä¸ªæ¯”è¾ƒé«˜çš„èµ·ç‚¹ï¼Œåˆç»è¿‡è¿™å‡ å¹´çš„å‘å±•ï¼Œç”Ÿæ€è¶³å¤Ÿå®Œå–„ï¼ŒSpring Boot å·²ç»å½“ä¹‹æ— æ„§æˆä¸º Java é¢†åŸŸæœ€çƒ­é—¨çš„æŠ€æœ¯ã€‚</p>
<h4 id="spring-boot-çš„ä¼˜ç‚¹">Spring Boot çš„ä¼˜ç‚¹</h4>
<ul>
<li>ä¸ºæ‰€æœ‰Springå¼€å‘è€…æ›´å¿«çš„å…¥é—¨</li>
<li>å¼€ç®±å³ç”¨ï¼Œæä¾›å„ç§é»˜è®¤é…ç½®æ¥ç®€åŒ–é¡¹ç›®é…ç½®</li>
<li>å†…åµŒå¼å®¹å™¨ç®€åŒ–Webé¡¹ç›®</li>
<li>æ²¡æœ‰å†—ä½™ä»£ç ç”Ÿæˆå’ŒXMLé…ç½®çš„è¦æ±‚ã€‚</li>
</ul>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/springboot/">SpringBoot</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/springboot/">SpringBoot</category>
                                
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/java/">java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>PicGo &#43; Gitee(ç äº‘)å®ç°markdownå›¾åºŠ</title>
                <link>https://example.com/posts/picgo-&#43;-gitee%E5%AE%9E%E7%8E%B0markdown%E5%9B%BE%E5%BA%8A/</link>
                <guid isPermaLink="true">https://example.com/posts/picgo-&#43;-gitee%E5%AE%9E%E7%8E%B0markdown%E5%9B%BE%E5%BA%8A/</guid>
                <pubDate>Sun, 03 Feb 2019 16:01:23 +0800</pubDate>
                
                    <author>1612291475@qq.com (å°é’è›™)</author>
                
                <copyright>[èµ£ICPå¤‡20004830å·](http://www.beian.miit.gov.cn/)</copyright>
                
                    <description><![CDATA[<p>å’±ä»¬å†™åšå®¢çš„æ—¶å€™ï¼Œæ€»æ˜¯éœ€è¦æ’å…¥å›¾ç‰‡çš„ï¼Œå›¾ç‰‡å­˜åœ¨æœ¬åœ°çš„è¯ä¸Šä¼ åˆ°åšå®¢ç½‘ç«™å»å°±æ²¡æ³•æ˜¾ç¤ºäº†ï¼Œå°±ç®—ä¸€ä¸ªå›¾ä¸€ä¸ªå›¾çš„å¤åˆ¶ç²˜è´´ä¸Šå»ï¼Œæƒ³ç§»æ¤åˆ°å…¶ä»–çš„åšå®¢ç½‘ç«™ï¼Œå›¾å°±ä¼šå¤±æ•ˆï¼Œæˆ‘ä»¬å°±éœ€è¦å›¾åºŠ</p>
<blockquote>
<p>å›¾åºŠæ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ
å›¾åºŠå°±æ˜¯ä¸€ä¸ªä¾¿äºåœ¨åšæ–‡ä¸­æ’å…¥åœ¨çº¿å›¾ç‰‡è¿æ¥çš„ä¸ªäººå›¾ç‰‡ä»“åº“ã€‚è®¾ç½®å›¾åºŠä¹‹åï¼Œåœ¨è‡ªå·±åšå®¢ä¸­æ’å…¥çš„å›¾ç‰‡é“¾æ¥å°±å¯ä»¥éšæ—¶éšåœ°åœ¨çº¿é¢„è§ˆäº†ï¼Œå¹¶ä¸”ä¸ä¼šå› ä¸ºä»»ä½•æ„å¤–åŸå› æ— æ³•æŸ¥çœ‹ï¼Œé™¤éè‡ªå·±äº²è‡ªåˆ é™¤ã€‚</p>
</blockquote>
<p>ç¥å¥‡çš„PicGoå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è¯ç”Ÿçš„ï¼Œå®ƒå¯ä»¥å°†å›¾ç‰‡ä¸Šä¼ åˆ°æŒ‡å®šçš„å›¾åºŠä¸Šï¼Œç„¶åè¿”å›markdowné“¾æ¥ï¼Œç›´æ¥ç²˜è´´åˆ°ä½ çš„æ–‡æ¡£ä¸­ï¼Œå°±æå®šå•¦</p>
<h2 id="1-å®‰è£…">1. å®‰è£…</h2>
<ul>
<li>PicGo</li>
<li>gitee 1.2.2-betaæ’ä»¶</li>
</ul>
<h4 id="é¦–å…ˆæ‰“å¼€upicgoå®˜ç½‘httpslinkzhihucomtargethttps3agithubcommolunerfinnpicgouä¸‹è½½å®‰è£…åŒ…">é¦–å…ˆæ‰“å¼€<strong><u><a href="https://link.zhihu.com/?target=https%3A//github.com/Molunerfinn/PicGo">picgoå®˜ç½‘</a></u></strong>ï¼Œä¸‹è½½å®‰è£…åŒ…</h4>
<p><img src="https://pic2.zhimg.com/80/v2-6a5d78ebb1910843ff4d2872580d21a5_720w.png" alt="img"></p>
<h3 id="å®‰è£…ä¹‹åæ‰“å¼€ä¸»ç•Œé¢">å®‰è£…ä¹‹åæ‰“å¼€ä¸»ç•Œé¢</h3>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/image-20200408153822640.png" alt=""></p>
<h3 id="é€‰æ‹©æœ€åº•ä¸‹çš„æ’ä»¶è®¾ç½®æœç´¢gitee">é€‰æ‹©æœ€åº•ä¸‹çš„æ’ä»¶è®¾ç½®ï¼Œæœç´¢<strong>gitee</strong></h3>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/image-20200408154045567.png" alt="image-20200408154045567"></p>
<h3 id="ç‚¹å‡»å·¦è¾¹çš„gitee-122-betaå¼€å§‹å®‰è£…">ç‚¹å‡»å·¦è¾¹çš„<strong>gitee 1.2.2-beta</strong>å¼€å§‹å®‰è£…</h3>
<blockquote>
<p>è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œå¿…é¡»è¦å…ˆå®‰è£…<a href="https://link.zhihu.com/?target=https%3A//nodejs.org/en/">node.js</a>æ‰èƒ½å®‰è£…æ’ä»¶ï¼Œæ²¡è£…çš„è‡ªå·±è£…ä¸€ä¸‹ï¼Œç„¶åé‡å¯å°±è¡Œã€‚</p>
</blockquote>
<p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸¤ä¸ªæ’ä»¶ï¼Œæˆ‘è¯•äº†ä¸€éï¼Œä¸¤ä¸ªéƒ½èƒ½ç”¨ï¼Œå¤§å®¶çœ‹å¿ƒæƒ…é€‰æ‹©ï¼Œå…ˆè¯´ä¸€ä¸‹å·¦è¾¹è¿™ä¸ª<strong>gitee 1.2.2-beta</strong>ï¼Œç”¨ä¸äº†çš„åŒå­¦å°±é€‰å³è¾¹é‚£ä¸ªï¼Œå¤§ä½“åŸºæœ¬ç›¸åŒ</p>
<h2 id="2-å»ºç«‹giteeç äº‘å›¾åºŠåº“">2. å»ºç«‹giteeï¼ˆç äº‘ï¼‰å›¾åºŠåº“</h2>
<p>æ³¨å†Œç äº‘çš„æ–¹æ³•å¾ˆç®€å•ï¼Œç½‘ç«™å¼•å¯¼éƒ½æ˜¯ä¸­æ–‡ï¼Œä¸å¤šè¯´äº†ï¼Œæˆ‘ä»¬ç›´æ¥å»ºç«‹è‡ªå·±çš„å›¾åºŠåº“ã€‚</p>
<h3 id="ç‚¹å‡»å³ä¸Šè§’çš„å·æ–°å»ºä»“åº“">ç‚¹å‡»å³ä¸Šè§’çš„+å·ï¼Œæ–°å»ºä»“åº“</h3>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/image-20200408154436124.png" alt=""></p>
<p>æ–°å»ºä»“åº“çš„è¦ç‚¹å¦‚ä¸‹ï¼š</p>
<ol>
<li>è¾“å…¥ä¸€ä¸ªä»“åº“åç§°</li>
<li>å…¶æ¬¡å°†ä»“åº“è®¾ä¸ºå…¬å¼€</li>
<li>å‹¾é€‰ä½¿ç”¨Readmeæ–‡ä»¶åˆå§‹åŒ–è¿™ä¸ªä»“åº“</li>
</ol>
<p><strong>è¿™ä¸ªé€‰é¡¹å‹¾ä¸Šï¼Œè¿™æ ·ç äº‘ä¼šè‡ªåŠ¨ç»™ä½ çš„ä»“åº“å»ºç«‹masteråˆ†æ”¯ï¼Œè¿™ç‚¹å¾ˆé‡è¦!!!</strong> æˆ‘å› ä¸ºè¿™ç‚¹æŠ˜è…¾äº†å¾ˆä¹…ï¼Œå› ä¸ºä½¿ç”¨githubåšå›¾åºŠpicgoå¥½åƒä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆmasteråˆ†æ”¯ï¼Œè€Œpicgoé‡Œçš„giteeæ’ä»¶ä¸ä¼šå¸®ä½ è‡ªåŠ¨ç”Ÿæˆåˆ†æ”¯ã€‚</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/image-20200408154652152.png" alt="image-20200408154652152"></p>
<p>ç‚¹å‡»åˆ›å»ºè¿›å…¥ä¸‹ä¸€æ­¥</p>
<hr>
<h2 id="3-é…ç½®picgo">3. é…ç½®PicGo</h2>
<p>å®‰è£…äº†<strong>gitee 1.2.2-beta</strong>æ’ä»¶ä¹‹åï¼Œæˆ‘ä»¬å¼€å§‹é…ç½®æ’ä»¶</p>
<h3 id="é…ç½®æ’ä»¶çš„è¦ç‚¹å¦‚ä¸‹">é…ç½®æ’ä»¶çš„è¦ç‚¹å¦‚ä¸‹ï¼š</h3>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/LI.jpg" alt=""></p>
<ul>
<li>
<p>urlï¼šå›¾åºŠç½‘ç«™ï¼Œè¿™é‡Œå†™ç äº‘çš„ä¸»é¡µ <a href="https://link.zhihu.com/?target=https%3A//gitee.com">https://gitee.com</a></p>
</li>
<li>
<p>ownerï¼šæ‰€æœ‰è€…ï¼Œå†™ä¸Šä½ çš„ç äº‘è´¦å·åï¼Œå¦‚æœä½ ä¸çŸ¥é“ä½ çš„è´¦å·åï¼Œè¿›å…¥ä½ åˆšæ‰çš„ä»“åº“</p>
</li>
<li>
<p>repoï¼šä»“åº“åç§°ï¼Œåªè¦å†™ä¸Šä»“åº“åç§°å°±è¡Œï¼Œæ¯”å¦‚æˆ‘è‡ªå·±çš„ä»“åº“blogImage</p>
</li>
<li>
<p>pathï¼šå†™ä¸Šè·¯å¾„ï¼Œä¸€èˆ¬æ˜¯imgï¼Œ<strong>è¿™å‡ ä¸ªé¡¹éƒ½ä¸ç”¨åŠ â€œ / â€œç¬¦å·</strong></p>
</li>
<li>
<p>messageï¼šä¸ç”¨å¡«</p>
</li>
</ul>
<h3 id="è¿™ä¸ªtokenæ€ä¹ˆè·å–ä¸‹é¢ç™»å½•è¿›è‡ªå·±çš„ç äº‘">è¿™ä¸ªtokenæ€ä¹ˆè·å–ï¼Œä¸‹é¢ç™»å½•è¿›è‡ªå·±çš„ç äº‘</h3>
<ol>
<li>
<p>ç‚¹å‡»å¤´åƒï¼Œè¿›å…¥è®¾ç½®</p>
</li>
<li>
<p>æ‰¾åˆ°å³è¾¹å®‰å…¨è®¾ç½®é‡Œé¢çš„ç§äººä»¤ç‰Œ</p>
</li>
</ol>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/image-20200409000147527.png" alt="image-20200409000147527"></p>
<ol>
<li>ç‚¹å‡»<code>ç”Ÿæˆæ–°ä»¤ç‰Œ</code>ï¼ŒæŠŠ<strong>projects</strong>è¿™ä¸€é¡¹å‹¾ä¸Šï¼Œå…¶ä»–çš„ä¸ç”¨å‹¾ï¼Œç„¶åæäº¤</li>
</ol>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/image-20200409000126528.png" alt="image-20200409000126528"></p>
<p>è¿™é‡Œéœ€è¦éªŒè¯ä¸€ä¸‹å¯†ç ï¼ŒéªŒè¯å¯†ç ä¹‹åä¼šå‡ºæ¥ä¸€ä¸²æ•°å­—ï¼Œè¿™ä¸€ä¸²æ•°å­—å°±æ˜¯ä½ çš„tokenï¼Œå°†è¿™ä¸²æ•°å­—å¤åˆ¶åˆ°åˆšæ‰çš„é…ç½®é‡Œé¢å»ã€‚</p>
<p><img src="https://gitee.com/zyh-h/blogimg/raw/master/img/image-20200408235506861.png" alt=""></p>
<blockquote>
<p>æ³¨æ„ï¼šè¿™ä¸ªä»¤ç‰Œåªä¼šæ˜æ–‡æ˜¾ç¤ºä¸€æ¬¡ï¼Œå»ºè®®åœ¨é…ç½®æ’ä»¶çš„æ—¶å€™å†æ¥ç”Ÿæˆä»¤ç‰Œï¼Œç›´æ¥å¤åˆ¶è¿›å»ï¼Œæä¸¢äº†åˆè¦é‡æ–°ç”Ÿæˆä¸€ä¸ªã€‚</p>
</blockquote>
<p>ç°åœ¨ä¿å­˜ä½ åˆšæ‰çš„é…ç½®ï¼Œç„¶åå°†å®ƒè®¾ç½®ä¸ºé»˜è®¤å›¾åºŠï¼Œå¤§åŠŸå‘Šæˆã€‚</p>
<h4 id="è¿˜æœ‰ä¸€ä¸ªæ’ä»¶picgo-plugin-gitee-uploaderåŠŸèƒ½å·®ä¸å¤šåˆšæ‰é‚£ä¸ªèƒ½ç”¨çš„è¯å°±ä¸éœ€è¦ç”¨è¿™ä¸ªé…ç½®çš„å†…å®¹æœ‰ç‚¹å·®åˆ«">è¿˜æœ‰ä¸€ä¸ªæ’ä»¶picgo-plugin-gitee-uploaderï¼ŒåŠŸèƒ½å·®ä¸å¤šï¼Œåˆšæ‰é‚£ä¸ªèƒ½ç”¨çš„è¯å°±ä¸éœ€è¦ç”¨è¿™ä¸ªï¼Œé…ç½®çš„å†…å®¹æœ‰ç‚¹å·®åˆ«</h4>
<hr>
<h2 id="4-æµ‹è¯•">4. æµ‹è¯•</h2>
<p>éšä¾¿é€‰ä¸€å¼ å›¾ç‰‡ä¸Šä¼ ï¼ˆpicgoä¹Ÿæ”¯æŒå‰ªè´´æ¿ä¸Šä¼ ï¼Œæˆªå›¾å·¥å…·æ¨èwin10çš„<em>Snipaste</em>ç¥å™¨ï¼ï¼‰ï¼Œè¯•è¯•çœ‹è¶…çº§å¿«æœ‰æœ¨æœ‰ï¼æ¯”githubå¿«å¾ˆå¤šï¼Œ0.1ç§’ä¸Šä¼ ï¼Œè€Œä¸”å¯¼å…¥åˆ°ä½ çš„markdownç¼–è¾‘å™¨é‡Œé¢ä¹Ÿæ˜¯ç§’è¯†åˆ«ä½ çš„å›¾ç‰‡å†…å®¹ï¼Œè€Œå¦‚æœæ˜¯githubå›¾åºŠä¸Šä¼ å¤ªæ…¢ä¸è¯´å¯èƒ½è¿˜ä¼šå‡ºç°è¯†åˆ«ä¸å‡ºæ¥çš„é—®é¢˜ï¼</p>
<p>ä¸Šä¼ ä¹‹åé»˜è®¤å¤åˆ¶é“¾æ¥ï¼Œç›´æ¥ç²˜è´´åˆ°ä½ çš„markdownç¼–è¾‘å™¨é‡Œï¼Œå°±å¯ä»¥æ„‰å¿«çš„è¿›è¡Œå†™ä½œäº†ï¼</p>
<p>æœ€åæ¨èä¸€ä¸‹æˆ‘çš„åšå®¢å†™ä½œå¥—ä»¶<strong>Typora + PicGo + Snipaste</strong>ï¼ŒTyporaå†™æ–‡æ¡£ï¼ŒSnipasteä¸€é”®æˆªå›¾ï¼ŒPicGoä¸€é”®ä¸Šä¼ å›¾ç‰‡è¿”å›é“¾æ¥ã€‚</p>]]></description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/categories/%E5%8D%9A%E5%AE%A2/">åšå®¢</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://example.com/tags/%E5%8D%9A%E5%AE%A2/">åšå®¢</category>
                                
                            
                        
                    
                
            </item>
        
    </channel>
</rss>
